/*! "1.0.131_2017_05_23" */
webpackJsonp([25],{1741:function(e,n,t){t(1742)},1742:function(e,n,t){var a=(t(8),t(1743));angular.module("buzz",["buzzShell"]).constant("bzRootPath","/public/javascripts/buzz").constant("emojis",a),t(1744),t(1745),t(1746),t(1747),t(1748),t(1750),t(1752),t(1753),t(1754),t(1756),t(1758),t(1759),t(1761),t(1762),t(1763),t(1765),t(1767),t(1769),t(1771),t(1773),t(1775),t(1777),t(1781),t(1784),t(1785),t(1787),t(1789),t(1790),t(1792),t(1794),t(1796),t(1798),t(1799),t(1801),t(1802),t(1803),t(1804),t(1806),t(1807),t(1809),t(1811),t(1815),t(2355),t(2357),t(2361),t(2363),t(2364),t(2366),t(2368),t(2370),t(2372),t(2374),t(2375),t(2376),t(2378),t(2380),t(2382),t(2384),t(2386),t(2388),t(2390),t(2392),t(2394),t(2396),t(2398),t(2400),t(2402),t(2404),t(2406),t(2408),t(2466),t(2467),t(2468),t(2470),t(2472),t(2474),t(2476),t(2478),t(2480),t(2482),t(2484),t(2485),t(2487),t(2489),t(2491),t(2493),t(2497),t(2498),t(2499),t(2500),t(2501),t(2502),t(2504)},1743:function(e,n){e.exports=["smile","laughing","blush","smiley","relaxed","smirk","heart_eyes","kissing_heart","kissing_closed_eyes","flushed","relieved","satisfied","grin","wink","stuck_out_tongue_winking_eye","stuck_out_tongue_closed_eyes","grinning","kissing","kissing_smiling_eyes","stuck_out_tongue","sleeping","worried","frowning","anguished","open_mouth","grimacing","confused","hushed","expressionless","unamused","sweat_smile","sweat","weary","pensive","disappointed","confounded","fearful","cold_sweat","persevere","cry","sob","joy","astonished","scream","tired_face","angry","rage","triumph","sleepy","yum","mask","sunglasses","dizzy_face","imp","smiling_imp","neutral_face","no_mouth","innocent","alien","yellow_heart","blue_heart","purple_heart","heart","green_heart","broken_heart","heartbeat","heartpulse","two_hearts","revolving_hearts","cupid","sparkling_heart","sparkles","star","star2","dizzy","boom","anger","exclamation","question","grey_exclamation","grey_question","zzz","dash","sweat_drops","notes","musical_note","fire","poop","thumbsup","thumbsdown","ok_hand","punch","fist","v","wave","hand","open_hands","point_up","point_down","point_left","point_right","raised_hands","pray","point_up_2","clap","muscle","walking","runner","couple","family","two_men_holding_hands","two_women_holding_hands","dancer","dancers","ok_woman","no_good","information_desk_person","raised_hand","bride_with_veil","person_with_pouting_face","person_frowning","bow","couplekiss","couple_with_heart","massage","haircut","nail_care","boy","girl","woman","man","baby","older_woman","older_man","person_with_blond_hair","man_with_gua_pi_mao","man_with_turban","construction_worker","cop","angel","princess","smiley_cat","smile_cat","heart_eyes_cat","kissing_cat","smirk_cat","scream_cat","crying_cat_face","joy_cat","pouting_cat","japanese_ogre","japanese_goblin","see_no_evil","hear_no_evil","speak_no_evil","guardsman","skull","feet","lips","kiss","droplet","ear","eyes","nose","tongue","love_letter","bust_in_silhouette","busts_in_silhouette","speech_balloon","thought_balloon","sunny","umbrella","cloud","snowflake","snowman","zap","cyclone","foggy","ocean","cat","dog","mouse","hamster","rabbit","wolf","frog","tiger","koala","bear","pig","pig_nose","cow","boar","monkey_face","monkey","horse","racehorse","camel","sheep","elephant","panda_face","snake","bird","baby_chick","hatched_chick","hatching_chick","chicken","penguin","turtle","bug","honeybee","ant","beetle","snail","octopus","tropical_fish","fish","whale","whale2","dolphin","cow2","ram","rat","water_buffalo","tiger2","rabbit2","dragon","goat","rooster","dog2","pig2","mouse2","ox","dragon_face","blowfish","crocodile","dromedary_camel","leopard","cat2","poodle","paw_prints","bouquet","cherry_blossom","tulip","four_leaf_clover","rose","sunflower","hibiscus","maple_leaf","leaves","fallen_leaf","herb","mushroom","cactus","palm_tree","evergreen_tree","deciduous_tree","chestnut","seedling","blossom","ear_of_rice","shell","globe_with_meridians","sun_with_face","full_moon_with_face","new_moon_with_face","new_moon","waxing_crescent_moon","first_quarter_moon","waxing_gibbous_moon","full_moon","waning_gibbous_moon","last_quarter_moon","waning_crescent_moon","last_quarter_moon_with_face","first_quarter_moon_with_face","moon","earth_africa","earth_americas","earth_asia","volcano","milky_way","partly_sunny","bamboo","gift_heart","dolls","school_satchel","mortar_board","flags","fireworks","sparkler","wind_chime","rice_scene","jack_o_lantern","ghost","santa","8ball","alarm_clock","apple","art","baby_bottle","balloon","banana","bar_chart","baseball","basketball","bath","bathtub","battery","beer","beers","bell","bento","bicyclist","bikini","birthday","black_joker","black_nib","blue_book","bomb","bookmark","bookmark_tabs","books","boot","bowling","bread","briefcase","bulb","cake","calendar","calling","camera","candy","card_index","cd","chart_with_downwards_trend","chart_with_upwards_trend","cherries","chocolate_bar","christmas_tree","clapper","clipboard","closed_book","closed_lock_with_key","closed_umbrella","clubs","cocktail","coffee","computer","confetti_ball","cookie","corn","credit_card","crown","crystal_ball","curry","custard","dango","dart","date","diamonds","dollar","door","doughnut","dress","dvd","e_mail","egg","eggplant","electric_plug","email","euro","eyeglasses","fax","file_folder","fish_cake","fishing_pole_and_fish","flashlight","floppy_disk","flower_playing_cards","football","fork_and_knife","fried_shrimp","fries","game_die","gem","gift","golf","grapes","green_apple","green_book","guitar","gun","hamburger","hammer","handbag","headphones","hearts","high_brightness","high_heel","hocho","honey_pot","horse_racing","hourglass","hourglass_flowing_sand","ice_cream","icecream","inbox_tray","incoming_envelope","iphone","jeans","key","kimono","ledger","lemon","lipstick","lock","lock_with_ink_pen","lollipop","loop","loudspeaker","low_brightness","mag","mag_right","mahjong","mailbox","mailbox_closed","mailbox_with_mail","mailbox_with_no_mail","mans_shoe","meat_on_bone","mega","melon","memo","microphone","microscope","minidisc","money_with_wings","moneybag","mountain_bicyclist","movie_camera","musical_keyboard","musical_score","mute","name_badge","necktie","newspaper","no_bell","notebook","notebook_with_decorative_cover","nut_and_bolt","oden","open_file_folder","orange_book","outbox_tray","page_facing_up","page_with_curl","pager","paperclip","peach","pear","pencil2","phone","pill","pineapple","pizza","postal_horn","postbox","pouch","poultry_leg","pound","purse","pushpin","radio","ramen","ribbon","rice","rice_ball","rice_cracker","ring","rugby_football","running_shirt_with_sash","sake","sandal","satellite","saxophone","scissors","scroll","seat","shaved_ice","shirt","shower","ski","smoking","snowboarder","soccer","sound","space_invader","spades","spaghetti","speaker","stew","straight_ruler","strawberry","surfer","sushi","sweet_potato","swimmer","syringe","tada","tanabata_tree","tangerine","tea","telephone_receiver","telescope","tennis","toilet","tomato","tophat","triangular_ruler","trophy","tropical_drink","trumpet","tv","unlock","vhs","video_camera","video_game","violin","watch","watermelon","wine_glass","womans_clothes","womans_hat","wrench","yen","aerial_tramway","airplane","ambulance","anchor","articulated_lorry","atm","bank","barber","beginner","bike","blue_car","boat","bridge_at_night","bullettrain_front","bullettrain_side","bus","busstop","car","carousel_horse","checkered_flag","church","circus_tent","city_sunrise","city_sunset","construction","convenience_store","crossed_flags","department_store","european_castle","european_post_office","factory","ferris_wheel","fire_engine","fountain","fuelpump","helicopter","hospital","hotel","hotsprings","house","house_with_garden","japan","japanese_castle","light_rail","love_hotel","minibus","monorail","mount_fuji","mountain_cableway","mountain_railway","moyai","office","oncoming_automobile","oncoming_bus","oncoming_police_car","oncoming_taxi","performing_arts","police_car","post_office","railway_car","rainbow","rocket","roller_coaster","rotating_light","round_pushpin","rowboat","school","ship","slot_machine","speedboat","stars","station","statue_of_liberty","steam_locomotive","sunrise","sunrise_over_mountains","suspension_railway","taxi","tent","ticket","tokyo_tower","tractor","traffic_light","train2","tram","triangular_flag_on_post","trolleybus","truck","vertical_traffic_light","warning","wedding","jp","kr","cn","us","fr","es","it","ru","gb","de","100","1234","a","ab","abc","abcd","accept","aquarius","aries","arrow_backward","arrow_double_down","arrow_double_up","arrow_down","arrow_down_small","arrow_forward","arrow_heading_down","arrow_heading_up","arrow_left","arrow_lower_left","arrow_lower_right","arrow_right","arrow_right_hook","arrow_up","arrow_up_down","arrow_up_small","arrow_upper_left","arrow_upper_right","arrows_clockwise","arrows_counterclockwise","b","baby_symbol","baggage_claim","ballot_box_with_check","bangbang","black_circle","black_square_button","cancer","capital_abcd","capricorn","chart","children_crossing","cinema","cl","clock1","clock10","clock1030","clock11","clock1130","clock12","clock1230","clock130","clock2","clock230","clock3","clock330","clock4","clock430","clock5","clock530","clock6","clock630","clock7","clock730","clock8","clock830","clock9","clock930","congratulations","cool","copyright","curly_loop","currency_exchange","customs","diamond_shape_with_a_dot_inside","do_not_litter","eight","eight_pointed_black_star","eight_spoked_asterisk","end","fast_forward","five","four","free","gemini","hash","heart_decoration","heavy_check_mark","heavy_division_sign","heavy_dollar_sign","heavy_minus_sign","heavy_multiplication_x","heavy_plus_sign","id","ideograph_advantage","information_source","interrobang","keycap_ten","koko","large_blue_circle","large_blue_diamond","large_orange_diamond","left_luggage","left_right_arrow","leftwards_arrow_with_hook","leo","libra","link","m","mens","metro","mobile_phone_off","negative_squared_cross_mark","new","ng","nine","no_bicycles","no_entry","no_entry_sign","no_mobile_phones","no_pedestrians","no_smoking","non_potable_water","o","o2","ok","on","one","ophiuchus","parking","part_alternation_mark","passport_control","pisces","potable_water","put_litter_in_its_place","radio_button","recycle","red_circle","registered","repeat","repeat_one","restroom","rewind","sa","sagittarius","scorpius","secret","seven","signal_strength","six","six_pointed_star","small_blue_diamond","small_orange_diamond","small_red_triangle","small_red_triangle_down","soon","sos","symbols","taurus","three","tm","top","trident","twisted_rightwards_arrows","two","u5272","u5408","u55b6","u6307","u6708","u6709","u6e80","u7121","u7533","u7981","u7a7a","underage","up","vibration_mode","virgo","vs","wavy_dash","wc","wheelchair","white_check_mark","white_circle","white_flower","white_square_button","womens","x","zero"]},1744:function(e,n){angular.module("buzz").factory("bzSafeData",function(){return{accessItemGroup:'<span class="access-item group">',accessItemObj:'<span class="access-item-object">',accessItemUser:'<span class="access-item user">',bold:'<span class="bz-text-body bold">',secondaryItalics:'<span class="bz-text-body secondary italics">',spanEnd:"</span>"}})},1745:function(e,n){angular.module("buzz").factory("bzUserListFactory",["bzService","$q",function(e,n){function t(e,n,t,a,s){return i("PIN",{channelId:e,pageSize:n,currentOffset:t,huddle:s,filterTerm:a})}function a(e,n,t,a,s){return i("ACCESS",{channelId:e,pageSize:n,currentOffset:t,huddle:s,filterTerm:a})}function i(t,a){function i(e){function t(){return p}function a(){var t;return h?n.when(null):p?n.when(null):(p=!0,t={params:{limit:u,offset:s}},e&&(t.params.filter=e),i=o(c,t).then(function(e){return p=!1,s+=u,e[r]&&!e[r].length&&(h=!0),e}),n.when(i))}var i=[],s=this.offset=d,u=this.limit=l,p=this.loading=!1;this.nextPage=a,this.isLoading=t;var h=!1}var o,r,c,l,d;switch(l=a.pageSize||s,d=a.currentOffset||0,c=a.channelId,t){case"ACCESS":o=e.getUsersWithAccessToChannel,r="userPermissions";break;case"PIN":a.huddle||(o=e.getPinnedUsersForChannel),r="pinnedUserIds"}return new i(a.filterTerm)}var s=30;return{getPinnedUsersScrollLoader:t,getUserAccessesScrollLoader:a}}])},1746:function(e,n){angular.module("buzz").factory("bzAttachmentLoader",["$q","bzService",function(e,n){function t(e){function t(){return n.getChannelAttachments(e,i,s).then(function(e){if(s+=i,o.done=!e||!e.attachments||e.attachments.length<i,e&&e.attachments&&e.attachments.length)return a(e.attachments)})}function a(e){return e?e.filter(function(e){return e.type&&"COMMAND"!==e.type&&!!("URL_PREVIEW"!==e.type||e.title&&e.title.text.length)}):[]}var i=30,s=0,o={done:!1,nextPage:t,filter:a};return o}return{newLoader:function(e){return new t(e)}}}])},1747:function(e,n){angular.module("buzz").factory("bzGrantAccessHelpers",["$q","bzService","bzHelpers",function(e,n,t){function a(e,t){var a=s(e);return t.isObjectChannel()?n.inviteToObjectChat(t.objectId,t.objectType,a):t.isGroupChat()?n.updateChatAccesses(t.id,a):t.isPrivateChannel()||t.isPublicChannel()?n.inviteToTopic(t.id,a,t.isPrivateChannel()):t.isPublicThread()||t.isPrivateThread()?i(e,t):void 0}function i(t,i){var o=s(t),r=e.defer(),c=n.inviteToHuddle(i.id,o),l=a(t,i.parentChannel);return e.all([c,l]).then(function(e){r.resolve(e)}),r.promise}function s(e){var n=t.formatUsers(e.users,null),a=t.formatGroups(e.groups,null);return n.concat(a)}var o={grantChannelAccess:a,grantAccessToThreadAndParentChannel:i,getFormattedUsersFromAccessItem:s};return o}])},1748:function(e,n,t){var a=t(8),i=t(47),s=t(81);angular.module("buzz").directive("bzMessages",["bzRootPath","bzMessageService","bzStates","$timeout","bzEvents","bzService","CurrentUserId","Auth","authorities","bzStore","$q","bzActivityMonitor","bzHelpers","dmI18n","Analytics","dmRouting","$rootScope","bzModals","dmUserInviteModalService","dmMentionService","features","bzPreferences","$filter","dmSocialUserService","dmUserService","bzPusherService","bzEmojiPickerService",function(e,n,o,r,c,l,d,u,p,h,g,m,b,v,f,z,y,w,k,C,x,_,T,M,I,$,A){var S,P,E,O,U=45;return{replace:!0,restrict:"E",scope:{},template:t(1749),link:function(e,t,r){function z(){e.vm={};var n=_.onUpdated(function(e){"DISABLE_BUZZ_PENDO"==e.constant&&(en(),n(),n=null)});e.messagesLoading=!1,e.showPendo=!1,e.vm.showThreadView=!1,e.sendMessage=Te,e.createMessage=xe,e.quoteMessage=me,e.deleteMessage=be,e.scrollToBottom=je,e.attachmentAdded=Me,e.attachmentRemoved=Ae,e.openSearch=Ue,e.scrollHandler=qe,e.pinChannel=Q,e.unpinChannel=X,e.viewFullChannel=V,e.entityMentioned=j,e.entityUnmentioned=F,e.finishedGrantAccess=H,e.setCurrentChannel=h.setCurrentChannel,e.onGiphySearch=Pe,e.onGifSelected=Ee,e.launchTour=Qe,e.dismissTour=nn,e.clearAccessWarnings=Se,e.showThreadCreation=fe,e.cancelThreadCreation=ye,e.setNewMessagesBanner=T,e.scrollToNewMessages=I,e.focusMessage=De,e.createMessageApi={},e.header={},e.autoGrantApi={},e.currentUserId=d,e.animate=!0,e.unmute=G,e.scrollDirection=void 0,e.messages=void 0,e.channel=h.currentChannel,e.ramHeader=x.on("ram-header")||"SYSTEM"===e.channel.themType&&"buzzintro"===e.channel.themId,e.usersTyping={},e.userTypingData={numUsersTyping:0,first:null,second:null},e.createMessageCallbacks={onGiphySearch:Pe,createMessage:xe,attachmentAdded:Me,attachmentRemoved:Ae,entityMentioned:j,entityUnmentioned:F,cancelThreadCreation:ye},D(),R(),ae(),ze(),vn.push(c.channelChange.on(ee)),vn.push(c.currentChannelUpdated.on(se)),vn.push(c.currentlyTyping.on(Le)),vn.push(c.messageReceived.on(re)),vn.push(c.messageUpdated.on(ce)),vn.push(c.myMessageUpdated.on(ce)),vn.push(c.retryFailedMessage.on(K)),vn.push(c.removeFailedMessage.on(Z)),vn.push(c.createThread.on(fe)),vn.push(n),vn.push(c.addDroidMessage.on(he)),vn.push(c.addDroidPrompts.on(pe)),vn.push(c.sizeChange.on(D)),vn.push(c.stateChange.on(D)),vn.push(c.toggleNewMessagesBanner.on(T)),vn.push(c.onMentioned.on(le)),vn.push(c.currentChannelHuddleUpdated.on(de)),vn.push($.onReconnect(tn)),window.addEventListener("dm-pendo-ready",Xe),window.addEventListener("pendoDismissEvent",nn),vn.push(function(){window.removeEventListener("dm-pendo-ready",Xe),window.removeEventListener("pendoDismissEvent",nn)}),h.currentChannel.id&&ee(),S=s.debounce(Ve,250),E=t.find(".pane-body"),O=E.height(),t.on("copy cut",Ze);var a=y.$on("domotalk-opened",function(){var n=0;if(s.size(e.messages)){var t=function e(){zn.is(":visible")?Ge():n++<10&&setTimeout(e,15)};setTimeout(t,15)}});vn.push(a),e.$on("$destroy",function(){for(var e=0;e<vn.length;e++)vn[e]();un&&un.off("keydown",an),cn&&cn(),ln&&ln()})}function T(n){n||(e.preventBannerShowing=!0),e.showMessagesBanner=!e.preventBannerShowing&&n}function I(){var e=a("bz-last-viewed-message"),n=0;e.length&&(n=e.parents(".message-wrapper").position().top),zn.animate({scrollTop:n},"500","easeInOutExpo")}function D(){e.panes=o.panes,e.state=o.states,1===e.panes&&e.state.indexOf("messages")?e.singleMessagePane=!0:e.singleMessagePane=!1}function R(){e.vm.i18n={accessGranted:v.get("buzz/access-granted"),active:v.get("buzz/active"),conversationMuted:v.get("buzz/conversation-muted"),directConversationStarted:v.get("buzz/direct-conversation-started",{user:e.channel.type}),conversationStarted:v.get("buzz/conversation-started"),include:v.get("buzz/include"),pinConversation:v.get("buzz/pin-conversation"),unPinConversation:v.get("buzz/unpin-conversation"),project:v.get("buzz/project"),page:v.get("buzz/page"),closeConversation:v.get("buzz/close-conversation")}}function j(n,t){function a(){return s.filter(t,function(e){return e.data.type==n.type&&e.data.value==n.value}).length>0}var i=h.currentChannel;if(i.id){var o=i.parentChannel,r=s.filter(t,function(e){return["CARD","PAGE","PROJECT"].indexOf(e.data.type)>=0}).length>0;e.vm.channelIsTransitivelyPublic&&r&&!e.createMessageApi.isCreatingPrivateThread()?e.channelCardWarning=!0:e.channelCardWarning=!1,i.isDirectChat()||o.isDirectChat()?"USER"!=n.type&&"GROUP"!=n.type||!a()?L(t):N(n,t):L(t)}}function L(n){e.mentions=n,e.createMessageApi&&(e.vm.isCreatingPrivateThread=e.createMessageApi.isCreatingPrivateThread())}function N(n,t){var a={accesses:[],defaultPermission:"ADMIN",publicPermission:"NONE",title:"",description:""},i="inviteToDirect";e.channel.getUsersWithAccess().then(function(r){var c=s.pluck(r,"id");if("USER"==n.type&&c.indexOf(""+n.value)>=0)return void L(t);var d=[];"USER"==n.type?c.push(n.value):"GROUP"==n.type&&d.push(n.value),w.open(i,{users:c,groups:d,onStart:function(){a.accesses.push.apply(a.accesses,b.formatUsers(c)),a.accesses.push.apply(a.accesses,b.formatGroups(d)),w.close(i);var n=e.createMessageApi.getUnsentMessage();return e.createMessageApi.reset(),l.createGroup(a).then(function(e){e&&(f.track("buzz_new_chat_creation",{channel_id:e.id,channel_type:e.type}),h.setCurrentChannel(e.id).then(function(){ne(n)}),o.messages())})},onCancel:function(){w.close(i)}}).then(function(){e.createMessageApi.removeMention(n.type,n.value)})})}function F(n,t){"CARD"==n.type&&s.findWhere(e.createMessageApi.getAttachments(),{type:n.type,value:n.value})||(t.splice(s.indexOf(t,n),1),j(n,t))}function H(){B()}function B(){e.autoGrantApi={},e.mentions=void 0,Se()}function G(e){l.setNotifyOnChannel(e,!0)}function V(n){delete e.channel.activeMessage,h.removeActiveMessage(n.id),e.messages=h.messages[n.id],q()}function q(t){function a(t,a){if(e.channel.id===a){hn=0;var i=t.messages,o=i[i.length-1];e.allMessagesLoaded=t.messages.length<45||0===t.messages.length;var r=b.setDateBreaks(i,!1,bn,e.lastViewedTimestamp);i[0]&&i[0].created>e.lastViewedTimestamp&&!e.channel.isObjectChannel()&&!r.lastViewedIsSet?T(!0):r.lastViewedIsSet||T(!1),ge(i,a,!0),o&&h.updateLastMessage(o),je(),J(),i[0]&&!e.viewingActiveMessage&&n.setLastMessage(a),s.defer(function(){e.$digest(),qe(null,!0),e.viewingActiveMessage?Re():je(),setTimeout(function(){Y()},150)}),W()}}function i(n){if(!(n.status<=0)){if(403==n.status)return e.messages=[],void(e.noChannelAccess=!0);hn++,q(!0)}}var o={},r=e.channel.id;e.channel;if(!(t&&hn>=10))return dn&&dn.resolve(),dn=g.defer(),e.viewingActiveMessage&&s.extend(o,{pagingLimit:10,pagingId:e.channel.activeMessage,pagingMode:"SURROUNDING"}),n.getMessages(r,o,dn.promise).then(function(e){a(e,r)},i)}function W(){for(var n=0;n<e.messages.length;n++)pn[e.messages[n].id]=e.messages[n]}function Y(){var n=a(".scroll-container-content");!e.allMessagesLoaded&&n.height()<zn.height()&&qe("up")}function J(){P=s.map(t.find(".message-wrapper"),function(e){return{wrapper:e,node:e.querySelector("bz-message")||e.querySelector("bz-huddle-message"),height:e.clientHeight}}),O=E.height()}function K(n){n.failed=!1,e.messages.splice(e.messages.indexOf(n),1),Te(n)}function Z(n){e.messages.splice(e.messages.indexOf(n),1),b.setDateBreaks([e.messages[e.messages.length-2],e.messages[e.messages.length-1]],!0,bn)}function Q(n){l.pinChannel(n).then(function(){e.channel.pin=!0})}function X(n){l.unpinChannel(n).then(function(){e.channel.pin=!1})}function ee(){function n(){return e.channel.parentChannel.isObjectChannel()?(e.channelObjectPromise=l.getChannelObject(e.channel.parentChannel),e.channelObjectPromise.then(function(n){e.vm.channelObject=n,e.channelObjectPromise=void 0}),e.channelObjectPromise):(e.vm.channelObject=void 0,g.resolve())}return e.channel.id===h.currentChannel.id?(e.lastViewedTimestamp=void 0,void q()):(B(),e.channel.unsentMessage=e.createMessageApi&&e.createMessageApi.getUnsentMessage(),s.defer(function(){e.createMessageApi.reset();var n=h.currentChannel;n.unsentMessage&&(n.unsentMessage.content||n.unsentMessage.attachments)&&(ne(n.unsentMessage),n.unsentMessage=null)}),hn=0,rn=null,e.vm.showThreadView=!1,e.showMessagesBanner=!1,e.preventBannerShowing=!1,e.allMessagesLoaded=!1,e.channel=h.currentChannel,e.lastViewedTimestamp=e.channel.isObjectChannel()?(new Date).getTime():e.channel.lastViewedTimestamp,e.viewingActiveMessage=!!e.channel.activeMessage&&e.channel.replyCount>U,e.messages=h.messages[e.channel.id],e.animate=!0,e.ramHeader=x.on("ram-header")||"SYSTEM"===e.channel.themType&&"buzzintro"===e.channel.themId,bn="ObjectChat"===e.channel.type?"lastUpdated":"created",ze(),q().finally(function(){"messages"===o.current&&e.createMessageApi&&e.createMessageApi.focus&&(e.createMessageApi.focus(),un.off("keydown",an),un.on("keydown",an)),e.animate=!1}).catch(function(e){console.error(e)}),ie(),e.giphyResults=[],e.noChannelAccess=!1,e.cardDetails={},e.usersTyping={},e.userTypingData={numUsersTyping:0,first:null,second:null},"Topic"===e.channel.type&&(e.channel.createdBy=s.find(e.channel.accesses,{id:e.channel.createdById})),Ge(),te(),ae(),oe(),void n().then(function(){var n=e.channel,t=n.parentChannel;e.vm.channelIsTransitivelyPublic=n.isPublicSomehow()||t&&t.isObjectChannel()&&"PROJECT"==t.objectType&&e.vm.channelObject&&0==e.vm.channelObject.hidden}))}function ne(n){e.createMessageApi.addText(n.content),s.each(n.attachments,function(n){e.createMessageApi.addAttachment(n)}),n.mentions.length&&(s.each(n.mentions,function(n){"@"===n.marker&&e.createMessageApi.insertMention(n)}),L(e.createMessageApi.getMentions())),h.currentChannel.isObjectChannel()&&s.defer(function(){fe(),e.$digest()})}function te(){var n=e.channel.normalizedChannelType,t=e.channel.parentObjectType||e.channel.objectType,a=e.channel.parentObjectId||e.channel.objectId;"ObjectChat"===n&&"CARD"===t&&l.getCardDetails(a).then(function(n){e.cardDetails=n,n.image.data?e.cardDetails.image.data="data:image/png;base64,"+e.cardDetails.image.data:console.log("wasn't able to load image for cardDetails",e.cardDetails,e.channel)},function(){})}function ae(){if(s.has(e.channel,"title")){if(e.channel.created&&(e.header.date=i(e.channel.created).format("LL")),"27"===e.channel.themId||e.channel.title&&"domosupport"===e.channel.title.replace(/ /g,"").toLowerCase())e.header.title=v.get("buzz/create-support-ticket-title"),e.header.text=v.get("buzz/create-support-ticket");else if("SYSTEM"==e.channel.themType&&"buzzintro"===e.channel.themId)e.header.title=v.get("buzz/hello-there"),e.header.text=v.get("buzz/welcome-to-buzz");else if(e.ramheader)if(e.channel.isDirectChat()){var n=void 0;e.header.title=v.get("buzz/get-chat-on"),e.channel.accesses.length>1?(n=v.get("buzz/user-and-user",{user1:e.channel.accesses[0].DISPLAY,user2:e.channel.accesses[1].DISPLAY}),n=s.unescape(n)):n=e.channel.accesses[0].DISPLAY,e.header.text=v.get("buzz/conversation-started-on-date",{title:n,date:e.header.date})}else e.channel.isObjectChannel()?(e.header.title=v.get("buzz/get-data-lowdown"),e.header.text=v.get("buzz/so-title-begins",{title:e.channel.title})):e.channel.isObjectChannel()||(e.header.title=v.get("buzz/get-chat-on"),e.header.text=v.get("buzz/conversation-started-on-date",{title:e.channel.title,date:e.header.date}));else if("DirectChat"!==e.channel.type&&"Topic"!==e.channel.type)e.header.text=v.get("buzz/conversation-started-in-channel",{channel:e.channel.title,date:e.header.date}),e.header.title=e.vm.i18n.conversationStarted;else if("DirectChat"===e.channel.type){var t=s.find(e.channel.accesses,{id:e.channel.formattedThemId});e.header.title=v.get("buzz/conversation-started-direct-chat",{name:t.DISPLAY}),e.header.text=v.get("buzz/conversation-started-in-direct-chat",{name:t.DISPLAY,date:e.header.date})}else"Topic"===e.channel.type&&e.channel.createdBy?"NONE"!==e.channel.publicPermission?(e.header.title=v.get("buzz/conversation-started-huddle-chat",{name:e.channel.title}),e.header.text=v.get("buzz/conversation-started-in-topic-channel",{channel:e.channel.title,creator:e.channel.createdBy.DISPLAY,date:e.header.date})):(e.header.title=v.get("buzz/conversation-started-private-channel",{name:e.channel.title}),e.header.text=v.get("buzz/conversation-started-in-channel",{channel:e.channel.title,date:e.header.date})):"Topic"!==e.channel.type||e.channel.createdBy||(e.header.text=v.get("buzz/conversation-started-in-channel",{channel:e.channel.title,date:e.header.date}),e.header.title=e.vm.i18n.conversationStarted);e.header.text=s.unescape(e.header.text),e.header.title=s.unescape(e.header.title)}}function ie(){switch(e.channel.type){case"DirectChat":f.track("buzz_conversation_viewed_direct",{channel_id:e.channel.id,channel_type:e.channel.type});break;case"GroupChat":f.track("buzz_conversation_viewed_group",{channel_id:e.channel.id,channel_type:e.channel.type});break;case"Topic":e.channel.isPrivateChannel()?f.track("buzz_conversation_viewed_private_channel",{channel_id:e.channel.id,channel_type:e.channel.type}):f.track("buzz_conversation_viewed_public_channel",{channel_id:e.channel.id,channel_type:e.channel.type});break;case"ObjectChat":f.track("buzz_conversation_viewed_object_channel",{channel_id:e.channel.id,channel_type:e.channel.type});break;case"Huddle":f.track("buzz_conversation_viewed_thread",{channel_id:e.channel.id,channel_type:e.channel.type})}}function se(){if(e.channel.id===h.currentChannel.id){var n=!!e.channel.activeMessage;e.channel=h.currentChannel,e.viewingActiveMessage=!!e.channel.activeMessage&&e.channel.replyCount>U,e.viewingActiveMessage&&!n&&q(),e.channel.unsentMessage&&(e.channel.unsentMessage.content||e.channel.unsentMessage.attachments)&&(ne(e.channel.unsentMessage),e.channel.unsentMessage=null),e.animate=!1}}function oe(){e.channel.unreadCounts&&e.channel.unreadCounts.messages>0?e.lastViewed=e.channel.lastViewedMessageId:e.lastViewed=void 0}function re(n){if(n.rootChannelId!==n.channelId&&n.rootChannelId===e.channel.id&&ue(n),!e.channel.activeMessage&&e.channel.id===n.channelId){for(var t,a=e.messages.length-1;a>=0;a--){var i=e.messages[a];if(i.id==n.id){t=i;break}if(s.has(i,"clientUID")&&i.clientUID==n.clientUID){t=i;break}}t?s.extend(t,n):(e.currentlyTyping={},he(n),Oe(n)),W()}}function ce(n){if(n.rootChannelId!==n.channelId&&n.rootChannelId===e.channel.id&&ue(n),e.channel.id===n.channelId){var t=zn[0].scrollHeight-zn[0].scrollTop>zn[0].clientHeight+fn;if(!e.channel.activeMessage){var a=s.findWhere(e.messages,{id:n.id});if(a){var i=n.attachments;delete n.attachments,s.extend(a,n),s.each(a.attachments,function(e){s.findWhere(i,{id:e.id})||(e.id=null)}),s.each(i,function(e){var n=s.findWhere(a.attachments,{id:e.id});n?s.extend(n,e):a.attachments.push(e)}),a.attachments=s.reject(a.attachments,{id:null}),"SYSTEM"===a.messageType&&a.quote&&delete a.quote,t||je()}}}}function le(e){pn[e.channelId]&&(pn[e.channelId].importantCounts=e.meta.huddle.importantCounts)}function de(e){pn[e.id]&&(pn[e.id].importantCounts=e.importantCounts,pn[e.id].unreadCounts=e.unreadCounts,pn[e.id].title=e.title)}function ue(e){pn[e.channelId]&&(pn[e.channelId].messages[0]=e,pn[e.channelId].unreadCounts.messages++)}function pe(n){if(e.messages&&e.messages.length){var t=e.messages[e.messages.length-1];t.droidPrompts=n}}function he(n){var t=zn[0].scrollHeight-zn[0].scrollTop>zn[0].clientHeight+fn,a=n.id?s.findWhere(e.messages,{id:n.id}):void 0;if(a)s.extend(a,n);else{t||Je(),sn&&e.$$postDigest(Ye),ge(e.messages.concat([n]),e.channel.id);var i=e.messages.indexOf(n);i>=0&&b.setDateBreaks([e.messages[i-1],e.messages[i],e.messages[i+1]],!0,bn)}}function ge(n,t,a){if(e.messages&&a){var i={};e.messages.forEach(function(e){i[e.id]=e}),n.forEach(function(e){i[e.id]&&(e.$$hashKey=i[e.id].$$hashKey)})}h.messages[t]=n,t===e.channel.id&&(e.messages=h.messages[t])}function me(n){f.track("buzz_message_reply",{channel_id:e.channel.id,channel_type:e.channel.type}),e.createMessageApi.quoteMessage(n)}function be(t){n.deleteMessage(t,e.channel.id).then(function(){f.track("buzz_message_deleted",{channel_id:e.channel.id,channel_type:e.channel.type}),c.messageDeleted.trigger(t);for(var n=e.messages.length;n>0;--n)if(e.messages[n]&&e.messages[n].id===t){e.messages[n].content.text=v.get("buzz/message-deleted"),e.messages[n].messageType="SYSTEM";break}},function(){console.error(v.get("buzz/error-deleting"))})}function ve(n,t){var a=/^\/support\b/,i=/^\/invite\b/;return a.test(n.content.text)?(Ce(n,t),!0):!(!x.on("free-invite")||!i.test(n.content.text)||"DirectChat"===e.channel.parentChannel.type)&&(!("ObjectChat"===e.channel.parentChannel.type&&!p.on("buzz.admin"))&&(ke(n),!0))}function fe(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};n.message&&n.message.id!==e.channel.id||(e.threadOnlyButton=!1,we(),f.track("buzz_new_conversation"),s.defer(function(){t.find(".message-input .content-editable")[0].focus()}))}function ze(){e.threadOnlyButton=!!e.channel.type&&e.channel.isObjectChannel(),a('bz-pane[pos="2"]').removeClass("show-overlay raise-footer")}function ye(){e.channel.isObjectChannel()&&(e.threadOnlyButton=!0,we())}function we(){e.threadOnlyButton?a('bz-pane[pos="2"]').removeClass("show-overlay raise-footer"):a('bz-pane[pos="2"]').addClass("show-overlay raise-footer")}function ke(n){function a(n){e.createMessageApi.inviteNewUser(n,!0).then(function(){s.close()},function(){s.close()})}var i=n.content.text.replace(/^\/invite/,"").trim(),s=k.open({element:t,prepop:i,message:v.get("common/invite-new-description"),analyticsEvent:"buzz_typeahead",onSubmit:a,onInvite:angular.noop})}function Ce(e,n){w.open("createSupportTicket",{message:e,onSubmit:n},{"control-close":"true"})}function xe(n,t,a,i,o,r,c){if(T(!1),A.close(),c||!ve(n,function(e){Te(e)}))if(t){var u={title:n.content.text,description:"",inheritPermissions:a||!1,firstMessageContent:n.content,firstMessageAttachments:n.attachments,firstMessageQuoteId:n.quote&&n.quote.id};i&&(u.messageIdsToCopy=[i.id]),u.accesses=[],s.each(o,function(e){e>1&&u.accesses.push({type:"USER",id:e})}),s.each(r,function(e){e>1&&u.accesses.push({type:"GROUP",id:e})}),"DirectChat"===e.channel.type&&(u.accesses=[{type:"USER",id:+e.channel.themId}]),ye();var p=s.uniqueId((new Date).getTime()+"_"+d+"_");u.clientUID=p;var h=_e(n,u,p);he(h),l.createThread(e.channel.id,u).then(function(n){var t=s.findWhere(e.messages,{id:n.id});t||(t=s.findWhere(e.messages,{clientUID:n.clientUID})),t&&(t=s.extend(t,n)),f.track("buzz-thread-created",{channel_id:e.channel.id,channel_type:e.channel.type,parent_channel_type:e.channel.parentChannel.type
}),B(),je()})}else Te(n)}function _e(e,n,t){var a=s.extend({},e);return a.created=(new Date).getTime(),a.createdById=a.createdBy.id,a.inheritPermissions=n.inheritPermissions,a.messages=[s.extend({},a)],a.id=s.uniqueId(),a.clientUID=t,a.type="Huddle",a}function Te(t,a,i){function o(a){var i;switch(a.content||a.id||(i=e.messages.indexOf(t),e.messages.splice(i,1)),t.failed=!1,gn=0,e.channel.type){case"DirectChat":f.track("buzz_message_created_direct",{channel_id:e.channel.id,channel_type:e.channel.type});break;case"GroupChat":f.track("buzz_message_created_group",{channel_id:e.channel.id,channel_type:e.channel.type});break;case"Topic":e.channel.isPrivateChannel()?f.track("buzz_message_created_private_channel",{channel_id:e.channel.id,channel_type:e.channel.type}):f.track("buzz_message_created_public_channel",{channel_id:e.channel.id,channel_type:e.channel.type});break;case"ObjectChat":f.track("buzz_message_created_object_channel",{channel_id:e.channel.id,channel_type:e.channel.type});break;case"Huddle":f.track("buzz_message_created_thread",{channel_id:e.channel.id,channel_type:e.channel.type,parent_channel_type:e.channel.parentChannel.type})}var o=t.attachments;return ln=c.messageReceived.on(function(e){e.id===t.id&&(n.checkPendingAttachments(o).then(function(e){e&&(t.attachments=e,n.updateMessage(t))}),ln())}),delete a.attachments,s.extend(t,a),e.channel.activeMessage&&V(e.channel),B(),c.messageSent.trigger(),t}function r(n){if(gn<mn&&a)return gn++,Te(t,a);gn=0,t.failed=!0;var i=e.messages.indexOf(t);return b.setDateBreaks([e.messages[i-1],e.messages[i],e.messages[i+1]],!0,bn),g.reject(n)}e.giphyResults=[],m.logActivity(),t.id=s.uniqueId(),t.created=(new Date).getTime(),t.type="Message",t.clientUID=s.uniqueId(t.created+"_"+d+"_"),Oe(t),he(t),je(),n.sendMessage(e.channel.id,t).then(o,r)}function Me(n){var t=e.mentions||[],a=Ie(n);$e(a)||(t.push(a),j(a,t))}function Ie(e){var n={data:e};return n.data.value=n.data.id,n}function $e(n){return s.filter(e.mentions,function(e){return e.data.type==n.data.type&&e.data.value==n.data.value}).length>0}function Ae(n,t){var a=Ie(n);if("CARD"==a.data.type){for(var i=!1,o=e.createMessageApi.getMentions(),r=0;r<o.length;r++){var c=o[r].data;if(c.type==a.data.type&&c.value==a.data.value){i=!0;break}}if(i)return}var l=e.mentions||[];l=s.filter(l,function(e){return e.data.type!=a.data.type&&e.data.value!=a.data.value}),L(l),e.channelCardWarning=!1}function Se(){e.channelCardWarning=!1}function Pe(n){n.forEach(function(e){e.images.fixed_height_small.url=e.images.fixed_height_small.url.replace(/http(?!s)/,"https")}),e.giphyResults=n}function Ee(n){e.createMessageApi.moveCursorToEnd(),e.createMessageApi.addText(" #"+n.id)}function Oe(n){e.channel.lastViewedMessageId=n.id}function Ue(){angular.element(".new-search-button").click()}function De(e,n){var a=t.find('bz-message[message-id="'+e+'"]'),i=a.position().top+a.find(".content").height()+(n||0),o=zn.scrollTop()+zn.height();i>o&&s.defer(function(){zn.scrollTop(i-zn.height())})}function Re(){zn.scrollTop(t.find('bz-message[message-id="'+e.channel.activeMessage+'"]').position().top-40)}function je(){s.defer(function(){e.$digest(),zn.scrollTop(zn[0].scrollHeight)})}function Le(n){n.channelId===e.channel.id&&n.userId!=d&&"Topic"!==e.channel.type&&"Huddle"!==e.channel.type&&(Ne(n,n.status),s.defer(function(){e.$digest()}))}function Ne(n,t){var a,i=e.usersTyping,s=i[n.userId];s?(clearTimeout(s.waiter),"OFF"===t?Be(s):s.waiter=setTimeout(s.remove,8e3)):"ON"===t&&(s=i[n.userId]=n,a=Object.keys(i),e.userTypingData.numUsersTyping=a.length,e.userTypingData.first=a[0]?Fe(a[0]):null,e.userTypingData.second=a[1]?Fe(a[1]):null,s.remove=He(s),s.waiter=setTimeout(s.remove,8e3))}function Fe(n){var t=e.usersTyping[n];return t&&t.properties["USER:"+n].DISPLAY}function He(e){return function(){Be(e)}}function Be(n){var t=e.usersTyping;delete t[n.userId],e.userTypingData.numUsersTyping=Object.keys(t).length,s.defer(function(){e.$digest()})}function Ge(){sn=!1,je()}function Ve(){e.messages&&e.messages.length>450&&Ke()}function qe(t,a){if(S(),e.scrollDirection=t,!(zn[0].scrollTop>1e3||"down"===t||e.allMessagesLoaded)){if(e.viewingActiveMessage||e.messages&&!e.messages.length)return sn=!0,void Ye();if(!a&&!on){var i,o={},r=We();if(on=g.defer(),e.messagesLoading=!0,on.promise.then(function(){on=null,e.messagesLoading=!1}),!r)return e.messages&&(sn=!0,Ye()),void on.resolve();o.pagingId=r.id,i=e.channel.id,n.getMessages(i,o).then(function(n){if(!(e.channel.id!==i||e.messages&&s.findWhere(n.messages,{id:e.messages[0].id}))){var t=n.messages.concat(e.messages),a=zn[0].scrollHeight,o=zn[0].scrollTop,r=window.requestAnimationFrame||s.defer;e.allMessagesLoaded=n.messages.length<45||0===n.messages.length,b.setDateBreaks(t,void 0,bn,e.lastViewedTimestamp),ge(t,i),J(),r(function(){zn[0].scrollTop=o+zn[0].scrollHeight-a,Y()}),W(),on.resolve()}})}}}function We(){return s.first(e.messages)}function Ye(e){var n=t.find(".messages-start");n.is(".ng-hide")&&n.removeClass("ng-hide"),s.defer(function(){e&&zn.scrollTop(0)})}function Je(){var n=e.messages;n&&n.length>250?(n.splice(0,n.length-200),Ge()):je()}function Ke(){for(var e,n,t,a=0;a<P.length;a++)if(e=P[a],e.node)if(t=1500+e.height/2,n=e.wrapper.getBoundingClientRect(),n.bottom<-t||n.top>O+t){if(e.wrapper.style.height)continue;e.node.style.display="none",e.wrapper.style.height=e.height+"px"}else{if(!e.wrapper.style.height)continue;e.node.style.display="block",e.wrapper.style.height=null}}function Ze(){try{var n=[],t=[],i=window.getSelection(),o=a(i.getRangeAt(0).startContainer).parents(".message-wrapper"),r=a(i.getRangeAt(i.rangeCount-1).endContainer).parents(".message-wrapper");if(o&&r){var c=e.messages.indexOf(o.scope().message),l=e.messages.indexOf(r.scope().message);t=e.messages.slice(Math.min(c,l),Math.max(c,l)+1)}s.each(t,function(e){e.content&&e.content.tags&&s.each(e.content.tags,function(t){"@"===t.prefix&&(t.displayName=e.content.text.substr(t.start,t.length).replace("@",""),t.value=t.id,n.push(t))})}),C.setClipboard(i.toString(),n)}catch(e){}}function Qe(){l.launchTour()}function Xe(){en(),window.removeEventListener("dm-pendo-ready",Xe)}function en(){window.pendo&&window.pendo.events.guidesLoaded(function(){!u.SOCIAL_USER&&!x.on("free-domo")&&_.enableBuzzPendo&&l.tourAvailable()&&M.isSocialTrial().then(function(n){e.showPendo=!n})})}function nn(){e.showPendo=!1,f.track("buzz_pendo_closed"),_.enableBuzzPendo=!1}function tn(){q()}function an(n){if(38===n.keyCode&&!un.text()){var a=s.sortBy(s.filter(e.messages,function(e){return e.createdById==d+""&&"SYSTEM"!==e.messageType&&"Message"==e.type}),["created"]);if(a.length){var i=void 0,o=void 0,r=void 0;o=t.find("bz-message[message-id="+a[a.length-1].id+"] .message-container"),r=o.scope(),r&&(r.toggleEditMode(),cn&&cn(),cn=c.onMessageEditClose.on(function(){e.createMessageApi.focus(),cn()}),i=o.parents(".message-wrapper").position().top,zn.animate({scrollTop:i},"500","linear"))}}}var sn,on,rn,cn,ln,dn,un,pn={},hn=0,gn=0,mn=2,bn=e.channel&&"ObjectChat"===e.channel.type?"lastUpdated":"created",vn=[],fn=120,zn=t.find("[scroll-container]");un||s.defer(function(){un=t.find(".pane-footer bz-create-message.messages-create-message .content-editable")}),z()}}}])},1749:function(e,n){e.exports='<div class="bz-messages pane">\n<bz-messages-header show-thread-view=vm.showThreadView></bz-messages-header>\n<div ng-if=showMessagesBanner ng-hide=vm.showThreadView class=new-messages-banner ng-class="{\'huddle-banner\': channel.type === \'Huddle\'}" ng-click=scrollToNewMessages()>\n<span class=tab-wrapper>\n<span dm-i18n=buzz/new-messages></span>\n<i class="icon-x md" ng-click="setNewMessagesBanner(undefined)" db-stopbubble></i>\n</span>\n</div>\n<div class="pane-body padding-bottom-small" ng-class="{\'loading-messages\': messages == undefined}" scroll-container dm-on-scroll=scrollHandler(scrollDirection)>\n<span ng-if=noChannelAccess class=no-access-message><i class=icon-lock-closed></i><span dm-i18n=buzz/no-channel-access></span></span>\n<div scroll-container-content class="scroll-container-content position-relative">\n<div class=loading ng-hide=allMessagesLoaded ng-class="{in: messagesLoading}"><div class="spinner large"></div></div>\n<bz-messages-body channel=channel messages=messages quote-message=quoteMessage(message) on-delete=deleteMessage(messageId) create-message-callbacks=createMessageCallbacks last-viewed=channel.lastViewedTimestamp focus-message="focusMessage(messageId, extra)">\n<div class="messages-start dm-animate" ng-class="{data: channel.isObjectChannel() && ramHeader, people: !channel.isObjectChannel() && ramHeader}" ng-if="allMessagesLoaded && !viewingActiveMessage && channel.type != \'Huddle\'">\n<div class=bold ng-class="{\'messages-start-title\': ramHeader, \'bz-text-body\': !ramHeader}">{{header.title}}</div>\n<div class=italics ng-class="{\'messages-start-subtitle\': ramHeader, \'bz-text-body\': !ramHeader}">{{header.text}}</div>\n</div>\n</bz-messages-body>\n</div>\n</div>\n<div class="pane-footer no-padding">\n<div class=pendo-tour ng-if=showPendo>\n<i class="icon-x float-right margin-right-medium margin-top-medium color-gray-9 cursor-pointer" ng-click=dismissTour()></i>\n<img class=pendo-logo src=/public/javascripts/buzz/buzz-blue.png />\n<div class=pendo-text>\n<div class=tour-header dm-i18n=buzz/tour-header></div>\n<div class=tour-message dm-i18n=buzz/tour-message></div>\n<db-button class=start-tour theme=primary ng-click=launchTour() dm-i18n=buzz/take-a-tour></db-button>\n</div>\n</div>\n<div class=search-results-banner ng-if=viewingActiveMessage>\n<div class=content>\n<div class=bz-text-display-6 dm-i18n=buzz/viewing-selected-message></div>\n<div class="bz-text-caption secondary" dm-i18n=buzz/not-all-messages-displayed></div>\n</div>\n<div class=actions>\n<db-button ng-click=viewFullChannel(channel) dm-i18n=buzz/view-all></db-button>\n</div>\n</div>\n<div class="bz-text-caption secondary padding-vertical-xxsmall padding-horizontal-xsmall" ng-if=channelCardWarning>\n<div>\n<i class="icon-exclamation-triangle color-alert-yellow"></i>\n<span dm-i18n=buzz/only-people-with-access data="{type: getChannelType()}" class=padding-horizontal-xsmall></span>\n<a href=# ng-click=clearAccessWarnings() dm-i18n=buzz/got-it></a>\n</div>\n</div>\n<bz-auto-grant-access class=auto-grant-access ng-if="mentions.length && (vm.channelIsTransitivelyPublic == false || (vm.channelIsTransitivelyPublic == true && createMessageApi.isCreatingPrivateThread()))" mentions=mentions on-access-exists=finishedGrantAccess() api=autoGrantApi share-objects={{!vm.isCreatingPrivateThread}}></bz-auto-grant-access>\n<div class="context-object hide-when-electron" ng-if="contextObject.type && contextObject.id != channel.objectId && !((channel.type === \'Topic\' || channel.type === \'ObjectChat\') && (!channel.pin || channel.invited)) && contextObject.type !== \'PAGE\'">\n<div class=icon-left></div>\n<div class=viewing dm-i18n=buzz/viewing-object-title data="{title: contextObject.title}"></div>\n<db-button ng-click=includeCard()>{{vm.i18n.include}}</db-button>\n</div>\n<div ng-show="userTypingData.numUsersTyping > 0" class="currently-typing padding-left-large">\n<span ng-switch=userTypingData.numUsersTyping class="bz-text-caption secondary">\n<span ng-switch-when=1 dm-i18n=buzz/one-user-typing data="{user1: userTypingData.first}"></span>\n<span ng-switch-when=2 dm-i18n=buzz/two-users-typing data="{user1: userTypingData.first, user2: userTypingData.second}"></span>\n<span ng-switch-default="" dm-i18n=buzz/two-plus-users-typing data="{user1: userTypingData.first, user2: userTypingData.second, users: userTypingData.numUsersTyping - 2}"></span>\n<span>...</span>\n</span>\n</div>\n<bz-giphy-selector class=dm-animate ng-if=giphyResults.length gifs=giphyResults on-gif-selected=onGifSelected(gif)></bz-giphy-selector>\n<div class=thread-only-container ng-if=threadOnlyButton>\n<db-button ng-click=showThreadCreation() size=large class=thread-only-button>\n<a dm-i18n=buzz/plus-new-conversation></a>\n</db-button>\n</div>\n<bz-create-message class=messages-create-message ng-hide="noChannelAccess || threadOnlyButton" api=createMessageApi on-giphy-search=onGiphySearch(giphyResults) on-create="createMessage(message, postThreadMentionData, isPublicThread, convertedMessage, users, groups)" on-attachment-added=attachmentAdded(attachment) on-attachment-removed=attachmentRemoved(attachment,attachments) on-mentioned="entityMentioned(mention, mentions)" on-unmentioned="entityUnmentioned(mention, mentions)" on-cancel-thread=cancelThreadCreation() disable-thread="channel.type === \'Huddle\' || (objectsThreadOnly && channel.isObjectChannel())"></bz-create-message>\n</div>\n<bz-thread-view ng-if=vm.showThreadView channel=channel.parentChannel show=vm.showThreadView></bz-thread-view>\n</div>'},1750:function(e,n,t){var a=t(47);angular.module("buzz").directive("bzAttachment",["bzRootPath","bzEvents","dmUserService","Analytics","features","bzHrefService","$sce","dmUtils","$timeout","Auth","dmI18n","bzMessageService","jstz",function(e,n,i,s,o,r,c,l,d,u,p,h,g){return{restrict:"E",scope:{attachment:"=",messageId:"=",preventClickEvents:"=?",huddleMessageId:"=?",layout:"@"},template:t(1751),link:function(e,t,l){function d(){if(e.fullscreenApi={},e.toggleText=e.attachment.userMeta&&e.attachment.userMeta.HIDDEN?p.get("buzz/show"):p.get("buzz/hide"),e.timeCreated=b,e.onClick=w,e.badgeLoadError=y,e.docPreviewLoaded=z,e.badgeClick=f,e.toggleAttachment=C,!e.attachment.title&&e.attachment.description&&(e.attachment.title=e.attachment.description,e.attachment.description=null),"expanded"!==e.layout&&v(),"URL_PREVIEW"===e.attachment.type&&(e.attachment.description.text=m(e.attachment.description.text),e.attachment.embedded&&"URL_PREVIEW"===e.attachment.embedded.type&&(e.attachment.embedded.trustedUrl=c.trustAsResourceUrl(e.attachment.embedded.url))),"FILE"===e.attachment.type){var n=/\.(bmp|gif|jpg|jpeg|png|svg|tif|tiff|wmf)$/i;e.$watch("attachment",function(){e.isImage=e.attachment.title.text&&(n.test(e.attachment.title.text)||"image"===e.attachment.title.text),e.isImage&&e.attachment.image&&k()})}}function m(e){var e=e.split("://"),n=e.pop(),t=e.length?e.shift()+"://":"",a=n.split("/").shift();return t+a}function b(){return a(e.attachment.created).tz(x).format(p.get("date-formats/month-day-time"))}function v(){e.attachment.createdById&&i.getUser(e.attachment.createdById).then(function(n){e.creator=n})}function f(){u.SOCIAL_USER&&s.track("social_card_click_in_buzz")}function z(n){e.hideDocPreviewSpinner=!0}function y(n){e.showBadgeAccesError=!0}function w(t){if(t.stopPropagation(),!e.attachment.image||"URL_PREVIEW"!==e.attachment.image.type){s.track("buzz_attachments_on_conversation_viewed"),e.fullscreenApi.toggle&&e.fullscreenApi.toggle(!0);var a=function(e){if(o.isElectron()&&e)r.sendUrlToBrowser(e);else{var n=window.open(e,"_blank");n.focus()}};"URL_PREVIEW"==e.attachment.type&&e.attachment.id?a(e.attachment.description.text):"CARD"!==e.attachment.type||e.attachment.searchResult||e.showBadgeAccesError?"COMMAND"===e.attachment.type&&"weather"===e.attachment.id&&a("http://openweathermap.org/city/"+escape(e.attachment.fields[0].title.text)):n.cardMentionClicked.trigger({cardId:e.attachment.id})}}function k(){var n=720,t=360,a=parseInt(e.attachment.image.width),i=parseInt(e.attachment.image.height);a&&i?(a>n&&(i*=n/a,a=n),i>t&&(a*=t/i,i=t)):(a=360,i=280,e.useDefaultApectRatio=!0),e.displayWidth=a,e.displayHeight=i}function C(n){function t(n){e.attachment.image&&("giphy"==e.attachment.id?n?s.track("buzz_gif_hide"):s.track("buzz_gif_show"):n?s.track("buzz_image_hide"):s.track("buzz_image_show"))}n.stopPropagation(),e.attachment.userMeta&&e.attachment.userMeta.HIDDEN?(e.toggleText=p.get("buzz/hide"),e.attachment.userMeta.HIDDEN=!1,h.showAttachment(e.messageId,e.attachment.id),t(!1)):(e.attachment.userMeta||(e.attachment.userMeta={}),e.attachment.userMeta.HIDDEN=!0,e.toggleText=p.get("buzz/show"),t(!0),h.hideAttachment(e.messageId,e.attachment.id),e.huddleMessageId&&h.hideAttachment(e.huddleMessageId,e.attachment.id))}var x=g.determine().name();d()}}}])},1751:function(e,n){e.exports='\n<div class=attachment-title-bar ng-if="layout === \'expanded\' && attachment.image && messageId" ng-click=toggleAttachment($event)>\n<span class=attachment-title>{{attachment.attachmentTitle}}</span>\n<span class=media-collapse>\n<i class="icon-chevron-down sm giphy-chevron" ng-class="{\'rotate-right\': attachment.userMeta && attachment.userMeta.HIDDEN}"></i>\n<span class=media-toggle-text>{{toggleText}}</span>\n</span>\n</div>\n<span ng-class="{\'pointer-events-none\': preventClickEvents}">\n<div class=bz-attachment-inner ng-click=onClick($event) ng-class="{\'is-image\': isImage}" ng-switch="layout === \'expanded\'">\n<div class=attachment-collapsed ng-switch-when=false>\n<div class=attachment-content>\n<div class=attachment-thumbnail>\n<div ng-if="attachment.progress !== undefined && attachment.progress < 100" class="bz-progress-bar dm-animate">\n<div class=bar ng-style="{width: attachment.progress + \'%\'}"></div>\n</div>\n<dm-badge badge=attachment.id size=mini interactive=false click-handler=badgeClick() header=false footer=false frame=false ng-if="attachment.type === \'CARD\'"></dm-badge>\n<doc-preview toggle-fullscreen-api=fullscreenApi file-id=attachment.id size=micro full-screen-on-click ng-if="attachment.type === \'FILE\'" file-width="attachment.image && attachment.image.width"></doc-preview>\n<img ng-if="attachment.thumb.url || (attachment.image.url && attachment.type !== \'FILE\')" ng-src="{{ attachment.thumb.url || attachment.image.url}}"/>\n<i class=icon-hyperlink ng-if="attachment.type === \'URL_PREVIEW\' && !attachment.thumb.url" style=font-size:42px;color:#555;line-height:44px></i>\n</div>\n<div class=attachment-details>\n<div class=attachment-details-primary-content>\n<bz-markup-renderer class="attachment-name bz-text-body bold" content=attachment.title></bz-markup-renderer>\n<bz-markup-renderer class="attachment-description bz-text-caption secondary" content=attachment.description></bz-markup-renderer>\n<span class=attachment-creator ng-if=creator><span>{{creator.displayName}}</span><span ng-if="attachment.created && layout !== \'expanded\'" class=dot-separator>&#183;</span><span ng-if="attachment.created && layout !== \'expanded\'">{{::timeCreated()}}</span></span>\n</div>\n</div>\n</div>\n</div>\n<div class=attachment-expanded ng-switch-when=true ng-switch=attachment.type ng-class="{\'collapsed\': attachment.userMeta && attachment.userMeta.HIDDEN}">\n<span ng-switch-when=CARD ng-class="{\'bz-no-access\':showBadgeAccesError}">\n<dm-badge badge=attachment.id size=medium interactive=false ng-if=!attachment.searchResult click-handler="showBadgeModal(model); badgeClick();" onerror=badgeLoadError(error) show-overlay=true>\n<div class=bz-badge-access-error ng-if=showBadgeAccesError>\n<div><i class=icon-lock-closed></i> <span dm-i18n=buzz/no-access-to-attachment></span></div>\n</div>\n</dm-badge>\n<dm-badge badge=attachment.id size=medium interactive=false click-handler=badgeClick() details-link=false ng-if=attachment.searchResult></dm-badge>\n</span>\n<div class=file-attachment-preview ng-switch-when=FILE ng-hide=attachment.image>\n<div class="spinner medium" ng-hide=hideDocPreviewSpinner></div>\n<doc-preview class=body on-done-loading=docPreviewLoaded(status) toggle-fullscreen-api=fullscreenApi file-id=attachment.id size=medium full-screen-on-click file-width="attachment.image && attachment.image.width"></doc-preview>\n<div class=footer>\n<bz-markup-renderer class=title content=attachment.title></bz-markup-renderer>\n<bz-markup-renderer class=description content=attachment.description></bz-markup-renderer>\n</div>\n</div>\n<div class=file-attachment-image ng-show=attachment.image ng-style="{width: displayWidth}" ng-switch-when=FILE>\n<div ng-if=!useDefaultApectRatio class=image-attachment-wrapper ng-style="{paddingTop:(displayHeight/displayWidth*100) + \'%\'}">\n<img ng-src={{attachment.image.url}} />\n</div>\n<div ng-if=useDefaultApectRatio class=default-aspect-ratio ng-style="{height: displayHeight, width: displayWidth, backgroundImage: \'url(\'+attachment.image.url+\')\'}"></div>\n</div>\n<div class="url-attachment-preview attachment-content" ng-switch-when=URL_PREVIEW ng-hide=!attachment.title.text.length>\n<div class=attachment-thumbnail ng-show=attachment.thumb.url ng-style="{\'background-image\': \'url(\'+ attachment.thumb.url +\')\'}"></div>\n<div class=attachment-thumbnail ng-hide=attachment.thumb.url>\n<i class=icon-hyperlink style=font-size:42px;color:#555;line-height:44px></i>\n</div>\n<div class=attachment-details ng-if="attachment.name || attachment.description">\n<bz-markup-renderer class="attachment-name bz-text-body bold" content=attachment.title></bz-markup-renderer>\n<bz-markup-renderer class="attachment-description bz-text-caption secondary" content=attachment.description></bz-markup-renderer>\n</div>\n</div>\n<div class=url-embedded-video ng-if=attachment.embedded ng-switch-when=URL_PREVIEW>\n<iframe class=video-embed-frame ng-src={{attachment.embedded.trustedUrl}} type=text/html frameborder=0 />\n</div>\n<div class="default-attachment-preview attachment-content" ng-switch-default>\n<div class=attachment-thumbnail ng-show=attachment.thumb.url>\n<img ng-src={{attachment.thumb.url}} />\n</div>\n<div class=attachment-details>\n<div ng-if="attachment.name || attachment.description">\n<bz-markup-renderer class="attachment-name bz-text-body bold" content=attachment.title></bz-markup-renderer>\n<bz-markup-renderer class=attachment-description content=attachment.description></bz-markup-renderer>\n</div>\n<div class=attachment-fields>\n<div class=attachment-field ng-repeat="field in attachment.fields">\n<bz-markup-renderer class=field-title content=field.title></bz-markup-renderer>\n<bz-markup-renderer class=field-value content=field.value></bz-markup-renderer>\n</div>\n</div>\n<div class=attachment-image ng-if=attachment.image.url>\n<img ng-src={{attachment.image.url}} ng-style="{height: (attachment.image.height) ? attachment.image.height + \'px\' : \'auto\'}"/>\n</div>\n</div>\n</div>\n</div>\n</div>\n</span>\n'},1752:function(e,n){angular.module("buzz").directive("bzPromptList",["bzService","bzMessage","bzMessageService","bzEvents","CurrentUserId","_",function(e,n,t,a,i,s){return{restrict:"E",replace:!0,scope:{prompts:"="},template:['<ul class="bz-prompt-list">','<li ng-click="onSelect(item)" class="bz-prompt-list-item dm-animate slide-in" ng-repeat="item in prompts track by $index">{{item}}</li>',"</ul>"].join(""),link:function(o,r){o.onSelect=function(o){e.getDroidChannel().then(function(e){var r=n.createMessage(o);r.id=s.uniqueId(),r.created=(new Date).getTime(),r.clientUID=s.uniqueId(r.created+"_"+i+"_"),a.addDroidMessage.trigger(r),t.sendMessage(e.channelId,r,!1)}),r.remove()}}}}])},1753:function(e,n){angular.module("buzz").factory("bzAttachmentAdapter",["$http","$q","$filter","bgBadge","fileAttachmentService","dmI18n",function(e,n,t,a,i,s){function o(e,n){if(e&&n){var t={YOUTUBE:{id:e,type:"YOUTUBE",url:"https://www.youtube.com/embed/"+e.replace(/(http(s)?:\/\/)?(\w+\.)?(youtube\.com\/watch\?v=|youtu\.be\/)/,"").substring(0,11),title:s.get("buzz/youtube-title"),thumbUrl:"/public/javascripts/buzz/youtube_placeholder.png"},VIMEO:{id:e,url:"https://player.vimeo.com/video/"+e.replace(/(http(s)?:\/\/)?(\w+\.)?(vimeo\.com)([\S\w])*(?=\/\d{3,15})\//i,"").substring(0,15),title:s.get("buzz/vimeo-title"),type:"VIMEO",thumbUrl:"/public/javascripts/buzz/vimeo_placeholder.png"}};return t[n]}}var r="•",c={},l={attachmentPromises:c,fromFileToAttachment:function(e){var n=t("dmFileSizeFilter")(e.size),a="File "+r+" ",s=i.sendFileToService(e,null,null,function(e,n,t){o.id=t,o.progress=e}),o={promise:s,progress:0,id:e.name+e.size,title:{text:e.name,tags:[{type:"FILE",start:0,length:e.name.length}]},description:{text:a+n,tags:[{id:null,key:"FILE_SIZE",length:n.length,start:a.length,type:"FILE"}]},type:"FILE"};if(/(image\/)(bmp|gif|jpg|jpeg|png|svg|tif|tiff|wmf)/.test(e.type)){o.image={};var c=new FileReader;c.onload=function(){var e=document.createElement("IMG");e.onload=function(){o.image.width=e.width,o.image.height=e.height,e=null},e.src=c.result},c.readAsDataURL(e)}return s.then(function(e){var n=e.data;return o.id=n.dataFileId,o.description.tags[0].id=n.dataFileId,o.progress=100,o.image&&(o.image.id=n.dataFileId,o.image.url="/api/data/v1/data-files/"+n.dataFileId),o}).finally(function(){return o.error=!0,o.promise=null,o}).catch(function(e){return console.error(e),e}),o},fromCardToAttachment:function(e){return a.getBadge(e).then(function(e){var n="Card";return e.metaData.description&&(n+=" "+r+" "+e.metaData.description),{id:e.id,title:{text:e.name,tags:[{id:e.id,type:"CARD",start:0,length:e.name.length}]},description:{text:n},type:"CARD"}})},fromUrlToAttachment:function(t,a){var i=t;t.search(/(http:\/\/|https:\/\/|ftp:\/\/)/)&&(t="http://"+t);var s={id:i,title:{text:"",tags:[]},description:{text:""},type:"URL_PREVIEW",url:t,generic:!1,promise:e.get("/api/social/v2/urls/info",{params:{urls:t}}).then(function(e){var n=_.first(e.data).urlPreviewPayload,t=_.first(_.compact(n.images)),i={title:{text:n.title,tags:[]},description:{text:n.url},url:n.url};return t&&(i.thumb={url:"/api/data/v1/data-files/"+t,id:t,type:"FILE"}),a&&(i.thumb=s.thumb),i.title.text.length||(i.removeMe=!0),angular.extend(s,i),s},function(){return s.removeMe=!0,s})};return a&&(s.embedded={id:a.type,type:"URL_PREVIEW",url:a.url},s.thumb={url:a.thumbUrl,type:"FILE"},s.title={text:a.title,tags:[]}),n.when(s)},fromUrlToEmbeddedAttachment:function(e){var t=n.defer(),a={id:e.url,title:{text:e.title,tags:[]},description:{text:e.id,tags:[{url:e.id,start:0,length:e.id.length,type:"MARKUP"}]},thumb:{url:e.thumbUrl,type:"FILE"},embedded:{id:e.type,type:"URL_PREVIEW",url:e.url},type:"URL_PREVIEW",promise:l.fromUrlToAttachment(e.id).then(function(n){return n.promise.then(function(){return n.id=e.url,n.thumb=a.thumb,angular.extend(a,n)},function(){return n.removeMe=!0,n}).finally(function(e){e.promise=null}).catch(function(e){console.error(e)})})};return t.resolve(a),t.promise},fromMentionToAttachment:function(e){switch(e.type){case"CARD":return l.fromCardToAttachment(e.value);case"URL":return e.embedded?l.fromUrlToAttachment(e.value,o(e.value,e.embedded)):l.fromUrlToAttachment(e.value);default:return n.reject("This attachment is not supported for this mention type: "+e.type)}}};return l}])},1754:function(e,n,t){var a=t(47);angular.module("buzz").directive("bzMessage",["bzRootPath","bzTagParser","dmAvatarPopoverService","bzStates","bzMessageService","bzStore","CurrentUserId","authorities","$location","$compile","bzEvents","dmI18n","dmGroupPopoverListService","projNewTaskModalService","Analytics","dmUserService","bzHelpers","jstz","bzHotkeyService","cdSaveModalService","docCardService",function(e,n,i,s,o,r,c,l,d,u,p,h,g,m,b,v,f,z,y,w,k){return{restrict:"E",scope:{message:"=",onQuote:"&",onThread:"&",onDelete:"&",showDate:"=",isLast:"=",focusMessage:"&?",createMessageCallbacks:"="},template:t(1755),link:function(e,n,t){function i(){var t=z.determine().name();e.message.showCreator||n.addClass("reply-by-same-creator"),e.message.showCreator&&n.addClass("show-creator"),c==e.message.createdBy.id&&n.addClass("is-current-user"),n.attr("message-id",e.message.id);var i=e.$watchCollection("message",function(){var t=e.message.id,a=/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i;a.test(t)&&(n.attr("message-id",e.message.id),i())});e.canCreateTask=A(e.message),e.canDelete=l.on("buzz.admin")||+e.message.createdBy.id===+c,e.canEdit=+e.message.createdBy.id===+c,e.tagClickHandler=M,e.addReaction=I,e.toggleReaction=$,e.toggleFavorited=T,e.toggleEditMode=O,e.getMessageClasses=s,e.getMarkupClasses=r,e.showTaskModal=d,e.retryFailedMessage=S,e.removeFailedMessage=P,e.replyToThread=C,e.editMessage=E,e.cdSaveModal=u,e.vm={},x(),e.dateFormat=e.showDate?h.get("date-formats/month-day-time"):"LT",e.explicitDate=a(e.message.created).tz(t).format(e.dateFormat),e.message&&e.message.viaId&&"USER"===e.message.viaType&&v.getUser(e.message.viaId).then(function(n){e.vm.i18n.viaText=h.get("buzz/via-text",{data:n.displayName})}),e.$on("$destroy",function(){_.each(U,function(e){e()})})}function s(n){var t=[];return n.showCreator&&t.push("show-creator"),n.messageType||n.failed||t.push("pending"),"SYSTEM"===n.messageType&&t.push("system-message"),"THIRD_PARTY"===n.messageType&&t.push("third-party"),e.showDate&&t.push("show-date"),e.message.failed&&t.push("failed"),t}function r(e){if("SYSTEM"===e.messageType)return"secondary bz-text-italics"}function d(){e.canCreateTask&&(b.track("buzz_task_create"),m.create({assignedUserIds:[c],defaultName:e.message.content.text||"",buzzChannelId:e.message.channelId,buzzMessageId:e.message.id}))}function u(){var n=e.message.attachments[0];_.isUndefined(n)||w.open({modalTitle:h.get("buzz/create-doc-card"),defaultCardTitle:n.attachmentTitle,description:n.description.text,hideNavigationCheckbox:!1,showDescription:!0,takeMeToCard:!0,skipValidation:!0,onSaveClick:g,fileList:e.message.attachments})}function g(e){var n={pageId:e.pageId,name:e.selectedFile.title.text,metadata:{title:e.cardTitle,id:e.selectedFile.id,version:void 0,description:e.selectedFile.description.text}};return"undefined"==e.pageId&&(n.pageId="-100000"),k.save(n).then(function(e){return b.track("buzz-create-doc-card"),e})}function C(e){b.track("buzz_create_topic_from_message"),p.createThread.trigger({message:e,conversion:!0})}function x(){e.vm.i18n={unfavorite:h.get("buzz/unfavorite"),favorite:h.get("buzz/favorite"),delete:h.get("buzz/delete"),edit:h.get("edit"),reply:h.get("buzz/create-huddle"),inReplyTo:h.get("buzz/in-reply-to",{user:""}),addTask:h.get("buzz/add-task"),tryAgain:h.get("buzz/try-again"),remove:h.get("buzz/remove"),failedToSend:h.get("buzz/failed-to-send"),quoteReply:h.get("buzz/quote-reply"),messageEdited:h.get("buzz/message-edited"),messageEditedTimestamp:h.get("buzz/message-edited-timestamp",{timestamp:a(e.message.modified).format("lll")}),createDocCard:h.get("buzz/create-doc-card")}}function T(n){n&&n.stopPropagation(),e.message.favorited=!e.message.favorited,e.message.favorited?(b.track("buzz_favorite_message"),o.favoriteMessage(e.message.id),p.favoriteMessage.trigger(e.message)):o.unfavoriteMessage(e.message.id)}function M(e){return f.tagClickHandler(e,n)}function I(n){b.track("buzz_hover_like"),o.toggleReaction(e.message,n,!0)}function $(n,t){b.track("buzz_hover_add_reaction"),angular.element('.tooltip[role="tooltip"]').remove(),o.toggleReaction(e.message,n)}function A(e){return void 0!=e&&void 0!=e.content&&void 0!=e.content.text&&e.content.text.length>0}function S(){p.retryFailedMessage.trigger(e.message)}function P(){angular.element('.tooltip[role="tooltip"]').remove(),p.removeFailedMessage.trigger(e.message)}function E(n,t,a,i,s,r){o.updateMessage(_.extend(e.message,n)),O()}function O(t){var a={id:"exitEditMessage",hotkey:"esc",alwaysOn:!1,handle:function(){n.find(".message-editor .content-editable").is(":focus")&&O(!1)}};_.isUndefined(t)&&(t=!e.editMode),e.editMode=t,e.editMode?(y.addHotkey(a),e.focusMessage&&(e.focusMessage({messageId:e.message.id,extra:120}),_.defer(function(){e.$digest()}))):(p.onMessageEditClose.trigger(),y.removeHotkey("exitEditMessage"))}var U=[];i()}}}])},1755:function(e,n){e.exports='<bz-last-viewed-message ng-if=message.showLastViewed class="date-breakup bz-last-viewed-message bz-text-label secondary" message=message></bz-last-viewed-message>\n<div class=message-emoji-anchor></div>\n<div class=message-container ng-class=getMessageClasses(message)>\n<div ng-if=message.showCreator class="message-avatar bz-avatar" dm-avatar-widget user=::message.createdBy size=large></div>\n<div class="bz-avatar message-avatar" ng-if="message.showCreator && message.createdBy.iconUrl">\n<bz-third-party-avatar icon-url=message.createdBy.iconUrl avatar-size=large>\n</bz-third-party-avatar>\n</div>\n<div class=message-header ng-if=message.showCreator>\n<span class="message-creator bz-text-overflow bz-text-body bold">{{::message.createdBy.displayName}}</span>\n<div class=message-meta>\n<i class="favorite-indicator icon-star __24" ng-click=toggleFavorited($event)></i>\n<span class="time bz-text-caption secondary">{{::explicitDate}}</span>\n</div>\n</div>\n<div ng-if="message.createdBy.type === \'SYSTEM\' && message.viaId" class="message-via-text bz-text-caption">{{vm.i18n.viaText}}</div>\n<i class="favorite-indicator icon-star __24 cursor-pointer" ng-if=!message.showCreator ng-click=toggleFavorited() db-tooltip={{::vm.i18n.unfavorite}}></i>\n<bz-quote message=message.quote orientation=portrait ng-if=message.quote></bz-quote>\n<bz-markup-renderer ng-hide=editMode class="position-relative content bz-text-body" ng-class=::getMarkupClasses(message) content=message.content modified="(message.modified - message.created) > 5000 && message.messageType !== \'SYSTEM\' ? message.modified : false" tag-click-handler=tagClickHandler>\n</bz-markup-renderer>\n<div class=message-editor ng-if=editMode>\n<bz-create-message ng-hide="noChannelAccess || threadOnlyButton" api=createMessageApi current-message=message on-giphy-search=createMessageCallbacks.onGiphySearch(giphyResults) on-create="editMessage(message, postThreadMentionData, isPublicThread, convertedMessage, users, groups)" on-attachment-added=createMessageCallbacks.attachmentAdded(attachment) on-attachment-removed=createMessageCallbacks.attachmentRemoved(attachment,attachments) on-mentioned="createMessageCallbacks.entityMentioned(mention, mentions)" on-unmentioned="createMessageCallbacks.entityUnmentioned(mention, mentions)" toggle-edit-mode=toggleEditMode(state) disable-thread=true></bz-create-message>\n</div>\n<div class="message-attachments position-relative" ng-class="{\'edit-mode\': editMode}" ng-if=message.attachments.length>\n<bz-attachment ng-attr-db-stopbubble=!message.searchResult class="message-attachment {{::attachment.type}}" attachment=attachment layout=expanded message-id=message.id ng-repeat="attachment in message.attachments track by $index">\n</bz-attachment>\n</div>\n<div class="message-reactions position-relative" ng-hide=editMode ng-if="message.reactions.length && (message.messageType !== \'SYSTEM\' || message.viaId)">\n<div db-stopbubble class=message-reaction ng-class="{\'by-current-user\': reaction.byCurrentUser}" ng-repeat="reaction in message.reactions track by reaction.reactionKey" ng-click=toggleReaction(reaction.reactionKey) db-tooltip={{reaction.tooltipText}} ng-hide=::reaction.hide>\n<i class="twa twa-lg twa-{{::reaction.reactionKey}}"></i> <span class="reaction-user-count link-style">{{reaction.propertyKeys.length}}</span>\n</div>\n</div>\n</div>\n<bz-prompt-list ng-if="isLast && message.droidPrompts && message.droidPrompts.length" prompts=message.droidPrompts></bz-prompt-list>\n<div class=message-failed-warning ng-if=message.failed>\n<i class=icon-exclamation-triangle></i>\n<span class="bz-text-italics message-failed-text">{{::vm.i18n.failedToSend}}</span>\n<i class=icon-sync ng-click=retryFailedMessage() db-tooltip={{::vm.i18n.tryAgain}}></i>\n<i class=icon-x ng-click=removeFailedMessage() db-tooltip={{::vm.i18n.remove}}></i>\n</div>\n';
},1756:function(e,n,t){angular.module("buzz").directive("bzMessageMenu",["bzMessageMenuPopover",function(e){return{restrict:"E",template:t(1757),link:function(n,t,a){n.openMenu=function(){e.open({messageScope:n.$parent,element:t.closest("bz-message").find(".message-emoji-anchor")})}}}}])},1757:function(e,n){e.exports='<bz-reaction-picker target-message=message on-select=addReaction(reaction)>\n</bz-reaction-picker>\n<db-button ng-if=allowQuoteReply theme=alt ng-click="onQuote({message: message})" db-tooltip={{::vm.i18n.quoteReply}}>\n<i class="icon-quote sm reply"></i>\n</db-button>\n<db-button theme=alt ng-click=openMenu()>\n<i class="icon-dots-horizontal sm"></i>\n</db-button>\n'},1758:function(e,n,t){var a=t(8),i=t(81);angular.module("buzz").factory("bzMessageMenuPopover",["$timeout","$compile","$q","authorities","CurrentUserId",function(e,n,t,s,o){function r(u){function p(){b.resolve(),g()}function h(){l&&(l.data.open=!1),e(function(){b.reject("CLOSED BY CALLER"),g()})}function g(){e(function(){l&&!l.$$destroyed&&l.$destroy()})}function m(){var e=[];return!(!s.on("content.card.edit")||o!=l.message.createdById)&&(l.message.attachments.length>0&&(e=l.message.attachments.filter(function(e){return"FILE"===e.type})),e.length>0)}if(u=u||{},!i.isUndefined(l))return l.$destroy(),void i.defer(function(){r(u)});var b=t.defer();l=u.messageScope.$new(),l.data={},l.data.open=!1,l.closeDropdown=h,l.allowDocCardConversion=m,l.onDropdownClosed=p;var v=a(d);return a(u.element).append(v),c=n(v)(l),e(function(){l.data.open=!0}),l.$on("$destroy",function(){c.remove(),c=void 0,l=void 0}),{close:h,result:b.promise}}var c,l,d=['<db-popover ng-show="data.open" placement="left-center" class="popover message-menu-popover" self-close on-close="onDropdownClosed()">','<div class="menu-list" ng-click="closeDropdown()">','<ul class="menu-list">','<li ng-click="toggleFavorited()">','<i class="icon-star sm" ng-class="{favorited: message.favorited}"></i>','<span ng-if="!message.favorited">{{::vm.i18n.favorite}}</span>','<span ng-if="message.favorited">{{::vm.i18n.unfavorite}}</span>',"</li>","<hr/>",'<li ng-if="::(message.channelType !== \'Huddle\' && !disableThreadCreate)" ng-click="replyToThread(message)">','<i class="icon-plus-bubble sm"></i>',"<span>{{::vm.i18n.reply}}</span>","</li>",'<li ng-show="::canCreateTask" ng-click="showTaskModal()">','<i class="icon-checkbox-checked sm"></i>',"<span>{{::vm.i18n.addTask}}</span>","</li>",'<li ng-show="allowDocCardConversion()" ng-click="cdSaveModal()">','<i class="icon-document sm"></i>',"<span>{{::vm.i18n.createDocCard}}</span>","</li>","<hr/>",'<li ng-show="::canEdit" ng-click="toggleEditMode()">','<i class="icon-pencil sm"></i>',"<span>{{::vm.i18n.edit}}</span>","</li>",'<li ng-if="::canDelete" ng-click="onDelete({messageId: message.id})">','<i class="icon-trash sm"></i>',"<span>{{::vm.i18n.delete}}</span>","</li>","</ul>","</div>","</db-popover>"].join("");return{open:r}}])},1759:function(e,n,t){angular.module("buzz").directive("bzQuote",["bzRootPath","features","CurrentUserId",function(e,n,a){return{restrict:"E",scope:{message:"="},template:t(1760),link:function(e,t,i){e.message.createdBy.id==a&&t.addClass("is-current-user"),e.userProfileLink=n.on("limited-exp")?"":"/up/"+e.message.createdById,e.model={}}}}])},1760:function(e,n){e.exports='<span class=quote-bubble><i class=icon-quote></i></span>\n<div ng-switch=!!model.showingFullQuote>\n<a class="user-name bz-text-body bold secondary" href="{{ ::userProfileLink }}">{{message.createdBy.displayName}}</a>\n<div class="bz-text-caption secondary italic">\n<span ng-switch-when=false>\n<bz-markup-renderer content=message.content max-length=100></bz-markup-renderer>\n<span ng-show="message.content.text.length > 100 || message.attachments.length"> <a class=show-more-less ng-click="model.showingFullQuote = true" dm-i18n=buzz/view-more></a></span>\n</span>\n<span ng-switch-when=true>\n<bz-markup-renderer content=message.content></bz-markup-renderer> <a class=show-more-less ng-click="model.showingFullQuote = false" dm-i18n=buzz/view-less></a>\n<bz-attachment class=quote-attachment attachment=attachment layout=expanded ng-repeat="attachment in message.attachments"></bz-attachment>\n</span>\n</div>\n</div>\n'},1761:function(e,n){angular.module("buzz").directive("bzLastViewedMessage",["bzMessageService","bzEvents",function(e,n){return{restrict:"E",scope:{message:"="},template:'<div dm-i18n="buzz/new-messages"></div>',link:function(e,t){function a(){var e=t[0].getBoundingClientRect(),a=i[0].getBoundingClientRect(),s=e.top>a.top&&e.top<a.bottom,o=e.top>a.bottom;s||o?s&&n.toggleNewMessagesBanner.trigger(!1):n.toggleNewMessagesBanner.trigger(!0)}var i=t.parents(".pane-body"),s=_.throttle(a,75);i.on("scroll",s),setTimeout(function(){a()},250),e.$on("$destroy",function(){i.off("scroll",s)})}}}])},1762:function(e,n){angular.module("buzz").directive("bzDateBreakup",["bzStates",function(e){return{restrict:"E",scope:{date:"@"},template:'<div class="bz-text-label secondary" dm-moment="{{ date }}" format="LL"></div>',link:function(e,n,t){n.addClass("date-breakup")}}}])},1763:function(e,n,t){var a=t(47);angular.module("buzz").directive("bzMessagesBody",["bzRootPath","$compile","bzStore",function(e,n,i){return{restrict:"E",template:t(1764),transclude:!0,scope:{channel:"=",messages:"=",quoteMessage:"&",lastViewed:"=",createMessageCallbacks:"=?",onDelete:"&",editMessageApi:"=",disableThreadCreate:"=?",focusMessage:"&?"},link:function(e,t){function s(){u=t.find("bz-message-menu"),e.getMessageClasses=o,e.currentlyTyping={},e.checkShowDate=d,e.vm.i18n={channelCreatedOn:a(i.currentChannel.created).format("LL")},r(),l()}function o(e,n,t,a){var i=[],s=t[n+1];return s&&(e.createdBy&&e.createdBy.id)==s.createdBy.id&&!s.showCreator&&"Huddle"!==s.type||i.push("is-last-of-message-group"),a&&e.id===a&&i.push("active-message"),e.favorited&&i.push("show-favorite"),e.showDateBreak&&i.push("has-date-break"),i}function r(){t.on("mouseenter",".message-container:not(.huddle)",h)}function c(t){if(!p){var a=t.currentTarget,i=angular.element(a),s=i.scope().$new();if(s){s.disableThreadCreate=e.disableThreadCreate;var o=s.message||s.$parent.$ctrl.message;if(!o.failed&&!o.richType)if(a!==u.container){if("SYSTEM"===o.messageType&&!o.viaId)return;u.remove(),s.message.channelType=e.channel.type,s.allowQuoteReply=!e.channel.isObjectChannel(),u=n('<bz-message-menu db-stopbubble ng-hide="editMode" />')(s),u.container=a,i.prepend(u),_.defer(function(){s.$digest()})}else"SYSTEM"!==o.messageType||o.viaId||(u.remove(),u.container=null)}}}function l(){e.$on("$destroy",function(){p=!0,t.off("mouseenter",".message-container:not(.huddle)",h)})}function d(e){return a(e).startOf("day").valueOf()<a().startOf("day").valueOf()}var u,p=!1,h=_.debounce(c,250);e.vm={},s()}}}])},1764:function(e,n){e.exports='<ng-transclude></ng-transclude>\n<div class=message-wrapper ng-repeat="message in messages" ng-switch=message.type>\n<bz-date-breakup ng-if=message.showDateBreak date="{{ message.created }}"></bz-date-breakup>\n<bz-message class=block ng-switch-when=Message ng-if=!message.richType is-last=$last message=message on-quote="quoteMessage({message: message})" on-delete="onDelete({messageId: messageId})" focus-message="focusMessage({messageId: messageId, extra: extra})" create-message-callbacks=createMessageCallbacks ng-class=getMessageClasses(message,$index,messages,channel.activeMessage) show-date=::checkShowDate(message.created)></bz-message>\n<bz-huddle-message ng-switch-when=Huddle ng-class=getMessageClasses(message,$index,messages,channel.activeMessage) message=message show-date=::checkShowDate(message.created)></bz-huddle-message>\n<bz-ram-message ng-switch-when=Message ng-if=message.richType message=message>\n</bz-ram-message>\n</div>'},1765:function(e,n,t){var a=t(47);angular.module("buzz").directive("bzMessagesHeader",["bzRootPath","bzStates","bzEvents","bzService","CurrentUserId","Auth","bzStore","$q","bzHelpers","dmI18n","Analytics","dmRouting","bzModals","$filter",function(e,n,i,s,o,r,c,l,d,u,p,h,g,m){var b=["PAGE","PROJECT","CARD","APPROVAL"];return{replace:!0,restrict:"E",scope:{showThreadView:"="},template:t(1766),link:function(e,t,v){function f(){e.channelTitleClickHandler=E,e.openSidePane=B,e.isValidObjectType=_.debounce(P,50),e.getObjectChatIconClass=T,e.getHuddleObjectChatIconClass=M,e.setCurrentChannel=c.setCurrentChannel,e.getChannelType=A,e.viewAllUsersModal=S,e.toggleFavoriteChannel=I,e.showBadgeModal=L,e.loadParentChannel=N,e.toggleThreadView=C,e.showBackLink=j,e.openMenu=$,e.vm={},e.channel=c.currentChannel,e.showThreadView=!1,e.missedMessageCount=0,e.header={},e.currentUserId=o,e.backToParentText="",e.lastViewed=void 0,e.channel=c.currentChannel,e.unreadIndicatorCount=0,e.avatarGroupOptions={user:{noclick:!0,noTooltip:!0},group:{noclick:!0,noTooltip:!0}},x(),w(),_.has(e.channel,"title")&&(F(),y()),G.push(i.channelChange.on(U)),G.push(i.currentChannelUpdated.on(H)),G.push(i.updatePeopleCount.on(R)),G.push(i.missedImportant.on(z)),G.push(i.stateChange.on(w)),c.currentChannel.id&&U(),e.$on("$destroy",function(){_.each(G,function(e){return e()})})}function z(n){_.isUndefined(n.totalCount)||(e.missedMessageCount=n.totalCount)}function y(){var n=e.channel.inheritPermissions?d.getChannelUsersType(e.channel.parentChannel):d.getChannelUsersType(e.channel);n.then(function(n){e.channelUsersType=n})}function w(){e.panes=n.panes,e.state=n.states,1===e.panes&&e.state.indexOf("messages")?e.singleMessagePane=!0:e.singleMessagePane=!1,k()}function k(){n.panes>2?n.panesOverride?e.vm.i18n.detailsTooltip=u.get("buzz/view-details"):e.vm.i18n.detailsTooltip=u.get("buzz/hide-details"):n.states.indexOf(!1)&&(e.vm.i18n.detailsTooltip=u.get("buzz/view-details"))}function C(){e.showThreadView=!e.showThreadView}function x(){e.vm.i18n={accessGranted:u.get("buzz/access-granted"),active:u.get("buzz/active"),conversationMuted:u.get("buzz/conversation-muted"),directConversationStarted:u.get("buzz/direct-conversation-started",{user:e.channel.type}),conversationStarted:u.get("buzz/conversation-started"),include:u.get("buzz/include"),favoriteConversation:u.get("buzz/favorite-conversation"),unfavoriteConversation:u.get("buzz/unfavorite-conversation"),pinConversation:u.get("buzz/pin-conversation"),unPinConversation:u.get("buzz/unpin-conversation"),viewThreads:u.get("buzz/view-threads"),hideThreads:u.get("buzz/hide-huddles"),project:u.get("buzz/project"),page:u.get("buzz/page"),menu:u.get("buzz/menu"),closeThread:u.get("buzz/close-thread")},("ObjectChat"===e.channel.type||"Huddle"===e.channel.type&&"OBJECT_CHAT"===e.channel.parentChannelType)&&(e.vm.i18n.channelType=D("Huddle"===e.channel.type?e.channel.parentObjectType:e.channel.objectType))}function T(){var n;if("ObjectChat"==e.channel.parentChannel.type){switch(n="icon-",c.currentChannel.objectType){case"PAGE":n+="pages-bars";break;case"CARD":n+="chart-bar-vertical";break;case"PROJECT":n+="project";break;default:n=""}return n}}function M(){var n;if(e.channel.parentChannel&&("Huddle"!=e.channel.type||"ObjectChat"==e.channel.parentChannel.type)){switch(n="icon-",e.channel.parentChannel.objectType){case"PAGE":n+="pages-bars";break;case"CARD":n+="chart-bar-vertical";break;case"PROJECT":n+="project";break;default:n=""}return n}}function I(){e.channel.favoritePosition>=0?p.track("buzz_unfavorite_conversation"):p.track("buzz_favorite_conversation"),e.channel.toggleFavorite()}function $(){n.menu()}function A(){var n=e.channel.parentChannel.objectType;return n=(n||"PRIVATE").toLowerCase(),u.get("buzz/channel-type-"+n)}function S(){p.track("buzz_view_people_with_access"),g.open("viewAllUsers")}function P(){var n=e.channel.parentChannel,t=n&&"ObjectChat"==n.type&&_.contains(b,n.objectType);return t?"pointer":""}function E(){if(P()){var n=e.channel.parentChannel,t=n.objectType,a=n.objectId,i=O(t,a),s=h.url();"CARD"==t&&p.track("buzz_view_card"),"PAGE"==t&&p.track("buzz_view_page"),"CARD"==t&&r.SOCIAL_USER&&p.track("social_card_click_in_buzz",{channel_id:n.id,channel_type:n.type}),i!==s?h.url(i):h.reload()}}function O(e,n){var t;switch(n=n||"",e){case"PAGE":t="/page/";break;case"CARD":t="/kpis/details/";break;case"PROJECT":t="/project/";break;case"APPROVAL":t="/approval/approval-details/approval/"}return t+n}function U(){function n(){return e.channel.parentChannel.isObjectChannel()?(e.channelObjectPromise=s.getChannelObject(e.channel.parentChannel),e.channelObjectPromise.then(function(n){e.vm.channelObject=n,e.channelObjectPromise=void 0}),e.channelObjectPromise):(e.vm.channelObject=void 0,l.resolve())}e.channel.id!==c.currentChannel.id&&(e.showThreadView=!1,e.showMessagesBanner=!1,e.preventBannerShowing=!1,e.channel=c.currentChannel,e.vm.i18n.subTitle=_.unescape(d.getSubTitle(e.channel)),e.vm.i18n.usersWithAccess=void 0,("ObjectChat"===e.channel.type||"Huddle"===e.channel.type&&"OBJECT_CHAT"===e.channel.parentChannelType)&&(e.vm.i18n.channelType=D("Huddle"===e.channel.type?e.channel.parentObjectType:e.channel.objectType)),e.noChannelAccess=!1,y(),"DirectChat"===e.channel.type?V=_.find(e.channel.accesses,{id:e.channel.formattedThemId}):"Topic"===e.channel.type&&(e.channel.createdBy=_.find(e.channel.accesses,{id:e.channel.createdById})),F(),n().then(function(){var n=e.channel,t=n.parentChannel;e.vm.channelIsTransitivelyPublic=n.isPublicSomehow()||t&&t.isObjectChannel()&&"PROJECT"==t.objectType&&e.vm.channelObject&&0==e.vm.channelObject.hidden}))}function D(e){switch(e){case"CARD":return u.get("buzz/card").toLowerCase();case"PAGE":return u.get("buzz/page").toLowerCase();case"PROJECT":return u.get("buzz/project").toLowerCase()}}function R(n){e.vm.i18n.usersWithAccess=u.get("buzz/num-people",{count:m("number")(n)})}function j(){return e.channel.isThread&&e.channel.isThread()&&n.drilledFromParent}function L(e){e&&e.urn&&(p.track("buzz_view_card"),i.cardMentionClicked.trigger({cardId:e.urn}))}function N(n){"Card"===e.channel.ObjectType?e.showBadgeModal({urn:n}):e.channelTitleClickHandler()}function F(){e.channel.created&&(e.header.date=a(e.channel.created).format("LL")),"DirectChat"!==e.channel.type&&"Topic"!==e.channel.type?(e.header.text=u.get("buzz/conversation-started-in-channel",{channel:e.channel.title,date:e.header.date}),e.header.title=e.vm.i18n.conversationStarted):"DirectChat"===e.channel.type?(V=_.find(e.channel.accesses,{id:e.channel.formattedThemId}),e.header.title=u.get("buzz/conversation-started-direct-chat",{name:V.DISPLAY}),e.header.text=u.get("buzz/conversation-started-in-direct-chat",{name:V.DISPLAY,date:e.header.date})):"Topic"===e.channel.type&&e.channel.createdBy?"NONE"!==e.channel.publicPermission?(e.header.title=u.get("buzz/conversation-started-huddle-chat",{name:e.channel.title}),e.header.text=u.get("buzz/conversation-started-in-topic-channel",{channel:e.channel.title,creator:e.channel.createdBy.DISPLAY,date:e.header.date})):(e.header.title=u.get("buzz/conversation-started-private-channel",{name:e.channel.title}),e.header.text=u.get("buzz/conversation-started-in-channel",{channel:e.channel.title,date:e.header.date})):"Topic"!==e.channel.type||e.channel.createdBy||(e.header.text=u.get("buzz/conversation-started-in-channel",{channel:e.channel.title,date:e.header.date}),e.header.title=e.vm.i18n.conversationStarted),("27"===e.channel.themId||e.channel.title&&"domosupport"===e.channel.title.replace(/ /g,"").toLowerCase())&&(e.header.title=u.get("buzz/create-support-ticket-title"),e.header.text=u.get("buzz/create-support-ticket")),e.header.text=_.unescape(e.header.text),e.header.title=_.unescape(e.header.title),e.backToParentText=u.get("buzz/back"),e.vm.i18n.subTitle=_.unescape(d.getSubTitle(e.channel))}function H(){e.channel=c.currentChannel}function B(){n.panes>2?(n.panesOverride?(p.track("buzz_details_load"),n.panesOverride=null,n.setState(2,"side-pane")):n.panesOverride=2,i.sizeChange.trigger()):_.contains(n.states,"side-pane")||_.contains(n.states,"channel-attachments")||_.contains(n.states,"threads")?n.messages():(p.track("buzz_details_load"),n.sidePane()),k()}var G=[],V="";f()}}}])},1766:function(e,n){e.exports='<div class="pane-header bz-messages-header" ng-class="{\'huddle-view\': channel.type === \'Huddle\'}">\n<bz-main-header ng-class="{\'show-thread-view\': showThreadView}">\n<span class=breadcrumb-link db-stopbubble ng-click=openMenu() db-tooltip={{::vm.i18n.menu}} db-tooltip-close-on-click=true><span class="header-important-badge red dm-animate" ng-if=missedMessageCount>{{ missedMessageCount | number }}</span><a><i class=icon-arrow-left></i></a></span>\n<div class=title-time ng-class=isValidObjectType() ng-click=channelTitleClickHandler()>\n<bz-conversation-icon ng-if="channel.parentChannel.objectType === \'CARD\' || channel.parentChannel.type !== \'ObjectChat\'" bz-channel=channel.parentChannel use-dynamic-icon="{value: true}"></bz-conversation-icon>\n<div class="channel-title bz-text-display-3">\n<div class=channel-title-text>\n<span class=channel-title-overflow ng-show="channel.type !== \'Huddle\'">{{channel.displayTitle}}</span>\n<span class=channel-title-overflow ng-show="channel.type === \'Huddle\'">{{channel.parentChannel.title}}</span>\n<db-buttons class="messages-header-buttons channel-buttons">\n<db-button theme=alt db-stopbubble class="button-container channel-threads-button" ng-click=toggleThreadView() db-tooltip="{{ showThreadView ? vm.i18n.hideThreads : vm.i18n.viewThreads}}" db-tooltip-placement=bottom db-tooltip-close-on-click=true ng-class="{active: showThreadView}">\n<i class="icon-chat-bubble-lines _24"></i>\n<span class="unread-in-huddles mentioned-in-huddles" ng-show=channel.parentChannel.importantCounts.huddleMessages>{{channel.parentChannel.importantCounts.huddleMessages}}</span>\n</db-button>\n<db-button ng-show="channel.type !== \'Huddle\'" theme=alt db-stopbubble ng-if="channel.type !== \'Huddle\'" class="button-container favorite-button" db-tooltip="{{channel.favoritePosition >= 0 ? vm.i18n.unfavoriteConversation :vm.i18n.favoriteConversation}}" db-tooltip-placement=bottom ng-click=toggleFavoriteChannel()>\n<i ng-show="channel.favoritePosition < 0" class="icon-star-outline _24 pinned-button"></i>\n<i ng-show="channel.favoritePosition >= 0" class="icon-star _24 pinned-button"></i>\n</db-button>\n<db-button ng-show="channel.type !== \'Huddle\'" theme=alt class="button-container view-details-button" db-tooltip={{vm.i18n.detailsTooltip}} db-tooltip-placement=bottom db-tooltip-close-on-click=true ng-click=openSidePane() db-stopbubble>\n<i class="icon-dots-horizontal margin-left-xsmall"></i>\n</db-button>\n</db-buttons>\n</div>\n<div class="activity bz-user-count" ng-if="channel.type !== \'Huddle\' || showThreadView">\n<div class="activity-label bz-text-caption secondary">\n<span class="capitalize inner-title">\n{{vm.i18n.subTitle}}\n</span>\n<span class=channel-title-link ng-if="channelUsersType === \'Access\' || (channelUsersType === \'Pin\' && channel.publicPermission === \'NONE\') || channel.parentChannel.objectType === \'PROJECT\' || (channel.type === \'Huddle\' && channel.parentChannelType === \'TOPIC\')">\n<span class="dot-separator separator"> &#8226; </span>\n<a ng-click=viewAllUsersModal() db-stopbubble class=user-count ng-if=vm.i18n.usersWithAccess>{{vm.i18n.usersWithAccess}}</a>\n<span class=vertical-align-bottom ng-show="channel.parentChannel.type == \'ObjectChat\'">\n<span class="dot-separator separator"> &#8226; </span>\n<a ng-if="channel.parentChannel.objectType == \'CARD\'" ng-click="showBadgeModal({urn: channel.parentChannel.objectId})" db-stopbubble>\n<span dm-i18n=buzz/view-card></span>\n</a>\n<a ng-if="channel.parentChannel.objectType != \'CARD\'" ng-click=channelTitleClickHandler() db-stopbubble>\n<span class="" dm-i18n=buzz/view-object data="{type: vm.i18n.channelType}"></span>\n</a>\n</span>\n</span>\n</div>\n<div class="activity-label bz-text-caption secondary">\n<span dm-i18n=buzz/all-threads></span>\n</div>\n</div>\n</div>\n</div>\n</bz-main-header>\n<div class=bz-subheader ng-if="channel.type === \'Huddle\' && !showThreadView">\n<bz-main-header ng-class="{\'show-thread-view\': showThreadView}">\n<span class=close-thread-link db-stopbubble ng-click=setCurrentChannel(channel.channelId) db-tooltip={{::vm.i18n.closeThread}}><a><i class=icon-x></i></a></span>\n<div class=title-time>\n<div class="dynamic-object-icon bz-text-caption secondary">\n<i ng-show=channel.inheritPermissions class=icon-chat-bubble-lines></i>\n<i ng-show=!channel.inheritPermissions class=icon-chat-bubble-lock></i>\n</div>\n<div class="channel-title huddle-channel-title bz-text-display-3">\n<div class="channel-title-container huddle-channel-title-container">\n<div class=channel-title-text>\n<span class=channel-title-overflow>{{channel.displayTitle}}</span>\n<db-buttons class="messages-header-buttons sub-header">\n<db-button theme=alt class="button-container view-details-button" db-tooltip={{vm.i18n.detailsTooltip}} db-tooltip-placement=bottom db-tooltip-close-on-click=true ng-click=openSidePane() db-stopbubble>\n<i class="icon-dots-horizontal margin-left-xsmall"></i>\n</db-button>\n</db-buttons>\n</div>\n<div class="activity bz-user-count">\n<div class="activity-label bz-text-caption secondary">\n<span class="capitalize inner-title">\n{{vm.i18n.subTitle}}\n</span>\n<span class=channel-title-link ng-if="channelUsersType === \'Access\' || (channelUsersType === \'Pin\' && channel.publicPermission === \'NONE\') || channel.parentChannel.objectType === \'PROJECT\' || (channel.type === \'Huddle\' && channel.parentChannelType === \'TOPIC\')">\n<span class="dot-separator separator"> &#8226; </span>\n<a ng-click=viewAllUsersModal() db-stopbubble class=user-count ng-if=vm.i18n.usersWithAccess>{{vm.i18n.usersWithAccess}}</a>\n<span class=vertical-align-bottom ng-show="channel.parentChannel.type == \'ObjectChat\'">\n<span class="dot-separator separator"> &#8226; </span>\n<a ng-if="channel.parentChannel.objectType == \'CARD\'" ng-click="showBadgeModal({urn: channel.parentChannel.objectId})" db-stopbubble>\n<span dm-i18n=buzz/view-card></span>\n</a>\n<a ng-if="channel.parentChannel.objectType != \'CARD\'" ng-click=channelTitleClickHandler() db-stopbubble>\n<span class="" dm-i18n=buzz/view-object data="{type: vm.i18n.channelType}"></span>\n</a>\n</span>\n</span>\n</div>\n<div class="activity-label bz-text-caption secondary">\n<span dm-i18n=buzz/all-threads></span>\n</div>\n</div>\n</div>\n</div>\n</div>\n</bz-main-header>\n</div>\n<bz-download-buzz-header></bz-download-buzz-header>\n</div>'},1767:function(e,n,t){angular.module("buzz").directive("bzReactionPicker",["bzRootPath","Analytics","dmI18n",function(e,n,a){return{restrict:"E",scope:{onSelect:"&",targetMessage:"="},template:t(1768),link:function(e,t){function i(){e.messageSelector='bz-message[message-id^="'+e.targetMessage.id+'"] .message-emoji-anchor',e.selectReaction=o,e.vm={},s()}function s(){e.vm.i18n={like:a.get("buzz/like"),addReaction:a.get("buzz/add-reaction")}}function o(t){n.track("buzz_reactions_used_by_type",{reaction_type:t}),"function"==typeof e.onSelect&&e.onSelect({reaction:t.replace(/:/g,"")})}i()}}}])},1768:function(e,n){e.exports='<span class=reaction-buttons>\n<db-button theme=alt ng-click="selectReaction(\'thumbsup\')" db-tooltip={{::vm.i18n.like}}>\n<i class="icon-thumbs-up sm reaction-like-button"></i>\n</db-button>\n<bz-emoji-picker-button-v2 class=reaction-emoji-picker on-emoji-selected=selectReaction(emoji) reaction-icon db-tooltip="{{ :: vm.i18n.addReaction}}" anchor-selector=messageSelector></bz-emoji-picker-button-v2>\n</span>\n'},1769:function(e,n,t){angular.module("buzz").directive("bzAutoGrantAccess",["bzRootPath","bzService","$q","dmI18n","bzStore","CurrentUser","CurrentUserId","bzEvents","Auth","bzSafeData",function(e,n,a,i,s,o,r,c,l,d){function u(){}function p(e,t,i){function r(){u(),_.has(i,"providedChannel")?(e.channel=e.providedChannel,e.$watch("providedChannel.id",function(){e.channel=e.providedChannel})):(e.channel=s.currentChannel,C.push(c.channelChange.on(m))),e.popoverLimit=10,e.safeData=d,e.$watch("mentions.length",b),h(),e.$watch("shareObjects",function(e,n){e!=n&&b()}),e.$on("$destroy",function(){_.each(C,function(e){return e()}),g(),e.api=void 0})}function u(){e.api=e.api||{},_.extend(e.api,{getItems:p})}function p(){return a.when(e.itemsNeedingAccess)}function h(){t.on("mouseenter",".access-item",function(n){e.itemHovered=!0,k(n,this)}),t.on("mouseleave",".access-item",y)}function g(){var n=void 0;e.channel=n,e.mentioned=n,e.itemsNeedingAccess=n}function m(){e.channel=s.currentChannel}function b(n,t){void 0!=n&&e.mentions&&e.mentions.length&&w()}function v(){if(e.mentions&&e.mentions.length&&e.channel){var t="true"==e.shareObjects;n.processMentions(e.mentions,e.channel.id,t).then(function(n){if(e.channel){var t=[e.channel.id,e.channel.parentChannel.id];e.itemsNeedingAccess=_.filter(n.grantPreviews,function(e){return"BUZZ_CHANNEL"!==e.resource.type||t.indexOf(e.resource.id)>=0}),e.properties=n.properties,x&&f()}})}}function f(){function n(e){return e.data.title?e.data.title.text:e.data.displayName?e.data.displayName:void 0}_.chain(e.mentions).filter(function(e){return["CARD","PAGE"].indexOf(e.data.type)>=0}).map(function(e){return{users:[],groups:[],resource:{id:""+e.data.value,type:e.data.type,displayName:n(e)}}}).each(function(n){e.itemsNeedingAccess||(e.itemsNeedingAccess=[]),e.itemsNeedingAccess.push(n),e.properties||(e.properties={}),e.properties[n.resource.type+":"+n.resource.id]={DISPLAY:n.resource.displayName}})}function z(n,t){if(0!=e.itemHovered){var a=angular.element(t),i=a.scope();if(i.$ctrl.item!=e.currentItem){var s=void 0;a.hasClass("user")?s="user":a.hasClass("group")&&(s="group"),_.isUndefined(s)||(e.popoverData={currentItem:i.$ctrl.item,itemClass:s},e.$digest())}}}function y(n){e.itemHovered=!1,e.popoverData=void 0,e.$digest()}var w=_.throttle(v,100),k=_.throttle(z,700),C=[],x=l.SOCIAL_USER||"Participant"==o.userRole;r()}t(140);return{restrict:"E",replace:!0,template:t(1770),scope:{api:"=?",mentions:"=",providedChannel:"=?",onAccessExists:"&",shareObjects:"@?"},compile:function(e,n,t){return{pre:u,post:p}}}}])},1770:function(e,n){e.exports='<div>\n<div class=bz-grant-access-to-card ng-if="itemsNeedingAccess.length > 0">\n<span class="margin-vertical-xxsmall display-block font-weight-semi-bold" dm-i18n=buzz/granting-access></span>\n<span class="bz-text-caption secondary">\n<bz-auto-grant-item ng-repeat="item in itemsNeedingAccess" item=item channel=channel properties=properties></bz-auto-grant-item>\n</span>\n<db-popover class="popover bz-auto-grant-access-item-desc" ng-show="popoverData != undefined" placement=top-left>\n<div ng-if="popoverData.itemClass == \'user\'">\n<div class="uppercase-text bz-text-body bold" dm-i18n=people></div>\n<div ng-repeat="uid in popoverData.currentItem.users | limitTo:popoverLimit" class=margin-vertical-xsmall>\n<div dm-avatar-widget={{uid}} show-user-name=true size=nano></div>\n</div>\n<div ng-if="popoverData.currentItem.users.length > popoverLimit">\n<dm-i18n key=buzz/and-x-more data="{count: (popoverData.currentItem.users.length - popoverLimit)}" safe-data=safeData></dm-i18n>\n</div>\n</div>\n<div ng-if="popoverData.itemClass == \'group\'">\n<div class="uppercase-text bz-text-body bold" dm-i18n=groups></div>\n<div ng-repeat="gid in popoverData.currentItem.groups | limitTo:popoverLimit" class=margin-vertical-xsmall>\n<div dm-avatar-group-widget=gid show-group-name=true show-member-count=true size=nano></div>\n</div>\n<div ng-if="popoverData.currentItem.groups.length > popoverLimit">\n<dm-i18n key=buzz/and-x-more data="{count: (popoverData.currentItem.groups.length - popoverLimit)}" safe-data=safeData></dm-i18n>\n</div>\n</div>\n</db-popover>\n</div>\n</div>\n'},1771:function(e,n,t){angular.module("buzz").component("bzAutoGrantItem",{template:t(1772),bindings:{item:"<",channel:"<",properties:"<"},controller:["dmI18n","bzStore","bzSafeData","Auth","CurrentUser",function(e,n,t,a,i){function s(){}function o(e){e.item&&r()}function r(){switch(m.i18n=m.i18n||{},m.item.resource.type){case"CARD":m.i18n.text=c();break;case"PAGE":m.i18n.text=l();break;case"PROJECT":m.i18n.text=d();break;case"BUZZ_CHANNEL":m.i18n.text=u()}}function c(){var e=p();return e.objectName=h(),b?g("buzz/auto-grant-user-group-card-social","buzz/auto-grant-user-group-card-social","buzz/auto-grant-user-group-card-social",e):g("buzz/auto-grant-user-group-card","buzz/auto-grant-user-card","buzz/auto-grant-group-card",e)}function l(){var e=p();return e.objectName=h(),b?g("buzz/auto-grant-user-group-page-social","buzz/auto-grant-user-group-page-social","buzz/auto-grant-user-group-page-social",e):g("buzz/auto-grant-user-group-page","buzz/auto-grant-user-page","buzz/auto-grant-group-page",e)}function d(){var n=p();return n.objectName=h(),b?e.get("buzz/auto-grant-user-project-social",n,t):e.get("buzz/auto-grant-user-project",n,t)}function u(){var n=p();if(m.channel.isThread())return m.item.resource.id==m.channel.id?g("buzz/auto-grant-user-group-thread","buzz/auto-grant-user-thread","buzz/auto-grant-group-thread",n):(n.objectName=m.channel.parentChannel.title,g("buzz/auto-grant-user-group-parent","buzz/auto-grant-user-parent","buzz/auto-grant-group-parent",n));if(m.channel.isObjectChannel()){var t={CARD:"buzz/card",PAGE:"buzz/page",PROJECT:"buzz/project"};return n.type=e.get(t[m.channel.parentChannel.objectType]),g("buzz/auto-grant-user-group-channel-type","buzz/auto-grant-user-channel-type","buzz/auto-grant-group-channel-type",n)}return g("buzz/auto-grant-user-group-channel","buzz/auto-grant-user-channel","buzz/auto-grant-group-channel",n)}function p(){var e=m.item;return{users:e.users.length,groups:e.groups.length}}function h(){var e=m.item,n=e.resource,t=m.properties,a=n.type+":"+n.id;return t[a].DISPLAY}function g(n,a,i,s){var o=void 0,r=m.item;return o=r.users&&r.users.length&&r.groups&&r.groups.length?e.get(n,s,t):r.users&&r.users.length?e.get(a,s,t):e.get(i,s,t)}var m=this,b=a.SOCIAL_USER||"Participant"==i.userRole;this.$onChanges=o,this.$onInit=s}]})},1772:function(e,n){e.exports="<div ng-bind-html=$ctrl.i18n.text></div>"},1773:function(e,n,t){angular.module("buzz").directive("bzSupportTicketModal",["Analytics","bzRootPath","bzAttachmentAdapter","bzModals","dmI18n","$timeout","dmBootstrap","dmWikiService","bzMessage","bzService","$q",function(e,n,a,i,s,o,r,c,l,d,u){return{restrict:"E",template:t(1774),scope:{message:"=?",onSubmit:"&"},link:function(n,t,o){function p(){switch(n.submitTicket=m,n.cancel=g,n.updateMessageTitle=b,n.updateMessageBody=v,n.onCategorySelect=f,n.focusTitleInput=z,n.addAttachment=w,n.removeAttachment=k,n.disabled=h,n.updateReviewedHelplinks=x,n.updateHelpLinks=_.debounce(T,500),n.vm={},n.editTitle=!1,n.messageTitle="",n.messageBody="",n.messageAttachments=[],n.messageCategories=E,n.tags=[],n.links=[],n.reviewedHelpLinks=[],n.vm.i18n={supportTicketHeadingPlaceholder:s.get("buzz/support-ticket-heading-placeholder"),supportTicketPlaceholder:s.get("buzz/support-ticket-placeholder"),addAttachment:s.get("buzz/add-attachment"),remove:s.get("buzz/remove"),selectCategory:s.get("buzz/select-category")},n.message&&(n.messageTitle=n.message.content.text.replace(/\/support\s*/,""),n.editTitle=!n.messageTitle.length,n.messageAttachments=n.message.attachments||[]),T(),_.delay(function(){n.messageTitle?y():z()},200),n.helpCenterURL=c.getUrlForCurrentLocale("toolsMenu"),r.data.customerTier){case"free":case"trial":n.communityURL="https://dojo.domo.com/";break;default:n.communityURL="/auth/community"}}function h(){return!(n.messageCategory&&(n.messageBody&&n.messageBody.length||n.messageTitle&&n.messageTitle.length))}function g(){i.close("createSupportTicket")}function m(){n.messageCategory||(n.messageCategory={label:s.get("support-categories/other")});var t=C(),a=l.createMessage(t,n.tags,n.messageAttachments);n.onSubmit&&n.onSubmit({message:a}),i.close("createSupportTicket"),e.track("buzz_create_support_ticket",{channel_id:a.channelId})}function b(e){n.messageTitle=e,S=!1,n.updateHelpLinks()}function v(e){n.messageBody=e,
S&&n.updateHelpLinks()}function f(e){n.messageCategory=e}function z(){I||(I=t.find(".bz-support-ticket-title")),_.defer(function(){I.focus()})}function y(){A||(A=t.find(".bz-support-ticket-description")),_.defer(function(){A.focus()})}function w(e){$||($=angular.element("#bzSupportAttachment[type=file]")),_.each(e,function(e){var t=a.fromFileToAttachment(e);t.id&&_.findWhere(n.messageAttachments,{id:t.id,type:t.type})||n.messageAttachments.unshift(t)}),$.val(null)}function k(e){n.messageAttachments.splice(n.messageAttachments.indexOf(e),1)}function C(){var e="/support \n\n- Subject: "+n.messageTitle+"\n- Description: "+n.messageBody+"\n- Category: ";if(n.messageCategory.category&&(e+=n.messageCategory.category+" > "),e+=n.messageCategory.label,n.reviewedHelpLinks&&n.reviewedHelpLinks.length&&(e+="\n- Support links reviewed:",_.each(n.reviewedHelpLinks,function(t){var a=e.length+3;e+="\n• "+t.uri,n.tags.push({value:t.uri,length:t.uri.length,start:a,type:"URL"})})),n.messageAttachments.length){var t="";_.each(n.messageAttachments,function(e){t+=", "+e.title.text}),t=t.replace(", ",""),e+="\n- Attachments: "+t}return e+="\n\n"}function x(e){_.findWhere(n.reviewedHelpLinks,e)||n.reviewedHelpLinks.push(e)}function T(){S?M(n.messageBody):M(n.messageTitle).then(function(e){e&&e.length||(S=!0,M(n.messageBody))})}function M(e){return e&&e.length?(n.helplinksLoading=!0,d.getHelpLinks(e.replace(/"/g,""),3).then(function(e){return n.links=e},function(){return n.links=[],!1}).finally(function(){n.helplinksLoading=!1}).catch(function(e){console.error(e)})):(n.links=[],u.when())}var I,$,A,S,P={datasource:s.get("support-categories/datasource"),dataManipulation:s.get("support-categories/data-manipulation"),cardsPages:s.get("support-categories/cards-pages"),connectors:s.get("support-categories/connectors"),workbench:s.get("support-categories/workbench"),userManagement:s.get("support-categories/user-management"),developer:s.get("support-categories/developer"),miscellaneous:s.get("support-categories/miscellaneous")},E=[{heading:!0,label:P.datasource},{label:s.get("support-categories/data-mismatch"),category:P.datasource},{label:s.get("support-categories/credentials"),category:P.datasource},{label:s.get("support-categories/new-datasource"),category:P.datasource},{label:s.get("support-categories/enhancement-request"),category:P.datasource},{label:s.get("support-categories/error"),category:P.datasource},{heading:!0,label:P.dataManipulation},{label:s.get("support-categories/beast-mode"),category:P.dataManipulation},{label:s.get("support-categories/datafusion"),category:P.dataManipulation},{label:s.get("support-categories/dataflow"),category:P.dataManipulation},{label:s.get("support-categories/magic-etl"),category:P.dataManipulation},{heading:!0,label:P.cardsPages},{label:s.get("support-categories/create-edit"),category:P.cardsPages},{label:s.get("support-categories/series-selection"),category:P.cardsPages},{label:s.get("support-categories/chart-properties"),category:P.cardsPages},{label:s.get("support-categories/summary-number"),category:P.cardsPages},{label:s.get("support-categories/sorting"),category:P.cardsPages},{label:s.get("support-categories/filters-analyzer"),category:P.cardsPages},{heading:!0,label:P.connectors},{label:s.get("support-categories/ms-powerpoint-plugins"),category:P.connectors},{label:s.get("support-categories/ms-excel-plugins"),category:P.connectors},{heading:!0,label:P.workbench},{label:s.get("support-categories/data-into-domo"),category:P.workbench},{label:s.get("support-categories/scheduling"),category:P.workbench},{label:s.get("support-categories/credentials"),category:P.workbench},{heading:!0,label:P.userManagement},{label:s.get("support-categories/password-issue"),category:P.userManagement},{label:s.get("support-categories/user-security"),category:P.userManagement},{label:s.get("support-categories/create-new-user"),category:P.userManagement},{label:s.get("support-categories/remove-user"),category:P.userManagement},{label:s.get("support-categories/publication-group"),category:P.userManagement},{label:s.get("support-categories/single-sign-on"),category:P.userManagement},{heading:!0,label:P.developer},{label:s.get("support-categories/dataset-api"),category:P.developer},{label:s.get("support-categories/design-studio"),category:P.developer},{label:s.get("support-categories/dev-studio"),category:P.developer},{label:s.get("support-categories/group-api"),category:P.developer},{label:s.get("support-categories/stream-api"),category:P.developer},{label:s.get("support-categories/user-api"),category:P.developer},{label:s.get("support-categories/custom-connector"),category:P.developer},{heading:!0,label:P.miscellaneous},{label:s.get("support-categories/other"),category:P.miscellaneous}];p()}}}])},1774:function(e,n){e.exports='<db-modal-header>\n<div class=search-box>\n<div ng-hide=editTitle>\n<label class=bz-text-display-4>{{messageTitle}}</label>\n<i class=icon-pencil-box ng-click="editTitle = true; focusTitleInput()"></i>\n</div>\n<div ng-show=editTitle ng-form>\n<input autofocus={{(!messageTitle.length)}} required type=text class="input margin-right-xsmall bz-support-ticket-title" ng-model=messageTitle ng-change=updateMessageTitle(messageTitle) ng-blur="editTitle = (!messageTitle.length)" placeholder={{::vm.i18n.supportTicketHeadingPlaceholder}} />\n</div>\n</div>\n</db-modal-header>\n<db-modal-body>\n<textarea class="input bz-support-ticket-description" required autofocus={{(!!messageTitle.length)}} placeholder={{::vm.i18n.supportTicketPlaceholder}} ng-model=messageBody ng-change=updateMessageBody(messageBody) ng-model-options="{updateOn: \'default blur\', debounce: { \'default\': 200 }}"></textarea>\n<div class=bz-support-ticket-controls>\n<div class=bz-text-caption dm-i18n=buzz/select-category></div>\n<div db-dropdown items=messageCategories on-item-selected=onCategorySelect(item) menu-open=menuOpened ng-model=messageCategory placeholder-text={{::vm.i18n.selectCategory}}>\n<db-dropdown-search-box></db-dropdown-search-box>\n<db-dropdown-basic-list></db-dropdown-basic-list>\n</div>\n</div>\n<div class=bz-support-ticket-controls>\n<div class=bz-text-caption dm-i18n=buzz/attach-file></div>\n<div class=bz-support-attachment-preview ng-repeat="attachment in messageAttachments" ng-mouseenter="showRemoveAttachment = true" ng-mouseleave="showRemoveAttachment = false">\n<doc-preview class=body file-id=attachment.id size=micro full-screen-on-click></doc-preview>\n<span class=bz-attached-item-remove ng-click=removeAttachment(attachment) ng-show=showRemoveAttachment db-tooltip={{::vm.i18n.remove}}><i class=icon-x></i></span>\n</div>\n<div class=bz-support-attach-file db-tooltip={{::vm.i18n.addAttachment}}>\n<label for=bzSupportAttachment><i class=icon-plus></i></label><input id=bzSupportAttachment name=bzSupportAttachment type=file multiple=true dm-file-input-change=addAttachment(files) />\n</div>\n</div>\n<div class="bz-support-links color-link">\n<hr>\n<span class=links-title dm-i18n=buzz/support-ticket-links></span>\n<div ng-hide="helplinksLoading && !links.length">\n<ul ng-show=links.length>\n<li class=help-link ng-repeat="link in links">\n<a class=link-title ng-click=updateReviewedHelplinks(link) ng-href={{link.uri}} target=_blank dm-track-click=support_mind_touch_link>{{link.title}}</a>\n<span class=link-preview> • <span class=bz-text-italics>{{link.preview}}</span></span>\n</li>\n</ul>\n<ul ng-hide=links.length>\n<li><a ng-href={{::helpCenterURL}} target=_blank dm-track-click=support_ticket_help_center dm-i18n=buzz/help-center-link></a></li>\n<li><a ng-href={{::communityURL}} target=_blank dm-track-click=support_ticket_community dm-i18n=buzz/domo-community-link></a></li>\n<li><a href=/api/domoweb/auth/domou target=_blank dm-track-click=support_ticket_domo_university dm-i18n=buzz/domo-university-link></a></li>\n</ul>\n</div>\n<div ng-show="helplinksLoading && !links.length" class="spinner medium"></div>\n</div>\n</db-modal-body>\n<db-modal-footer>\n<db-button ng-click=cancel() theme=alt size=large dm-i18n=buzz/cancel></db-button>\n<db-button size=large theme=primary ng-click=submitTicket() dm-i18n=buzz/create-ticket ng-disabled=disabled()></db-button>\n</db-modal-footer>\n'},1775:function(e,n,t){t(47);angular.module("buzz").directive("bzThreadView",["bzRootPath","bzStates","bzStore","bzService","bzEvents","bzPreferences","dmI18n","features",function(e,n,a,i,s,o,r,c){return{restrict:"E",scope:{channel:"=",show:"="},template:t(1776),link:function(e,n,t){function l(){e.dateFormat=r.get("date-formats/month-day-time"),e.threadClicked=u,e.loadMoreHuddles=p,e.toggleThreadView=d,e.showLatestMessage=function(e){return e.messages&&e.messages.length&&e.messages[0].content.text!==e.title},e.settings=o,e.i18n={backToConversation:r.get("buzz/back-to-conversation"),unreadCount:r.get("buzz/unread-threads-count",{count:e.channel.unreadCounts&&e.channel.unreadCounts.huddleMessages}),noMessages:r.get("buzz/new-private-thread"),close:r.get("close")},e.$watch("show",function(n){n&&(p(!0),e.showMenuThreadOptions=c.on("buzz-menu-threads")&&"ObjectChat"!==e.channel.normalizedChannelType)}),e.$watch("channel.unreadCounts.huddleMessages",function(n){_.isUndefined(n)||(e.i18n.unreadCount=r.get("buzz/unread-threads-count",{count:e.channel.unreadCounts.huddleMessages}))}),e.showMenuThreadOptions=c.on("buzz-menu-threads")&&"ObjectChat"!==e.channel.normalizedChannelType}function d(){e.show=!e.show}function u(e){a.setCurrentThread(e,null,null,!0)}function p(n){if(e.show&&e.channel&&!e.channel.loadingHuddles&&!e.channel.allHuddlesLoaded){var t,a=e.channel,o=a.id;a.loadingHuddles=!0,n||_.forEach(a.huddles,function(e){(_.isUndefined(t)||e.lastUpdated<t.lastUpdated)&&(t=e)}),i.getHuddlesForChannel(o,{pagingId:t?t.id:"",pagingMode:"MOST_RECENT",pagingLimit:20}).then(function(n){n&&n.length?(_.forEach(n,function(e){var n=_.findWhere(a.huddles,{id:e.id});n?angular.extend(n,e):a.huddles.push(e)}),s.menuHeightChanged.trigger()):e.channel.allHuddlesLoaded=!0}).finally(function(){a.loadingHuddles=!1}).catch(function(e){console.error(e)})}}l()}}}])},1776:function(e,n){e.exports='<div class=bz-thread-view ng-class="{\'show\': show}">\n<div class="thread-view-header bz-container">\n<span class="thread-unread-count bz-text-label secondary">{{i18n.unreadCount}}</span>\n<span class=close-thread-view><i class=icon-x db-tooltip={{i18n.close}} ng-click=toggleThreadView()></i></span>\n</div>\n<div class=thread-view-container>\n<div class=thread-view-threads dm-infinite-scroll=loadMoreHuddles() ng-hide=!show>\n<div class="thread bz-container" ng-repeat="thread in channel.huddles | orderBy: [\'-lastUpdated\'] track by thread.id" ng-class="{\'last\': $last}" ng-click="threadClicked(thread, $event)">\n<div class=top-section>\n<div class="menu-huddle-title-text bz-text-overflow" ng-class="{\'unread-activity\':thread.unreadCounts.messages}">{{thread.title}}</div>\n<div class=notifications-container>\n<div class="time-ago bz-text-caption secondary" ng-if=thread.showRelativeTime>{{thread.timeAgoWithHuddles}}</div>\n<div class="time-ago bz-text-caption secondary" ng-if=!thread.showRelativeTime dm-moment={{::thread.lastUpdated}} format={{::dateFormat}}></div>\n<div class=missed-messages ng-show=thread.importantCounts.messages ng-class="{mentioned: thread.importantCounts.messages}">{{thread.importantCounts.messages}}</div>\n</div>\n</div>\n<div class=bottom-section>\n<div class=avatar dm-avatar-widget="{{(thread.messages[0].createdById || thread.createdById)}}" size=large noclick=true></div>\n<div class=message db-tooltip={{thread.tooltip}} db-tooltip-placement=right>\n<div class="bz-text-body secondary">{{thread.messages[0].createdBy.displayName}}</div>\n<div ng-if=showLatestMessage(thread) ng-class="{\'bz-text-italics\': thread.messages[0].messageType === \'SYSTEM\'}" class="menu-huddle-caption-text bz-text-caption secondary bz-text-overflow" ng-bind-html=thread.messages[0].content.text></div>\n<div ng-if=!showLatestMessage(thread) class="menu-huddle-caption-text bz-text-italics bz-text-caption secondary bz-text-overflow">{{i18n.noMessages}}</div>\n</div>\n</div>\n<div class=bottom-border></div>\n</div>\n<div class=threads-loader ng-class="{\'finished-loading\':channel.allHuddlesLoaded}">\n<span ng-show=channel.loadingHuddles class="spinner medium"></span>\n</div>\n</div>\n</div>\n<div class=thread-view-footer ng-if=showMenuThreadOptions>\n<div class="period-setting position-relative no-border">\n<db-checkbox ng-model=settings.enableMenuThreads></db-checkbox>\n<span dm-i18n=up/enable-menu-threads></span>\n</div>\n</div>\n</div>\n'},1777:function(e,n,t){t(1778);var a=t(75),i=t(47);a.module("buzz").component("bzRamMessage",{template:t(1780),bindings:{message:"<"},controller:["dmI18n","jstz","$element","bzHelpers",function(e,n,t,a){function s(e){return a.tagClickHandler(e,t)}var o=this,r=n.determine().name(),c=o.showDate?e.get("date-formats/month-day-time"):"LT";o.explicitDate=i(o.message.created).tz(r).format(c),o.tagClickHandler=s}]})},1778:function(e,n,t){var a=t(1779);"string"==typeof a&&(a=[[e.id,a,""]]);var i,s={};s.transform=i;t(3)(a,s);a.locals&&(e.exports=a.locals)},1779:function(e,n){e.exports="bz-ram-message{display:block;position:relative}bz-ram-message:before{content:'';position:absolute;border:14px solid;border-color:transparent;border-left-color:#F0F8FD;height:0;width:24px;left:24px;bottom:-14px}bz-ram-message .left-side{margin-right:12px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:start;-ms-flex-align:start;align-items:flex-start}bz-ram-message .message-creator{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-flex:1;-ms-flex:1 0 auto;flex:1 0 auto;max-width:100%}bz-ram-message .message-via-text{margin-bottom:-10px;color:rgba(0,0,0,0.3);margin-top:-4px}bz-ram-message bz-markup-renderer{display:block;white-space:pre-wrap}bz-ram-message .message-header{margin-bottom:1px;position:relative;top:-2px;display:-webkit-box;display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-box-align:center;-ms-flex-align:center;align-items:center}bz-ram-message .message-container{box-sizing:border-box;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:start;-ms-flex-align:start;align-items:flex-start;position:relative;transition:opacity .2s, -webkit-transform .2s;transition:transform .2s, opacity .2s;transition:transform .2s, opacity .2s, -webkit-transform .2s;opacity:1;word-break:break-word;margin:12px 24px;padding:24px;padding-left:18px;border-radius:12px;background-color:#F0F8FD}bz-ram-message .message-container .attachment-title-bar{font-weight:600;font-size:14px;min-height:25px;cursor:pointer}bz-ram-message .message-container .attachment-title-bar .media-collapse{cursor:pointer;display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center}bz-ram-message .message-container .attachment-title-bar .media-collapse .giphy-chevron{color:#99ccee;transition:all 150ms linear}bz-ram-message .message-container .attachment-title-bar .media-collapse .rotate-right{-webkit-transform:rotate(-90deg);transform:rotate(-90deg)}bz-ram-message .message-container .attachment-title-bar .media-collapse .media-toggle-text{font-size:11px;color:rgba(0,0,0,0.6);font-weight:500;line-height:22px}bz-ram-message .actions{margin-top:12px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between}bz-ram-message .actions span{margin-bottom:8px}bz-ram-message .actions span:last-child{margin-bottom:0}\n"},1780:function(e,n){e.exports='<bz-last-viewed-message ng-if=$ctrl.message.showLastViewed class="date-breakup bz-text-label secondary" message=$ctrl.message></bz-last-viewed-message>\n<div class=message-container>\n<div class=left-side>\n<div ng-if="$ctrl.message.showCreator && !$ctrl.message.createdBy.iconUrl" class="message-avatar bz-avatar" dm-avatar-widget user=::$ctrl.message.createdBy size=large></div>\n<div class="bz-avatar message-avatar" ng-if="$ctrl.message.showCreator && $ctrl.message.createdBy.iconUrl">\n<bz-third-party-avatar icon-url=$ctrl.message.createdBy.iconUrl avatar-size=large>\n</bz-third-party-avatar>\n</div>\n</div>\n<div class=right-side>\n<div class=message-header ng-if=$ctrl.message.showCreator>\n<span class="message-creator bz-text-overflow bz-text-body bold">{{::$ctrl.message.createdBy.displayName}}</span>\n</div>\n<div ng-if="$ctrl.message.createdBy.type === \'SYSTEM\' && $ctrl.message.viaId" class="message-via-text bz-text-caption">{{vm.i18n.viaText}}</div>\n<bz-markup-renderer class="position-relative content bz-text-body" content=$ctrl.message.content modified="($ctrl.message.modified - $ctrl.message.created) > 5000 && $ctrl.message.messageType !== \'SYSTEM\' ? $ctrl.message.modified : false" tag-click-handler=$ctrl.tagClickHandler>\n</bz-markup-renderer>\n<div class=actions>\n<span ng-repeat="action in $ctrl.message.actions" ng-switch=action.type>\n<bz-action-upload-avatar ng-switch-when=UPLOAD_AVATAR message=$ctrl.message action=action></bz-action-upload-avatar>\n<bz-action-invite-users ng-switch-when=INVITE_USERS message=$ctrl.message action=action></bz-action-invite-users>\n</span>\n</div>\n</div>\n</div>'},1781:function(e,n,t){t(1782);var a=t(75);a.module("buzz").component("bzActionUploadAvatar",{template:'\n    <db-button class="image-selector-toggle-button" ng-class="{completed: $ctrl.action.data.completed}" ng-click="$ctrl.openProfileImageSelectDialog()" theme="primary">\n      <span dm-i18n="upload"></span>\n      <user-image-selector\n        reference="$ctrl.componentApis.profileImageSelector"\n        user-id="{{$ctrl.currentUserId}}"\n        image-type="profile"\n        on-selection="$ctrl.selectProfilePicture(imageId)" />\n    </db-button>\n  ',bindings:{action:"<",message:"<"},controller:["CurrentUser","dmAvatarService","dmCachedUsers","dmUserService","profileService","Analytics",function(e,n,t,a,i,s){function o(){s.track("buzz_message_ram_action",{domotalk_tag_type:l.action.type,entity_unique_id:l.message.id}),l.componentApis.profileImageSelector.open()}function r(e){i.getByUserId(l.currentUserId).then(function(i){i.profileImageId=e,c(l.currentUserId,i).then(function(e){n.updateAvatarImage(l.currentUserId,e.profileImage),t.clearUser(l.currentUserId),a.clearUser(l.currentUserId)})})}function c(e,n){return i.updateByUserId(e,n)}var l=this;l.currentUserId=e.domoUserId,l.componentApis={},l.openProfileImageSelectDialog=o,l.selectProfilePicture=r}]})},1782:function(e,n,t){var a=t(1783);"string"==typeof a&&(a=[[e.id,a,""]]);var i,s={};s.transform=i;t(3)(a,s);a.locals&&(e.exports=a.locals)},1783:function(e,n){e.exports="bz-action-upload-avatar .completed{background-color:#A0D772 !important;border-color:#A0D772 !important}\n"},1784:function(e,n,t){var a=t(75);a.module("buzz").component("bzActionInviteUsers",{template:'\n    <db-button ng-click="$ctrl.openInviteModal()" theme="primary">\n      <i class="icon-person-plus md"></i>\n      <span dm-i18n="invite"></span>\n    </db-button>\n    <span class="bz-text-caption secondary margin-left-xxsmall" ng-if="$ctrl.action.data.inviteCount" dm-i18n="buzz/invites-sent" data="{count: $ctrl.action.data.inviteCount}"></span>\n  ',bindings:{action:"<",message:"<"},controller:["dmUserInviteModalService","$element","dmI18n","Analytics",function(e,n,t,a){function i(){a.track("buzz_message_ram_action",{domotalk_tag_type:s.action.type,entity_unique_id:s.message.id}),e.open({element:n,analyticsEvent:"global_menu",message:t.get("invite-prompt")})}var s=this;s.openInviteModal=i}]})},1785:function(e,n,t){var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=t(8);angular.module("buzz").directive("bzCreateMessage",["bzRootPath","bzAttachmentAdapter","$filter","$timeout","$q","bzMessageService","bzEvents","bzStore","bzService","bzStates","bzPreferences","bzActivityMonitor","dmI18n","BuzzAnalytics","Analytics","bzHelpers","bzModals","features","dmUserService","dmUserInviteModalService","dmSocialUserService","dmValidateFileUpload","$compile","dmUtils","bzMessage","dmBootstrap","buzzContainerService",function(e,n,s,o,r,c,l,d,u,p,h,g,m,b,v,f,z,y,w,k,C,x,T,M,I,$,A){return{restrict:"E",scope:{api:"=?",onCreate:"&",isDisabled:"=?",onAttachmentAdded:"&",onAttachmentRemoved:"&",onMentioned:"&?",onUnmentioned:"&?",onGiphySearch:"&",submitEnabled:"@?",disableThread:"=?",disableAudience:"=?",onCancelThread:"&?",ignoreCurrentChannel:"@?",manualChannel:"=?",currentMessage:"=?",toggleEditMode:"&?"},template:t(1786),link:function(e,t,T){function S(){e.channel=e.manualChannel||d.currentChannel;var n=e.$watch("api",function(t,i){t&&"object"===("undefined"==typeof t?"undefined":a(t))&&(_.extend(e.api,{quoteMessage:ee,addAttachment:W,focus:G,getAttachments:Y,getUnsentMessage:J,reset:H,addText:K,moveCursorToEnd:Q,removeMention:U,inviteNewUser:ae,insertMention:Z,getMentions:D,isCreatingPrivateThread:Ie,addFileAttachment:Ae}),n())});e.convertToThread=le,e.togglePrivateThread=de,e.toggleMoreOptions=ce,e.hideAudiencePopup=re,e.clearConversionMessage=be,e.searchGiphy=_.debounce(ye,25),e.addAttachment=W,e.removeAttachment=X,e.removeQuote=ne,e.submitMessage=q,e.selectInlineTagResult=te,e.searchMentions=fe,e.searchCommands=ze,e.userGroupRemoved=he,e.userGroupSelected=ge,e.cancelThreadCreation=ue,e.onMentionAdd=we,e.onMentionRemove=ke,e.onMentionFilePasted=xe,e.focus=G,e.addEmoji=oe,e.cancel=O,e.clearWarningMessage=ie,e.openWhy=Te,e.onCloseWhy=Me,e.viewAllUsersModal=se,e.focusNext=V,e.onChange=angular.noop,e.changeDetected=angular.noop,e.showPrivateText=!1,e.chatPlaceholder="",e.vm={},e.isIE=document.documentMode||/Edge/.test(navigator.userAgent),e.vm.submitEnabled=!_.has(T,"submitEnabled")||e.submitEnabled,R(),e.chatPlaceholder="",e.whyFlag=!1,e.postAsThread={},e.postThreadMentionData=[],e.audienceOverride=!1,e.hideAudience=M.localStorageRead(He),e.userSelect={users:[],groups:[],rawUsersGroups:[]},B(),Se(),e.currentMessage?Pe():(F(),ve(),Ve.push(l.onMessageEdit.on(function(){e.tagListApi.hide(),H()}))),Ee(),Le=e.channel.inheritPermissions?f.getChannelUsersType(e.channel.parentChannel):f.getChannelUsersType(e.channel),Ve.push(l.channelChange.on(E)),Ve.push(h.onUpdated(P)),Ve.push(l.updatePeopleCount.on(N)),Ve.push(l.createThread.on(le)),e.$on("$destroy",function(){if(_.each(Ve,function(e){e()}),Ye.removeClass("show-overlay raise-footer"),e.editMode){var n=me();_.each(n,function(t){_.extend(t,t.data),e.onUnmentioned&&e.onUnmentioned({mention:t,mentions:n})}),ie()}}),e.$watch("submitEnabled",function(n){e.vm.submitEnabled=n}),e.$watch("manualChannel",function(n){n&&(e.channel=e.manualChannel)})}function P(n){n.name&&"enableBuzzProTips"===n.name&&(e.showProTips=A.isFullscreen&&n.value)}function E(){Ee(),e.channel=e.manualChannel||d.currentChannel,_.isUndefined(e.tagListApi)||e.tagListApi.hide(),Le=e.channel.inheritPermissions?f.getChannelUsersType(e.channel.parentChannel):f.getChannelUsersType(e.channel),ve()}function O(){qe=!0}function U(n,t){_.isUndefined(n)||_.isUndefined(t)||(je=!0,e.onChange(),e.mentionApi.removeMentionByValueType(t,n))}function D(){return e.mentionApi.getMentions()}function R(){e.vm.i18n={addEmoji:m.get("buzz/add-emoji"),createThread:m.get("buzz/make-message-private"),createChatMessage:_.unescape(m.get("buzz/create-chat-message")),conversationAccess:m.get("buzz/conversation-access")}}function j(n){function t(n){"ObjectChat"!==e.channel.type?Ze.displayName=m.get("buzz/num-people",{count:s("number")(n)}):Ze.displayName=m.get("buzz/everyone-on-object",{type:L(e.channel.objectType),people:s("number")(n)})}n?t(n):Le.then(function(n){"Access"===n?u.getUsersWithAccessToChannelTotal(e.channel.id).then(t):"Pin"===n&&u.getPinnedUserTotalForChannel(e.channel.id).then(t)})}function L(e){switch(e){case"CARD":return m.get("buzz/card").toLowerCase();case"PAGE":return m.get("buzz/page").toLowerCase();case"PROJECT":return m.get("buzz/project").toLowerCase();case"APPROVAL":return m.get("buzz/approval").toLowerCase();default:return m.get("buzz/object").toLowerCase()}}function N(n){e.peopleCount=n,j(n),e.channel.isDroidChannel()?(e.showPrivateText=!1,e.vm.i18n.publicCountText="You are the only person who can view this conversation."):Le.then(function(t){if(e.showPrivateText="Access"===t,e.showPrivateText){if(!n)return;e.vm.i18n.usersWithAccess=m.get("buzz/num-people",{count:s("number")(n)})}else e.vm.i18n.publicCountText=m.get("buzz/all-users-can-view")})}function F(){function n(){var n=e.channel.type;o&&(clearTimeout(o),o=setTimeout(s,1500)),(!r||Date.now()-r>5e3)&&(g.logActivity(),r=Date.now(),"Topic"!==n&&"ObjectChat"!==n&&"Huddle"!==n&&(o||(o=setTimeout(s,1500)),c.setCurrentlyTyping(e.channel.id,!0)))}function a(){var n=e.channel.type;o&&(o=clearTimeout(o)),r&&"Topic"!==n&&"ObjectChat"!==n&&"Huddle"!==n&&s()}function i(){r=null,e.editMode||l.onMessageCreateFocus.trigger()}function s(){r&&(r=null,c.setCurrentlyTyping(e.channel.id,!1))}var o,r;t.on({blur:a,focus:i,keydown:n},".message-frame .content-editable"),e.$on("$destroy",function(){t.off({blur:a,focus:i,keydown:n},".message-frame .content-editable")})}function H(){e.mentionApi&&e.mentionApi.reset(),ve(),B(),e.hideMessageCreation=!1,ie(),Oe&&o.cancel(Oe),Ue=!1}function B(){e.model={selectingObject:!1,attachmentResults:[],attachmentMenuPath:[Ge],message:{content:{},attachments:[]}}}function G(){e.mentionApi&&"function"==typeof e.mentionApi.focus&&e.mentionApi.moveCursorToPreviousOffset()}function V(e){9!=e.keyCode||e.shiftKey||Be||G()}function q(n){function t(){e.onCreate&&e.onCreate({message:o,postThreadMentionData:e.postAsThread.enabled?e.postThreadMentionData:null,isPublicThread:e.userSelect.users.indexOf(Ze.id)>=0,convertedMessage:e.postAsThread.originalMessage,users:e.userSelect.users,groups:e.userSelect.groups}),H()}if(De&&De.resolve(),!([!1,"false"].indexOf(e.submitEnabled)>=0)&&(n||(n=e.mentionApi.getMessage()),e.model.message.attachments.length||n.content&&n.content.trim().length)){for(var a,i=/@all($|\W)/gim;a=i.exec(n.content);){var s={displayName:"all",length:4,marker:"@",start:a.index,type:"NOTIFY",value:"all"};_.findWhere(n.mentions,s)||n.mentions.push(s)}var o=I.createMessage(n.content,n.mentions,e.model.message.attachments,e.model.message.quote);c.checkPendingAttachments(o.attachments).then(function(e){e&&(o.attachments=e)}),o.attachments&&o.attachments.length&&(o.attachments=_.filter(o.attachments,function(e){return!e.id||e.id.toString().length<=225})),t()}}function W(n){var t=e.model.message.attachments,a=_.find(t,function(e){return e.id+""==n.id+""&&e.type===n.type});n.id&&a?angular.extend(a,n):(t.push(n),je=!0),e.onAttachmentAdded&&e.onAttachmentAdded({attachment:n}),_.defer(function(){Je.scrollTop(Je.height()+100)})}function Y(){return e.model.message.attachments}function J(){if(e.mentionApi&&"function"==typeof e.mentionApi.getMessage){var n=e.mentionApi.getMessage();if(n.content.length>0||n.mentions.length>0||e.model.message.attachments&&e.model.message.attachments.length)return e.model.message.attachments&&e.model.message.attachments.length&&(n.attachments=e.model.message.attachments),n}}function K(n){e.mentionApi&&"function"==typeof e.mentionApi.addText&&e.mentionApi.addText(n,!0)}function Z(n){e.mentionApi&&"function"==typeof e.mentionApi.insertMention&&e.mentionApi.insertMention((n.marker||"")+n.displayName,n,{start:n.start,end:n.start+n.length})}function Q(){e.mentionApi&&"function"==typeof e.mentionApi.insertMention&&e.mentionApi.moveCursorToEnd()}function X(n){var t=e.model.message;t.attachments=_.reject(t.attachments,function(e){return n.id===e.id&&n.type.id===e.type.id}),e.onAttachmentRemoved({attachments:e.model.message.attachments,attachment:n}),je=!0}function ee(n){G(),e.model.message.quote=n}function ne(){delete e.model.message.quote}function te(n){if(b.trackMention(n.type),"blank_user"===n.value)var a=function(e,n){ae(e,n).then(function(){i.close()},function(){i.close()})},i=k.open({element:t,prepop:n.searchText,message:m.get("common/invite-new-description"),analyticsEvent:"buzz_typeahead",onSubmit:a,onInvite:angular.noop});else e.mentionApi.selectSearchResult(n)}function ae(n,t){var a;if("ObjectChat"===d.channels[e.channel.channelId].type){var i=[];_.each(n,function(e){i.push(w.createUser(e.displayName,e.detail.email,e.role||e.roleId,e.message,!0).catch(angular.noop))}),a=r.all(i)}else a=u.inviteNewUsersToChannel(e.channel.channelId,n);return a.then(function(n){var a=_.map(n,function(e){return{type:"USER",displayName:e.displayName,id:e.id,value:e.id,permission:null}});if("Huddle"!==e.channel.type||e.channel.inheritPermissions||u.inviteToHuddle(e.channel.id,a),t){var i=0;_.each(a,function(n){e.mentionApi.insertMention("@"+n.displayName+" ",n,{start:i}),i+=n.displayName.length+2})}else _.each(a,function(n){e.mentionApi.selectSearchResult(n)})})}function ie(){e.warningMessage=null}function se(){z.open("viewAllAccessUsers")}function oe(n){G(),e.mentionApi.addText(n,!0)}function re(){M.localStorageWrite(He,!0),e.hideAudience=!0}function ce(){null!==e.vm.showMoreOptions&&(e.vm.showMoreOptions=!e.vm.showMoreOptions)}function le(){function n(n){e.audienceOverride=!0,e.postAsThread.isPrivate="ObjectChat"!==e.channel.type||We,n.noOverlay||Ye.addClass("show-overlay raise-footer"),Ce(),_.defer(function(){Re=t.find(".pill-box"),"ObjectChat"!==e.channel.type||e.postAsThread.isPrivate||de(!0),"DirectChat"===e.channel.type&&(e.postAsThread.isPrivate=!1,de(!0))})}function a(n){ve(),e.onCancelThread&&e.onCancelThread()}var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i.message&&i.message.channelId!==e.channel.id||(i&&i.conversion?(e.postAsThread.originalMessage=i.message,e.postAsThread.enabled=!0,n(i)):(e.postAsThread.enabled=!e.postAsThread.enabled,e.postAsThread.enabled?n(i):a(i)),"messages"===p.current&&G())}function de(n){var t=!e.postAsThread.isPrivate,a=Re.scope().selectedItems.indexOf(Ze);t&&!n?(v.track("buzz_conversation_toggle_private"),a>=0&&Re.scope().selectedItems.splice(a,1)):(v.track("buzz_conversation_toggle_public"),a<0&&Re.scope().selectedItems.push(Ze))}function ue(){e.channel.isObjectChannel()?(e.onCancelThread&&e.onCancelThread(),ve()):le()}function pe(e){var n=[];return _.each(e,function(e){n.push({data:_.extend(e,{value:e.id})})}),n}function he(n){n&&(n.id===Ze.id&&v.track("buzz_conversation_default_audience_removed"),_.defer(function(){e.postAsThread.isPrivate=e.userSelect.users.indexOf(Ze.id)<0,e.$digest()}),e.userSelect.rawUsersGroups=_.filter(e.userSelect.rawUsersGroups,function(e){return e.id!==n.id}),ke({data:_.extend(n,{value:n.id})}),U(n.type,n.id))}function ge(n){n&&(t.find(".to-select input").focus(),Be=!0,_.defer(function(){Be=!1}),e.postAsThread.isPrivate=e.userSelect.users.indexOf(Ze.id)<0,e.userSelect.rawUsersGroups.push(n),e.onMentioned&&e.onMentioned({mention:{data:_.extend(n,{value:n.id})},mentions:me()}),Ce())}function me(){return e.mentionApi?e.mentionApi.getMentions().concat(pe(e.userSelect.rawUsersGroups)):[]}function be(){e.postAsThread.originalMessage=null}function ve(){function n(){e.userSelect.users=[],e.userSelect.groups=[],e.userSelect.rawUsersGroups=[],e.postThreadMentionData=[],e.postAsThread={},e.audienceOverride=!1,e.vm.showMoreOptions=!1,Ye.removeClass("show-overlay raise-footer")}e.onMentioned&&e.onMentioned({mention:{},mentions:me()}),e.channel.id&&e.channel.isObjectChannel()&&!e.ignoreCurrentChannel?(n(),le({noOverlay:!0})):n()}function fe(n){return c.searchMentions(n,e.channel.id).then(function(t){var a="all",i=(["Topic","ObjectChat"].indexOf(e.channel.type)>=0?m.get("buzz/channel"):m.get("buzz/chat"),n.search(/^all((\s)+|$)/gim)!==-1&&"DirectChat"!==e.channel.type);i&&"Huddle"===e.channel.type&&(i="DirectChat"!==d.channels[e.channel.channelId].type),
i&&t.unshift({description:m.get("buzz/mention-all-member-of-conversation",{count:e.peopleCount}),displayName:a,value:a,type:"NOTIFY"}),t.length&&(qe=!1);var s=1==C.isSocialUser()&&"ObjectChat"==e.channel.type;return(Ne&&Qe||Fe)&&"DirectChat"!==e.channel.type&&!qe&&n.indexOf(" ")===-1&&0==s&&t.push({description:m.get("buzz/invite-user-description"),searchText:n,displayName:m.get("buzz/invite-user"),value:"blank_user",type:"INVITE"}),t})}function ze(n){return e.editMode?r.when([]):c.searchCommands(n,d.currentChannel.id)}function ye(n){e.editMode||(De&&De.resolve(),De=r.defer(),n?c.searchGiphy(n,De.promise).then(function(n){e.onGiphySearch({giphyResults:n})}):e.onGiphySearch({giphyResults:[]}))}function we(n){v.track("buzz_at_mention",{channel_id:e.channel.id,channel_type:e.channel.type});var t=["USER","GROUP","HASHTAG","PAGE","PROJECT"];if(("USER"===n.type||"GROUP"===n.type||"PAGE"===n.type||"PROJECT"===n.type||"CARD"===n.type||"NOTIFY"===n.type)&&((27===n.value||n.displayName&&"domosupport"===n.displayName.replace(/ /g,"").toLowerCase())&&(e.warningMessage=m.get("buzz/create-support-ticket")),e.onMentioned&&e.onMentioned({mentions:me(),mention:n}),e.postAsThread.enabled&&27!==n.value&&["USER","GROUP"].indexOf(n.type)>=0&&[].concat(e.userSelect.users).concat(e.userSelect.groups).indexOf(n.value)<0)){var a={displayName:n.displayName,id:n.value,type:n.type};"GROUP"===n.type&&(a.customIcon="icon-people"),Re.scope().selectedItems.push(a)}return"URL"===n.type&&Ke?(Oe&&o.cancel(Oe),void(n.embedded?_.findWhere(e.model.message.attachments,{id:n.embedded.url})||_e(n):Oe=o(function(){_.findWhere(e.model.message.attachments,{id:n.value})||_e(n)},1800))):(Ce(),!_.contains(t,n.type)&&Ke?void _e(n):void 0)}function ke(n){"USER"===n.type,(27===n.value||n.displayName&&"domosupport"===n.displayName.replace(/ /g,"").toLowerCase())&&ie(),e.onUnmentioned&&e.onUnmentioned({mention:n,mentions:me()}),_.defer(function(){Ce()}),je=!0}function Ce(){for(var n=me(),t=[],a=0;a<n.length;a++){var i=n[a].data;["USER","GROUP"].indexOf(i.type)>=0&&(_.findWhere(t,{value:i.value})||t.push(i))}e.postThreadMentionData=t}function xe(t,a){if(ie(),a&&(e.warningMessage=m.get("buzz/"+a)),t){if(t.size&&!x.validateSize([t]))return;t.name||(t.name=m.get("buzz/pasted-file-name")+"_"+(new Date).getTime().toString(35)+"."+t.type.split("/")[1]);var i=n.fromFileToAttachment(t);W(i)}}function _e(e){$e()||(Ue=!0,n.fromMentionToAttachment(e).then(function(e){e&&Ue&&W(e)}))}function Te(){null!==e.whyFlag&&(e.whyFlag=!0)}function Me(){_.defer(function(){e.whyFlag=!1})}function Ie(){return 1==e.postAsThread.enabled&&1==e.postAsThread.isPrivate}function $e(){return e.mentionApi.getMessage().content.search(/`/)>=0}function Ae(e){xe(e)}function Se(){d.getDataThreadPrivacyDefault().then(function(e){We="private"===e})}function Pe(){var n="";e.editMode=!0,l.onMessageEdit.trigger(),_.defer(function(){Ke=!1,_.delay(function(){Ke=!0},500),K(e.currentMessage.content.text),e.model.message.attachments=angular.copy(e.currentMessage.attachments),_.each(e.currentMessage.content.tags,function(n){n.displayName||(n.displayName=e.currentMessage.content.text.substring(n.start,n.start+n.length)),n.value||(n.value=n.id),"CURRENT_USER"===n.type&&(n.type="USER"),"MARKUP"!==n.type&&"MARKDOWN"!==n.type&&Z(n,!0)}),e.changeDetected=function(){return e.currentMessage.changeDetected=n.length&&(n!==e.currentMessage.content.text||je)},e.onChange=function(e){n=e.content},Ve.push(l.onMessageEdit.on(function(){e.toggleEditMode({state:!1})})),Ve.push(l.onMessageCreateFocus.on(function(){e.toggleEditMode({state:!1})}))})}function Ee(){u.getAllowInviteSettingStatus().then(function(e){Qe=e.data.enabled})}var Oe,Ue,De,Re,je,Le,Ne=y.on("free-invite")&&y.on("free-role"),Fe="free"==$.data.customerTier||"trial"==$.data.customerTier,He="buzz-hide-audience-flyout",Be=null,Ge="root",Ve=[],qe=!1,We=!1,Ye=i('bz-pane[pos="2"]'),Je=t.find(".attached-items"),Ke=!0,Ze={customIcon:"icon-person",displayName:"",id:1,type:"USER",trackById:"USER_1"},Qe=!1;S()}}}])},1786:function(e,n){e.exports='\n<div class=create-message-warning ng-if=warningMessage>\n<div class=bz-text-body>\n<i class=icon-exclamation-triangle></i>\n<span class=margin-left-xxsmall>{{warningMessage}}</span>\n</div>\n<i class=icon-x ng-click=clearWarningMessage()></i>\n</div>\n<div class=tag-list-anchor>\n<bz-tag-list api=tagListApi on-select=selectInlineTagResult(item) edit-mode=editMode></bz-tag-list>\n</div>\n<div ng-if=postAsThread.enabled class=post-as-thread-audience>\n<div class=original-message ng-if=postAsThread.originalMessage>\n<div class="message bz-text-caption secondary" dm-i18n=buzz/original-message></div>\n<div class=container>\n<span class=avatar dm-avatar-widget user=::postAsThread.originalMessage.createdBy size=large></span>\n<div class=content>\n<div class="bz-text-body bold">{{postAsThread.originalMessage.createdBy.displayName}}</div>\n<div ng-if="postAsThread.originalMessage.content.text.length > 100 && !postAsThread.originalMessage.showingFullMessage">\n<bz-markup-renderer class=bz-text-body content=postAsThread.originalMessage.content max-length=100></bz-markup-renderer>\n<a ng-click="postAsThread.originalMessage.showingFullMessage = true" dm-i18n=buzz/view-more></a>\n</div>\n<div ng-if="postAsThread.originalMessage.content.text.length <= 100 || postAsThread.originalMessage.showingFullMessage">\n<bz-markup-renderer class=bz-text-body content=postAsThread.originalMessage.content></bz-markup-renderer>\n<a ng-if="postAsThread.originalMessage.showingFullMessage == true" ng-click="postAsThread.originalMessage.showingFullMessage = false" dm-i18n=buzz/view-less></a>\n</div>\n</div>\n</div>\n<i class="icon-x bz-text-body secondary cursor-pointer" ng-click=cancelThreadCreation()></i>\n</div>\n<div class="private-message-creation dm-animate" ng-if=postAsThread.enabled>\n<div class="private-users-text bz-text-body secondary" ng-switch=postAsThread.isPrivate>\n<span ng-switch-when=true ng-if="channel.type !== \'DirectChat\'" ng-switch=postThreadMentionData.length>\n<span ng-switch-when=0 dm-i18n=buzz/at-mention-to-add></span>\n<span ng-switch-when=1 dm-i18n=buzz/only-one-user-can-see data="{user1: postThreadMentionData[0].displayName}"></span>\n<span ng-switch-when=2 dm-i18n=buzz/only-two-user-can-see data="{user1: postThreadMentionData[0].displayName, user2: postThreadMentionData[1].displayName}"></span>\n<span ng-switch-when=3 dm-i18n=buzz/only-three-user-can-see data="{user1: postThreadMentionData[0].displayName, user2: postThreadMentionData[1].displayName, user3: postThreadMentionData[2].displayName}"></span>\n<span ng-switch-default dm-i18n=buzz/only-multiple-users-can-see data="{user1: postThreadMentionData[0].displayName, user2: postThreadMentionData[1].displayName, users: postThreadMentionData.length - 2}"></span>\n</span>\n<span ng-switch-when=true ng-if="channel.type === \'DirectChat\'" dm-i18n=buzz/new-private-thread-with data="{user: channel.title}"></span>\n<span ng-switch-when=false ng-if="channel.normalizedNotificationType === \'chats\'" dm-i18n=buzz/all-conversation-users-read-reply></span>\n<span ng-switch-when=false ng-if="channel.normalizedNotificationType === \'channels\'" dm-i18n=buzz/all-conversation-users-read-reply></span>\n<i class="icon-x bz-text-body secondary cursor-pointer" ng-if=!postAsThread.originalMessage ng-click=cancelThreadCreation()></i>\n</div>\n<div class=to-container>\n<span class="bz-text-body secondary" dm-i18n=buzz/to></span>\n<div class=to-select dm-user-select multi-select=true groups=userSelect.groups users=userSelect.users max-results=8 show-defaults-on-focus=false no-results-message=false avatar-click-off=false on-change="userSelectChange(users, groups)" item-removed=userGroupRemoved(item) item-selected=userGroupSelected(item) allow-at-mention=true ng-keydown=focusNext($event)></div>\n<span class=toggle-container><span dm-i18n=private></span> <db-toggle ng-click=togglePrivateThread() ng-model=postAsThread.isPrivate></db-toggle></span>\n</div>\n</div>\n</div>\n<div class="show-audience bz-text-caption" db-stopbubble ng-if="!hideAudience && !audienceOverride && !disableAudience && !editMode">\n<span ng-if=!showPrivateText>\n<span>{{::vm.i18n.publicCountText}}</span>\n</span>\n<span ng-if=showPrivateText>\n<span db-stopbubble><a ng-click=viewAllUsersModal() class=user-count ng-bind=vm.i18n.usersWithAccess></a></span>\n<span ng-if=vm.i18n.usersWithAccess dm-i18n=buzz/can-view></span>\n</span>\n<i class="icon-x bz-text-caption secondary cursor-pointer" db-stopbubble ng-click=hideAudiencePopup()></i>\n</div>\n<div class=message-creation>\n<div class=message-frame-wrapper>\n<div class=message-frame ng-class="{\'edit-mode\':editMode}">\n<span ng-if=!disableThread class=create-thread-icons>\n<i class="icon-lock-open bz-text-caption private-lock-open" ng-click=convertToThread() db-tooltip={{::vm.i18n.createThread}} db-tooltip-placement=top ng-show="!postAsThread.isPrivate || !postAsThread.enabled"></i>\n<i class="icon-lock-closed bz-text-caption private-lock-closed" ng-click=convertToThread() ng-show="postAsThread.isPrivate && postAsThread.enabled"></i>\n</span>\n<dm-mention placeholder-text={{::vm.i18n.createChatMessage}} class="message-input bz-text-body" ng-class="{\'not-ie\':!isIE}" api=mentionApi disable=isDisabled dropdown-api=tagListApi on-giphy-search=searchGiphy(searchText) on-command-search=searchCommands(searchText) on-cancel=cancel() on-change=onChange(content) on-mention-search-cancel=cancel() on-mention-search=searchMentions(searchText) on-mention-add=onMentionAdd(mention) on-mention-remove=onMentionRemove(mention) on-submit=submitMessage(message) on-file-pasted=onMentionFilePasted(file,warning) enter-submission enable-submit=vm.submitEnabled auto-tag-notifications=true edit-mode=editMode></dm-mention>\n<div class=message-actions>\n<bz-add-message-object class=message-add on-attachment-add=addAttachment(attachment) on-attachment-remove=removeAttachment(attachment) on-close=focus()></bz-add-message-object>\n<bz-emoji-picker-button-v2 on-emoji-selected=addEmoji(emoji) db-tooltip={{::vm.i18n.addEmoji}} db-tooltip-placement=left>\n</bz-emoji-picker-button-v2>\n</div>\n</div>\n</div>\n</div>\n<div class=message-edit-actions ng-if=editMode>\n<button class=db-button ng-click="toggleEditMode({state: false})" theme=alt size=large dm-i18n=buzz/cancel tabindex=1></button>\n<button class=db-button size=large ng-click=submitMessage() theme=primary dm-i18n=buzz/save-changes tabindex=1 ng-disabled=!changeDetected()></button>\n</div>\n<div class=attached-items ng-class="{\'edit-mode\':editMode}" ng-show="(model.message.attachments.length || model.message.quote) && !hideMessageCreation">\n<div class=attached-item ng-if=model.message.quote>\n<div class=attached-item-buttons>\n<span class=attached-item-remove-button ng-click=removeQuote()>\n<i class=icon-x></i>\n</span>\n</div>\n<div class=attached-item-content>\n<bz-quote message=model.message.quote />\n</div>\n</div>\n<div class="attached-item dm-animate" ng-repeat="attachment in model.message.attachments" ng-if="attachment.type !== \'URL_PREVIEW\' || attachment.title.text.length">\n<div class=attached-item-buttons>\n<span class=attached-item-remove-button ng-click=removeAttachment(attachment)>\n<i class=icon-x></i>\n</span>\n</div>\n<div class=attached-item-content>\n<bz-attachment attachment=attachment></bz-attachment>\n</div>\n</div>\n</div>\n<div class=message-disabled ng-show=isDisabled></div>\n'},1787:function(e,n,t){var a=t(8);angular.module("buzz").directive("bzAddMessageObject",["$timeout","bzAttachmentAdapter","bzEvents","bzRootPath","bzRouteTracking","bzStore","dmMentionService","fileAttachmentService","bgBadge","dmI18n","Analytics",function(e,n,i,s,o,r,c,l,d,u,p){return{restrict:"E",scope:{onClose:"&",onMentionAdd:"&",onAttachmentAdd:"&",onAttachmentRemove:"&"},template:t(1788),link:function(t,s,o){function l(){d(),t.showObjectPopover=b,t.selectObject=w,t.selectObjectType=v,t.searchForObject=z,t.clearSearch=y,t.addFiles=k,t.api={},t.vm={},f(),g(),h(),A.push(i.nowViewingUpdated.on(g)),t.$on("$destroy",m)}function d(){M(),t.model={selectingObject:!1,selectingObjectType:null,attachmentMenuPath:[$]}}function h(){t.$watch("model.selectingObject",function(e){e?a(document).on("keydown",T):(t.model.attachmentMenuPath=[$],d())})}function g(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t.contextObject=e.contextObject||{},t.viewingCard=t.contextObject.type&&t.contextObject.id!=r.currentChannel.objectId&&!(("Topic"===r.currentChannel.type||"ObjectChat"===r.currentChannel.type)&&(!r.currentChannel.pin||r.currentChannel.invited))&&"PAGE"!==t.contextObject.type}function m(){M(),A.forEach(function(e){e()})}function b(){t.model.selectingObject=!t.model.selectingObject,t.model.selectingObject&&a(".tooltip").remove()}function v(n){t.model.selectingObjectType=n,n&&"FILE"!==n&&(e(function(){a("[bz-add-message-object-search]").focus()}),c.searchMentionsByType("",n).then(function(e){t.model.objectSearchResults=e}),t.model.attachmentMenuPath.push("searchForObject"))}function f(){t.vm.i18n={addAttachment:u.get("buzz/add-attachment"),searchWithDots:u.get("buzz/search-with-dots")}}function z(e){return e&&t.model.selectingObjectType?void c.searchMentionsByType(e,t.model.selectingObjectType).then(function(e){t.model.objectSearchResults=e}):void y()}function y(){t.model.objectSearchText=void 0,t.model.objectSearchResults=[]}function w(e){p.track("buzz_add_attachment_object",{channel_id:r.currentChannel.id,channel_type:r.currentChannel.type});var a;t.model.selectingObject&&(t.model.selectingObject=!1),"CARD"===e.type&&(a=e.value||e.id,n.fromCardToAttachment(a).then(C))}function k(e){p.track("buzz_add_attachment_file",{channel_id:r.currentChannel.id,channel_type:r.currentChannel.type}),t.model.selectingObject&&(t.model.selectingObject=!1),_.each(e,function(e){var t=n.fromFileToAttachment(e);t.promise.catch(function(){x(t)}),C(t)}),I||(I=angular.element("input.bz-attach-file[type=file]")),I.val(null)}function C(e){p.track("buzz_add_attachment",{channel_id:r.currentChannel.id,channel_type:r.currentChannel.type}),t.onAttachmentAdd({attachment:e}),d()}function x(e){t.onAttachmentRemove&&t.onAttachmentRemove({attachment:e}),d()}function T(e){27===e.which&&(t.model.selectingObject=!1,t.$apply(),M())}function M(){a(document).off("keydown",T)}var I,$="root",A=[];l()}}}])},1788:function(e,n){e.exports='<db-button theme=alt tabindex=0 ng-click=showObjectPopover($event) db-tooltip="{{!model.selectingObject ? vm.i18n.addAttachment : \'\'}}" db-tooltip-close-on-click=true>\n<div class=message-add-object-button>\n<i class="icon-paperclip sm"></i>\n</div>\n</db-button>\n<div class="dropdown attach-item-popover" db-popover placement=top-left on-close=onClose() self-close ng-show=model.selectingObject>\n<div dm-popover-menu=model.attachmentMenuPath>\n<ul dm-popover-menu-pane=root class="menu-list with-icons">\n<li class=attach-file-item>\n<i class=icon-upload></i><span dm-i18n=buzz/upload-file></span> <input type=file multiple=true dm-file-input-change=addFiles(files) restrict-large-files class=bz-attach-file />\n</li>\n<li ng-click="selectObjectType(\'CARD\')">\n<i class=icon-chart-bar-vertical></i><span dm-i18n=buzz/add-card></span>\n</li>\n<li ng-if=viewingCard class=separator></li>\n<li ng-if=viewingCard class=heading><span dm-i18n=buzz/now-viewing></span></li>\n<li ng-if=viewingCard ng-click=selectObject(contextObject)><i class=icon-chart-bar-vertical></i>{{contextObject.title}}</li>\n</ul>\n<div dm-popover-menu-pane=searchForObject>\n<div bz-interactive-list>\n<div class=object-search-query-container>\n<div class=search-box>\n<i class=icon-search></i>\n<input type=text class=input placeholder={{::vm.i18n.searchWithDots}} ng-model=model.objectSearchText ng-change=searchForObject(model.objectSearchText) bz-add-message-object-search bz-interactive-list-key-target>\n<i class="clear-search icon-x-circle" ng-click=clearSearch()></i>\n</div>\n</div>\n<div class=object-search-result-container>\n<ul class="menu-list scrollbox-with-shadows no-hovers object-search-result-list" ng-if=model.objectSearchResults.length>\n<li ng-repeat="searchResult in model.objectSearchResults" ng-click=selectObject(searchResult) bz-interactive-list-item>\n<i class=icon-chart-bar-vertical></i> {{searchResult.displayName}}\n</li>\n</ul>\n<div class="text-align-center padding-vertical-small" ng-show="model.objectSearchResults.length === 0" dm-i18n=common/no-matches-found></div>\n</div>\n</div>\n</div>\n</div>\n</div>\n'},1789:function(e,n,t){var a=t(8);angular.module("buzz").directive("bzInteractiveList",function(){return{restrict:"A",scope:!1,link:function(e,n,t){function i(){n.on("mouseenter",h);var a=s();if(a.length&&(I&&l(I),I=a,o(I)),t.bzInteractiveList.length){var i={highlightFirstItem:z,highlightLastItem:y,highlightNextItem:k,highlightPreviousItem:w,selectHighlightedItem:f};e.$eval(t.bzInteractiveList+" = api",{api:i})}e.$on("$destroy",function(){I&&l(I)})}function s(){return n.parent().find("[bz-interactive-list-key-target]")}function o(e){return e.is(":focus")?void r(e):void e.on("focus",u)}function r(e){e.on("keydown",d)}function c(e){e.off("keydown",d)}function l(e){n.off("mouseenter",h),c(e),e.off("focus",u).off("blur",p),T().off("mouseenter",b).off("mouseenter",v)}function d(e){switch(e.keyCode){case 13:f(),e.preventDefault(),e.stopPropagation();break;case 38:w(),e.preventDefault();break;case 40:k(),e.preventDefault()}}function u(){r(I),I.on("blur",p)}function p(){c(I)}function h(){m(),g()}function g(){T().on("mouseenter",b)}function m(){T().off("mouseenter",b)}function b(e){_.has(t,"ignoreHovers")||C(a(this),!1)}function v(e){e.preventDefault(),e.stopPropagation(),g(),T().off("mouseenter",v)}function f(){M&&M.click()}function z(){var e=T();e.length&&C(e.first())}function y(){var e=T();e.length&&C(e.last())}function w(){var e=T();if(!M)return M=e.last(),void M.addClass(S);var n=e.index(M),t=n>0?e.eq(n-1):e.last();C(t,!0)}function k(){var e=T();if(!M)return M=e.first(),void M.addClass(S);var n=e.index(M),t=n<e.length-1?e.eq(n+1):e.first();C(t,!0)}function C(e,n){M&&M.removeClass(S),M=e,M.addClass(S),n&&x(e)}function x(e){m();var n=e.position().top,t=n+e.outerHeight();e.position().top+e.outerHeight()>$.height()?$.scrollTop(t-$.height()+$.scrollTop()):n<0&&$.scrollTop($.scrollTop()-Math.abs(n)),T().on("mouseenter",v)}function T(){return n.find(A)}var M,I,$=n,A="[bz-interactive-list-item]",S="selected";i()}}})},1790:function(e,n,t){angular.module("buzz").directive("bzTagList",["$timeout","bzRootPath","dmI18n","bzEvents","bzStore",function(e,n,a,i,s){return{template:t(1791),restrict:"E",scope:{api:"=",onSelect:"&",editMode:"=?"},link:function(e){function n(){function n(){e.isVisible=!1}function r(){e.isVisible=!0,_.defer(function(){e.editMode?e.interactiveListApi.highlightLastItem():e.interactiveListApi.highlightFirstItem()})}function c(){return e.isVisible}function l(n){var t=[{id:"COMMAND",displayName:a.get("buzz/commands")},{id:"NOTIFY",displayName:a.get("buzz/notifications"),displayIcon:"icon-megaphone"},{id:"USER",displayName:a.get("buzz/users")},{id:"GROUP",displayName:a.get("groups")},{id:"CARD",displayName:a.get("cards"),displayIcon:"icon-chart-bar-vertical"},{id:"PAGE",displayName:a.get("pages"),displayIcon:"icon-pages-bars"},{id:"PROJECT",displayName:a.get("buzz/projects"),displayIcon:"icon-project"},{id:"HASHTAG",displayName:a.get("buzz/hashtags"),displayIcon:"icon-hash"}];"Huddle"!==e.selectedChannel.type&&t.push({id:"INVITE",displayName:a.get("common/invite"),displayIcon:"icon-person-plus"}),e.editMode&&(t.reverse(),n.reverse()),e.model.itemGroups=_.map(t,function(e){var t={type:e};return t.items=_.filter(n,{type:e.id}),t})}e.selectedChannel=s.currentChannel,o=i.channelChange.on(function(){e.selectedChannel=s.currentChannel}),e.model={},e.i18n={action:a.get("action"),actions:a.get("actions")},e.api={hide:n,show:r,isVisible:c,setItemData:l,highlightPreviousItem:e.interactiveListApi.highlightPreviousItem,highlightNextItem:e.interactiveListApi.highlightNextItem,selectHighlightedItem:e.interactiveListApi.selectHighlightedItem},e.selectItem=t,e.$on("$destroy",o)}function t(n){if(e.onSelect){var t=angular.copy(n);delete t.description,e.onSelect({item:t})}}var o;n()}}}])},1791:function(e,n){e.exports='<div class=tag-list bz-interactive-list=interactiveListApi ng-show=isVisible ng-class="{\'full-width\':editMode}">\n<div class=tag-list-heading ng-repeat-start="itemGroup in model.itemGroups track by itemGroup.type.id" ng-if=itemGroup.items.length>\n<span ng-show="model.itemGroups.length > 1">{{::itemGroup.type.displayName}}</span>\n</div>\n<ul class="menu-list no-hovers" ng-repeat-end>\n<li ng-repeat="item in itemGroup.items track by (item.type + item.value)" ng-click=selectItem(item) bz-interactive-list-item db-tooltip={{item.description}} db-tooltip-show=1000>\n<span class="item {{item.type}}">\n<span class=item-icon ng-if="itemGroup.type.id !== \'COMMAND\'">\n<span ng-if="itemGroup.type.id === \'USER\'" dm-avatar-widget={{item.value}}></span>\n<span ng-if="itemGroup.type.id === \'GROUP\'" dm-avatar-group-widget=item.value size=micro></span>\n<i ng-if=itemGroup.type.displayIcon ng-class=itemGroup.type.displayIcon></i>\n</span>\n<span class=item-text-primary>\n<span ng-class="{\'font-weight-bold\': itemGroup.type.id === \'COMMAND\'}">{{::item.displayName}}</span>\n<span class=item-examples ng-if=item.examples> {{::item.examples}}</span>\n<span class=item-action ng-if="item.commandActions.length > 0">[{{::i18n.action}}]</span>\n</span>\n<span class="item-text-secondary item-description" ng-if=item.description>{{::item.description}}</span>\n</span>\n<span class=actions-header ng-if="item.type === \'COMMAND\' && item.commandActions.length > 0">{{::i18n.actions}}:</span>\n<span class=command-actions ng-if="item.type === \'COMMAND\' && item.commandActions.length > 0">\n<span class=command-action ng-repeat="action in item.commandActions">\n<span class=command-action-name>{{::action.name}}</span>\n<span class="item-text-secondary item-description">{{::action.description}}</span>\n</span>\n</span>\n</li>\n</ul>\n</div>\n'},1792:function(e,n,t){t(81);angular.module("buzz").component("bzEmojiCategoryMenu",{template:t(1793),bindings:{selectCategory:"=",currentEmojiCategory:"<",showRecent:"<"},controller:["bzEmojiService","$attrs",function(e,n){function t(){a.categories=e.EMOJI_CATEGORIES,a.showRecent||(a.categories=a.categories.filter(function(e){return"recent"!==e.name}))}var a=this;a.$postLink=t}]})},1793:function(e,n){e.exports='<div class=bz-emoji-category-wrapper>\n<div class=bz-emoji-category-icon ng-repeat="category in $ctrl.categories track by category.name" db-tooltip="{{ :: category.i18n }}" db-tooltip-placement=bottom>\n<div class="icon-button xs" ng-class="{\'visible-category\': $ctrl.currentEmojiCategory === category.name}" theme=alt ng-click=$ctrl.selectCategory(category.name)>\n<i class="twa twa-2x twa-{{::category.icon}}">\n</i>\n</div>\n</div>\n</div>\n'},1794:function(e,n,t){var a=t(8),i=t(81);angular.module("buzz").component("bzEmojiPickerV2",{template:t(1795),bindings:{onClose:"<",data:"<",setSelectedEmoji:"&"},controller:["bzEmojiService","dmI18n","$element","$scope",function(e,n,t,s){function o(){var t={name:"recent",emojis:e.getRecentEmojis().map(function(e){return{name:e.id}})};U.showRecent=t.emojis&&t.emojis.length,U.searchText="",U.emojis=Object.keys(e.CATEGORIZED_EMOJIS).reduce(function(n,t){return n.push({name:t,emojis:e.CATEGORIZED_EMOJIS[t]}),n},[t]),H=m(U.emojis,U.isFiltering),U.text={searchEmojis:n.get("buzz/search-emojis")},U.filteredEmojis=[],U.currentEmojiCategory=null,i.defer(function(){u()}),l()}function r(){S()}function c(e){}function l(){D.click(d),D.scroll(L),D.keydown(v),j.keydown(b),s.$on("$destroy",function(){D.off("click"),D.off("scroll"),D.off("keydown")})}function d(n){var t=void 0,a=void 0;t=n.target.attributes.getNamedItem("emoji-id"),null!==t&&(a=t.value,e.addRecentEmoji(a),U.setSelectedEmoji({emoji:a}))}function u(e){var n=void 0,t=void 0,o=void 0,r=void 0,c=void 0,l=void 0,d=void 0,u=void 0;n=D.offset(),t=n.top,o=t+D.height(),c=R.find(".emoji-category.categorized").toArray().reduce(function(e,n){return d=a(n),u=d.offset(),null===e.elem?(e.elem=n,e.min=l=Math.abs(u.top-t)):(l=Math.abs(u.top-t))<e.min&&u.top<o?(e.elem=n,e.min=l):(l=Math.abs(u.top+d.height()-t))<e.min&&(e.elem=n,e.min=l),e},{elem:null,min:Number.MAX_SAFE_INTEGER}).elem.attributes.getNamedItem("emoji-category-anchor"),r=c.value,U.currentEmojiCategory!==r&&(U.currentEmojiCategory=r,i.defer(function(){s.$digest()}))}function p(n){_(),M(),U.isFiltering=n&&n.length,U.filteredEmojis=e.emojiSearch(n.toLowerCase()),H=U.isFiltering?m(U.filteredEmojis,U.isFiltering):m(U.emojis),N=void 0,$()}function h(e){var n=void 0,t=void 0,a=void 0,i=void 0,s=void 0,o=void 0;S(),n=D.find('.emoji-category[emoji-category-anchor="'+e+'"]'),t=n.offset().top,a=~~(t-R.offset().top),s=E,o=R.height(),i=g(D.offset().top-t,s,o),D.animate({scrollTop:a},i)}function g(e,n,t){var a=void 0,i=void 0,s=void 0,o=void 0;return e=Math.abs(e),e>t?e=t:e<n&&(e=n),s=Math.abs(P.high-P.low),o=Math.abs(t-n),a=s/o,i=Math.abs(P.low+s*(e/o))}function m(e,n){function t(e){for(var n=[],t=Math.ceil(e.length/7),a=0,s=0;s<t;++s){for(var r=[],c=0;c<O;++c)i.isUndefined(e[a])||(e[a].index=o++,r.push(e[a])),a++;n[s]=r}return n}var a=[],s=[],o=0;if(n)a.push(t(e));else for(var r=0;r<e.length;++r)a.push(t(e[r].emojis));for(var c=0;c<a.length;++c)for(var l=0;l<a[c].length;++l)s.push(a[c][l]);return s}function b(e){e.stopPropagation(),e=e||event;var n=e.keyCode;switch(n){case 9:z(e),e.preventDefault();break;case 40:$(),i.isUndefined(N)?z(e):N.focus();break;case 27:a(".message-input .content-editable").focus(),U.onClose()}}function v(e){e.stopPropagation(),e=e||event;var n=e.keyCode;switch(n){case 13:f(e);break;case 27:a(".message-input .content-editable").focus(),U.onClose();break;case 37:y(e);break;case 38:k(e);break;case 39:w(e);break;case 40:C(e)}}function f(){d({target:N})}function z(e){e.stopPropagation(),B=0,G=0,$(),A(),x()}function y(e){if(e.preventDefault(),i.isUndefined(H[B][G].index)&&$(),B>0||G>0)A(),0==G&&B?(B--,G=H[B].length-1):G>0&&G--;else if(0==B&&0==G)return;x()}function w(e){if(A(),e.preventDefault(),i.isUndefined(H[B][G].index))$(),G++;else{var n=H.length-1,t=B==n&&G==H[n].length-1;t||(G==H[B].length-1&&B<n?(B++,G=0):G>=0&&G++)}x()}function k(e){A(),e.stopPropagation(),0==B?(_(),S()):H[B-1]&&H[B-1][G]?B--:H[B-2]&&H[B-2][G]&&(B-=2),x()}function C(e){A(),e.preventDefault(),i.isUndefined(N)?($(),B=0,G=0,N=H[B][G]):B<H.length-1&&H[B+1]&&H[B+1][G]?B++:B<H.length-2&&H[B+2]&&H[B+2][G]&&(B+=2),x()}function x(){_(),T(),I()}function _(){N&&angular.element(N).removeClass("active")}function T(){N=F[H[B][G].index]}function M(){B=0,G=0,$(),F[B]&&F[B][G]&&F[B][G].index&&(N=F[H[B][G].index])}function I(){N&&(angular.element(N).addClass("active"),N.focus())}function $(){F=U.isFiltering?angular.element(".filtered .emoji-button"):angular.element(".unfiltered .emoji-button")}function A(){i.delay(function(){j.blur(),s.$digest()})}function S(){i.delay(function(){j.focus(),s.$digest()})}var P={low:300,high:870},E=200,O=7,U=this,D=a(t.find(".emoji-container")),R=D.find(".emoji-list-container"),j=t.find("#bz-emoji-picker-search-input"),L=i.throttle(u,15),N=void 0,F=void 0,H=void 0,B=0,G=0;U.$onInit=o,U.$onChanges=c,U.$postLink=r,U.selectCategory=h,U.onSearchChange=p}]})},1795:function(e,n){e.exports='<div class=emoji-picker-wrapper>\n<span class=emoji-anchor>\n</span>\n<db-popover ng-show=$ctrl.data.open class=popover self-close placement=top-center on-close=$ctrl.onClose()>\n<div class=bz-emoji-picker-menu>\n<div class=search-bar>\n<div class=search-box>\n<i class=icon-search></i>\n<input id=bz-emoji-picker-search-input class="input emoji-search-input" spellcheck=false type=text placeholder={{::$ctrl.text.searchEmojis}} ng-model=$ctrl.searchText ng-change=$ctrl.onSearchChange($ctrl.searchText) />\n</div>\n</div>\n<div class="emoji-container unfiltered" ng-hide=$ctrl.isFiltering>\n<div class=emoji-list-container>\n<div class="emoji-category categorized" ng-if="category.emojis && category.emojis.length" ng-repeat="category in $ctrl.emojis track by category.name" emoji-category-anchor="{{ :: category.name }}">\n<div class=category-header>\n<div class=category-name>\n{{::category.name}}\n</div>\n</div>\n<div class=emoji-list>\n<div ng-repeat="emoji in ::category.emojis" class=emoji-button tabindex=0 emoji-id="{{ :: emoji.name }}" db-tooltip="{{ :: emoji.name }}">\n<i class="twa twa-2x twa-{{ :: emoji.name }}" emoji-id="{{ :: emoji.name }}"></i>\n</div>\n</div>\n</div>\n</div>\n</div>\n<div ng-show=$ctrl.isFiltering class="emoji-container filtered">\n<div class=emoji-list-container>\n<div class=emoji-category>\n<div class=emoji-list>\n<div ng-repeat="emoji in $ctrl.filteredEmojis track by emoji.name" class=emoji-button tabindex=0 emoji-id="{{ :: emoji.name }}" db-tooltip="{{ :: emoji.name }}">\n<i class="twa twa-2x twa-{{::emoji.name}}" emoji-id="{{ :: emoji.name }}"></i>\n</div>\n</div>\n</div>\n</div>\n</div>\n<div class=emoji-category-menu ng-class="{\'filter-on\':$ctrl.isFiltering}">\n<bz-emoji-category-menu show-recent=$ctrl.showRecent current-emoji-category=$ctrl.currentEmojiCategory class=bz-emoji-category-menu select-category=$ctrl.selectCategory>\n</bz-emoji-category-menu>\n</div>\n</div>\n</db-popover>\n</div>'},1796:function(e,n,t){var a=t(8),i=t(81);angular.module("buzz").component("bzEmojiPickerButtonV2",{template:t(1797),bindings:{onEmojiSelected:"&",anchorSelector:"<?"},controller:["bzEmojiPickerService","$element","$attrs",function(e,n,t){function s(){c.openPicker=r,c.reactionPicker=i.has(t,"reactionIcon")}function o(e){var n=void 0;n=":"+e+":",c.onEmojiSelected({emoji:n})}function r(){var t=void 0,i=void 0;t=c.anchorSelector?a(c.anchorSelector).get(0):n.find(".emoji-anchor").get(0),i=".emoji-anchor",e.open(t,i,o).result.then(function(e){}).catch(function(e){})}var c=this;c.$onInit=s}]})},1797:function(e,n){e.exports='<span class=bz-emoji-picker-button-v2>\n<div class=emoji-anchor></div>\n<db-button theme=alt class=emoji-button ng-click=$ctrl.openPicker() tabindex=0>\n<i class="icon-smile _24" ng-if=::!$ctrl.reactionPicker></i>\n<i class=icon-smile-plus ng-if=::$ctrl.reactionPicker></i>\n</db-button>\n</span>'},1798:function(e,n,t){var a=t(8),i=function(){};angular.module("buzz").factory("bzEmojiPickerService",["$q","$rootScope","$timeout","$compile","bzEvents",function(e,n,t,s,o){function r(o,r,c){function d(e){c(e),v=e}function u(){h.resolve(v),p()}function p(){t(function(){b&&!b.$$destroyed&&b.$destroy()})}var h=void 0,g=void 0,m=void 0,b=void 0,v=void 0;return _.isFunction(c)||(c=function(){}),_.isUndefined(o)?e.reject("ERROR: Anchor element must be supplied"):_.isUndefined(r)?e.reject("ERROR: Anchor selector must be supplied"):(_.isUndefined(b)||b.$destroy(),h=e.defer(),g=a(l),a(o).append(g),b=n.$new(),b.data={open:!1,anchor:r,setSelectedEmoji:d},b.onClose=u,m=s(g)(b),t(function(){b.data.open=!0}),b.$on("$destroy",function(){m.remove(),m=void 0,b=void 0,v=void 0}),i=u,{result:h.promise})}function c(){i(),i=function(){}}var l='<bz-emoji-picker-v2 data="data" on-close="onClose" set-selected-emoji="data.setSelectedEmoji(emoji)"></bz-emoji-picker-v2>';return{open:r,close:c}}])},1799:function(e,n,t){var a=t(8);angular.module("buzz").directive("bzEmojiPicker",["$timeout","$compile","bzRootPath","bzStore","bzEmojiPickerPopoverService","bzMessageService",function(e,n,i,s,o,r){return{restrict:"E",scope:{label:"@",onSelect:"&",onCancel:"&",setCurrentlyTyping:"=?"},template:t(1800),transclude:!0,link:function(e,n,t){function i(){o.isOpen()&&o.close(),g.on("keydown",l),e.$on("$destroy",c)}function c(){g.off("keydown",l),o.destroy()}function l(n){13===n.which&&(e.$apply(function(){u()}),n.preventDefault(),n.stopPropagation())}function d(){r.setCurrentlyTyping(s.currentChannel.id,!0)}function u(){e.model.popoverOpen=!e.model.popoverOpen;
var i=n.parentsUntil("bz-message").last().parent();if(e.model.popoverOpen){i.addClass("show-meta");var c=s.currentChannel.type,l=o.open("#"+t.id+" "+h).then(function(n){"function"==typeof e.onSelect&&e.onSelect({emoji:":"+n+":"})},function(){"function"==typeof e.onCancel&&e.onCancel()});l.finally(function(){e.model.popoverOpen=!1,i.removeClass("show-meta"),e.setCurrentlyTyping&&"Topic"!==c&&"ObjectChat"!==c&&"Huddle"!==c&&(p.off("keydown",m),r.setCurrentlyTyping(s.currentChannel.id,!1))}).catch(function(e){console.error(e)}),e.setCurrentlyTyping&&"Topic"!==c&&"ObjectChat"!==c&&"Huddle"!==c&&(p=a("[emoji-search-input]"),p.on("keydown",m),r.setCurrentlyTyping(s.currentChannel.id,!0))}else o.close()}var p,h="[emoji-picker-button]",g=n.find(h),m=_.throttle(d,4e3,{trailing:!1});e.togglePopover=u,e.model={popoverOpen:!1},i()}}}])},1800:function(e,n){e.exports="<db-button theme=alt emoji-picker-button class=emoji-picker-button ng-class=\"{'active': model.popoverOpen}\" tabindex=0 ng-click=togglePopover() db-stopbubble=mouseup>\n<span ng-transclude></span>\n</db-button>\n"},1801:function(e,n,t){var a=t(8);angular.module("buzz").factory("bzEmojiPickerPopoverService",["$rootScope","$compile","$q","$timeout","$filter","emojis","dmI18n",function(e,n,t,i,s,o,r){function c(){return!(!C||_.isUndefined(C.showPopover))&&C.showPopover}function l(s,r){return r=r||{},w&&s!==y&&h(),w&&s===y||(w=t.defer()),y=s,C||(C=e.$new(),C.selectEmoji=m,C.filterEmojis=v,C.clearEmojiFilter=b,C.$watch("showPopover",function(e,n){!e&&n?(a(document).off(x),d()):e&&(i(function(){a("[emoji-search-input]").focus()}),a(document).on(x,f))})),C.label=r.label,C.popoverAnchor=s,C.showPopover=!0,k?e.safeApply():k=n(T)(C,function(e){var n=e.find(".emoji-list");n.on("click",z),g(o,n),e.appendTo(document.body)}),w.promise}function d(){b(),C.showPopover=!1,e.safeApply(),a(document).off(x),w&&(h(),w=null)}function u(){k&&k.find(".emoji-list").off("click",z),a(document).off(x)}function p(){C&&C.$destroy(),k&&k.remove(),w&&h(),C=null,k=null,w=null,y=null,u()}function h(e){e?w.resolve(e):w.reject(),w=null}function g(e,n){_.each(e,function(e){var t=M.replace(/{{emoji}}/gm,e);a(t).appendTo(n)})}function m(e){C.showPopover=!1,b(),h(e)}function b(e){C.filterText="",v(C.filterText),e&&a("[emoji-search-input]").focus()}function v(e){var n=s("filter")(o,e);k.find(".emoji-list [emoji-item]").each(function(e,t){var i=a(t),s=a(t).attr("emoji-item");i.toggle(_.contains(n,s))})}function f(e){if(27===e.which)return void d();var n=a("[emoji-item]:focus");13===e.which&&n.length&&(n.click(),e.preventDefault(),e.stopPropagation())}function z(e){var n=a(e.target).closest("[emoji-item]");n.length&&m(n.attr("emoji-item")),C.$apply()}var y,w,k,C,x="keydown.emojiPicker",T='<div class="popover bz-emoji-picker-popover" db-popover anchor="{{popoverAnchor}}" placement="top-right" self-close ng-show="showPopover"><div class="emoji-background"></div><div class="emoji-search"><div class="search-box emoji-search-field"><i class="icon-search"></i><input spellcheck="false" type="text" class="input" placeholder="'+r.get("buzz/search-emojis")+'" ng-model="filterText" ng-change="filterEmojis(filterText)" emoji-search-input><i class="clear-search icon-x-circle" ng-click="clearEmojiFilter(true)"></i></div></div><div>{{label}}</div><div class="emoji-list"></div></div>',M='<span class="emoji" emoji-item="{{emoji}}" title=":{{emoji}}:" tabindex="0"><i class="bz-emoji-sprite-{{emoji}}"></i></span>';return{close:d,destroy:p,isOpen:c,open:l}}])},1802:function(e,n){angular.module("buzz").directive("dynamicChatName",["bzRootPath","dmUserService","CurrentUserId",function(e,n,t){return{restrict:"E",template:"{{ dynamicTitle }}",scope:{title:"=originalTitle",accesses:"="},link:function(e,n){function a(){e.dynamicTitle=e.title,e.title||i(e.accesses)}function i(n){var t=s(n).slice(0,10);t=t.map(function(e){return e.DISPLAY.split(" ")[0]}),e.dynamicTitle=t.join(", ")}function s(e){return e.filter(function(e){return e.id!=t})}a()}}}])},1803:function(e,n){angular.module("buzz").directive("bzUserListItem",["bzRootPath","bzStates","bzEvents",function(e,n,t){return{restrict:"E",template:['<span ng-if="type === \'GROUP\'" class="image" dm-avatar-group-widget="id" size="micro"></span>','<span ng-if="type !== \'GROUP\'" class="image" dm-avatar-widget="{{ id }}" size="micro" show-status="true"></span>',"<span class=\"bz-text-body bz-text-overflow\" ng-class=\"{'bold': isAdmin === 'true'}\">{{ name }}</span>","<ng-transclude></ng-transclude>"].join(""),scope:{id:"@",type:"@?",name:"@",isAdmin:"@?"},transclude:!0,link:function(e,n,t){}}}])},1804:function(e,n,t){angular.module("buzz").directive("bzUserListPreview",["bzRootPath","bzEvents","bzStore","bzHelpers","bzService","bzPeopleHelper","dmI18n","bzModals","$filter","$q","Analytics",function(e,n,a,i,s,o,r,c,l,d,u){var p=10;return{restrict:"E",template:t(1805),scope:{},link:function(e,t,h){function g(){m(),b(),v(),a.currentChannel.id&&f()}function m(){x.push(n.channelChange.on(f)),x.push(n.refreshChannelAccess.on(y)),e.$on("$destroy",function(){_.each(x,function(e){e()})})}function b(){_.has(h,"maxUsers")||isNaN(+h.maxUsers)?e.maxUsers=p:e.maxUsers=+h.maxUsers,e.channel={},e.users=[],e._groups=[],e.loading=!0,e.openViewAllModal=w,e.onUserRemove=z}function v(){e.i18n={removeFromConversation:r.get("buzz/remove-from-conversation"),groups:r.get("admin/groups-title")}}function f(){if(e.channel.id!==a.currentChannel.id){var n;e.channel=a.currentChannel,e.showRemove=o.shouldShowRemoveForChannel(e.channel),e.showViewMore=!1,e.loading=!0,e.showGroups=o.shouldShowGroupList(e.channel),n=e.channel.inheritPermissions?i.getChannelUsersType(e.channel.parentChannel):i.getChannelUsersType(e.channel),n.then(function(n){e.peopleListType=n,y()})}}function z(n){o.removeUserFromChannel(n.user,e.channel)}function y(){var n={params:{offset:0,limit:e.maxUsers}};"Access"===e.peopleListType?s.getUsersWithAccessToChannel(e.channel.id,n).then(k):"Pin"===e.peopleListType&&s.getPinnedUsersForChannel(e.channel.id,n).then(k)}function w(){u.track("buzz_view_people_with_access"),c.open("viewAllUsers")}function k(t){e.users=o.processPeople(t,e.channel.type),e.showViewMore=t.total>e.maxUsers,e.peopleCount=l("number")(t.total),e.i18n.viewAll=r.get("buzz/view-all-count",{count:e.peopleCount}),n.updatePeopleCount.trigger(t.total),C().then(function(){e.loading=!1})}function C(){var n=d.defer();return e.showGroups?o.getGroupsForChannel(e.channel).then(function(t){e._groups.length=0,_.forEach(t,function(n){e._groups.push(n)}),n.resolve()}):(e._groups.length=0,n.resolve()),n.promise}var x=[];g()}}}])},1805:function(e,n){e.exports='<div>\n<ul class=people-list ng-if=!loading>\n<li ng-repeat="user in users |limitTo:mainListUserMax track by user.id">\n<bz-user-list-item id="{{ user.id }}" type="{{ user.type }}" name="{{ user.DISPLAY }}">\n<div class=admin-actions ng-if=" user.hasRemove && showRemove">\n<i ng-click="onUserRemove({user: user})" class=icon-x db-tooltip={{::i18n.removeFromConversation}} db-tooltip-placement=left></i>\n</div>\n</bz-user-list-item>\n</li>\n<li ng-if=showViewMore>\n<div class="margin-top-small padding-left-medium block view-more-users-link">\n<a ng-click=openViewAllModal()>{{ i18n.viewAll }}</a>\n</div>\n</li>\n</ul>\n<div ng-if=loading class="text-align-center block">\n<span class="spinner medium"></span>\n</div>\n<div class=group-list-wrapper ng-if="showGroups && _groups.length && !loading">\n<div class="accordion-header accordion-title bz-text-display-6 bold">\n{{ :: i18n.groups }}\n</div>\n<div class=scroll-list>\n<ul class=people-list>\n<li ng-repeat="_group in _groups track by _group.id" class=bz-user-list-group-item>\n<span class=image dm-avatar-group-widget=_group size=micro show-group-name>\n</span>\n<div class=admin-actions>\n<i ng-if="showRemove " ng-click=onUserRemove({user:_group}) class=icon-x db-tooltip={{::i18n.removeFromConversation}} db-tooltip-placement=left></i>\n</div>\n</li>\n</ul>\n</div>\n</div>\n<div ng-if="peopleListType === \'Pin\'">\n<div class="bz-text-label secondary padding-left-medium margin-top-xlarge margin-bottom-xxsmall" dm-i18n=buzz/people-who-have-access></div>\n<span class="bz-text-caption secondary padding-left-medium" dm-i18n=buzz/public-channel></span>\n</div>\n</div>'},1806:function(e,n){angular.module("buzz").factory("bzPeopleHelper",["bzService","$q","bzModals","bzStore","dmCachedGroups","CurrentUserId",function(e,n,t,a,i,s){function o(e,n){var t;return _.has(e,"userPermissions")?t=l(e):_.has(e,"pinnedUserIds")&&(t=d(e,n)),v(t,e.userPermissions||[]),_.isUndefined(t)||null===t?null:t.map(function(e){return g(e)})}function r(e){return"ObjectChat"!==e.type&&"DirectChat"!==e.type&&!("Huddle"===e.type&&e.inheritPermissions)&&("Topic"!==e.type||e.isPrivateChannel())}function c(e){return"GroupChat"===e.parentChannel.type||e.isPrivateThread()||e.isPrivateChannel()}function l(e){var n,t;return _.isUndefined(e.userPermissions)||!e.userPermissions.length?null:(n=_.map(e.userPermissions,function(e){return e.id}),t=u(n,e.properties))}function d(e,n){var t,a;return _.isUndefined(e.pinnedUserIds)&&_.isUndefined(e.userPermissions)?null:("Topic"===n||"Huddle"===n||"ObjectChat"===n?t=e.pinnedUserIds:"GroupChat"!==n&&"DirectChat"!==n||(t=_.map(e.userPermissions,function(e){return e.id})),a=u(t,e.properties))}function u(e,n){var t,a,i=[];return _.forEach(e,function(e){t=n["USER:"+e],t&&(a=_.extend(_.clone(t),{id:e}),i.push(a))}),i}function p(i,o){var r,c,l=[{id:i.id,permission:"NONE",type:i.type}],d=n.defer(),u=o.isPrivateChannel();return t.open("removeUser",{userToRemove:i,onRemove:function(){"Huddle"!==o.type||o.inheritPermissions?"GroupChat"===o.type?(r=o.parentChannel.id,c=e.updateChatAccesses):(r=o.parentChannel.id,c=e.inviteToTopic):(r=o.id,c=e.updateTopicAccesses),c(r,l,u).then(function(){"Huddle"!==o.type&&(a.channels[r].accesses=a.channels[r].accesses.filter(function(e){return i.id+""!=e.id+""})),d.resolve(!0)}).finally(function(){"Huddle"!==o.type||o.inheritPermissions||i.id==s&&a.deleteThread(o.channelId,o.id)}).catch(function(e){console.error(e)}),t.close("removeUser")},onCancel:function(){d.resolve(!1),t.close("removeUser")}}),d.promise}function h(n){return e.getGroupChatAccesses(n.id).then(function(e){var n=e.data.filter(function(e){return!_.isUndefined(e)&&"GROUP"===e.type}).map(function(e){return e.id});return i.getByIds(n).then(function(e){return e.filter(function(e){return!_.isUndefined(e)}).map(m)})})}function g(e){return _.extend(e,{type:"USER",displayName:e.DISPLAY,avatarKey:e.AVATAR_KEY})}function m(e){return _.extend(e,{DISPLAY:e.displayName,type:"GROUP"})}function b(n,t,a){var i={};return"users"==a?i.users=!0:"groups"==a&&(i.groups=!0),e.searchUsersGroupsOnCard(t,n,i)}function v(e,n){_.forEach(e,function(t,a){e[a].hasRemove=!(!n[a]||!n[a].permissionSources)&&!_.find(n[a].permissionSources,{type:"GROUP"})})}return{processPeople:o,parseUserPropertyMap:u,shouldShowRemoveForChannel:r,shouldShowGroupList:c,removeUserFromChannel:p,getGroupsForChannel:h,getUsersOrGroupsForPrivateHuddle:b}}])},1807:function(e,n,t){angular.module("buzz").directive("bzInviteUsersModal",["bzStates","bzRootPath","bzService","bzEvents","bzStore","bzModals","Analytics","$q","bzPeopleHelper",function(e,n,a,i,s,o,r,c,l){return{restrict:"E",template:t(1808),scope:{privateProject:"=?"},link:function(e,n,t){function c(){u(),_.has(t,"isPublicChannel")&&(x=!0),e.users={},e.users.users=[],e.users.groups=[],e.users.admins=[],e.filtered={users:[],groups:[]},e.channel=s.currentChannel,e.company=s.company,e.inviteErrorCode=200,e.parentIsGroupChat="Huddle"===e.channel.type&&e.channel.parentChannel.isGroupChat(),e.inviteUsers=p,e.cancel=g,e.disabled=h,e.focusInput=u,e.remove={waiting:!1},e.filterGroupChatUsers=y,e.filterGroupChatGroups=w,e.$on("$destroy",i.channelChange.on(d))}function d(){e.channel=s.currentChannel}function u(){setTimeout(function(){C||(C=n.find("input[db-autogrow-input]")),C.focus()},100)}function p(){x?r.track("buzz_user_invited_to_channel",{channel_id:e.channel.id,channel_type:e.channel.type}):r.track("buzz_user_invited_to_conversation",{channel_id:e.channel.id,channel_type:e.channel.type}),z()}function h(){return 0===e.users.users.length&&0===e.users.groups.length||200!=e.inviteErrorCode||e.remove.waiting}function g(){x?o.close("inviteToPublicChannel"):o.close("inviteToChannel")}function m(n,t){for(var a=[],i="groups"!==n?"USER":"GROUP",s=0;s<e.users[n].length;s++){var o=e.users[n][s];a.push({type:i,id:o,permission:t})}return a}function b(n,t,i){var o,r,c;return r=e.channel.objectType||s.channels[e.channel.channelId].objectType,c=e.channel.objectId||s.channels[e.channel.channelId].objectId,o=a.inviteToObjectChat(c,r,i),"Huddle"!==e.channel.type||e.channel.inheritPermissions||(o=o.then(function(n){return a.inviteToHuddle(e.channel.id,i)})),o}function v(n){return a.inviteToHuddle(e.channel.id,n)}function f(n){var t,i,s,o="Huddle"===e.channel.type&&e.channel.inheritPermissions,r="Huddle"===e.channel.type&&!e.channel.inheritPermissions;return r?t=a.inviteToHuddle(e.channel.id,n):(i=o?e.channel.parentChannel.id:e.channel.id,s="NONE"===e.channel.publicPermission,t=a.inviteToTopic(i,n,s)),t}function z(){var n,t=m("users",null),i=m("groups",null),s=t.concat(i);e.remove.waiting=!0,n=e.channel.parentChannel.isObjectChannel()?b(t,i,s):e.channel.isThread()&&e.channel.parentChannel.isGroupChat()?v(s):x?f(s):a.updateChatAccesses(e.channel.id,s),n.then(function(){g()}).catch(function(n){e.inviteErrorCode=n.status,e.remove.waiting=!1})}function y(e,n){k(e,n,"users")}function w(e,n){k(e,n,"groups")}function k(n,t,a){var i=e.parentIsGroupChat?e.channel.parentChannel.id:e.channel.id;l.getUsersOrGroupsForPrivateHuddle(i,n,a).then(function(e){t.resolve(e)})}var C,x=!1;c()}}}])},1808:function(e,n){e.exports='<db-modal-header>\n<div class=bz-text-display-4 dm-i18n=buzz/add-someone></div>\n</db-modal-header>\n<db-modal-body>\n<div ng-if="inviteErrorCode == 200">\n<p class=bz-text-body dm-i18n=buzz/have-someone-join-conversation ng-if=!channel.parentChannel.isObjectChannel()></p>\n<p class=bz-text-body dm-i18n key=buzz/have-someone-join-conversation-object data="{title: channel.parentChannel.title}" ng-if=channel.parentChannel.isObjectChannel()></p>\n<div class="user-input margin-bottom-xxsmall" ng-if=!privateProject dm-user-select show-defaults-on-focus=false no-results-message=false multi-select=true groups=users.groups users=users.users avatar-click-off=true on-change=focusInput() allow-at-mention=true>\n</div>\n<div class="user-input margin-bottom-xxsmall" ng-if=privateProject dm-user-select show-defaults-on-focus=false no-results-message=false multi-select=true users=users.users avatar-click-off=true on-change=focusInput() allow-at-mention=true>\n</div>\n</div>\n<div class=invite-error ng-if="inviteErrorCode == 403">\n<div class=invite-error-icon><i class="icon-exclamation-triangle _24"></i></div>\n<div class="invite-error-text bz-text-body" dm-i18n=buzz/do-not-have-permission></div>\n</div>\n</db-modal-body>\n<db-modal-footer>\n<db-modal-buttons>\n<span ng-if=remove.waiting>\n<span class="spinner small"></span>\n</span>\n<db-button size=large ng-disabled=disabled() ng-click=inviteUsers() theme=primary dm-i18n=buzz/add-users></db-button>\n<db-button ng-click=cancel() theme=alt size=large dm-i18n=buzz/cancel></db-button>\n</db-modal-buttons>\n</db-modal-footer>\n'},1809:function(e,n,t){angular.module("buzz").directive("bzInvitedOrMentioned",["bzRootPath","dmUserService","$timeout",function(e,n,a){return{restrict:"E",template:t(1810),scope:{channel:"="},link:function(e,t,a){var i=e.$watch("channel.messages",function(){e.channel.messages&&e.channel.messages[0]&&(e.channel.messages[0].createdBy?e.fromName=e.channel.messages[0].createdBy.displayName:n.getUser(e.channel.messages[0].createdById).then(function(n){e.fromName=n.displayName}),i())})}}}])},1810:function(e,n){e.exports="<span ng-if=channel.invited class=bz-text-invite>\n<span dm-i18n=buzz/you-were-invited></span>\n</span>\n"},1811:function(e,n,t){t(1812);var a=t(47);angular.module("buzz").directive("bzHuddleMessage",["bzRootPath","bzStore","CurrentUserId","dmUserService","bzModals","bzService","bzChannel","bzHelpers","dmI18n","jstz",function(e,n,i,s,o,r,c,l,d,u){return{restrict:"E",scope:{message:"=",showDate:"="},template:t(1814),link:function(e,t,i){function o(e){if("SYSTEM"===e.messageType)return"system-message bz-text-italics"}function r(){return!!e.message.channelId&&void n.setCurrentThread(e.message,null,null,!0)}function c(e){return l.tagClickHandler(e,t)}var p=u.determine().name();e.dateFormat=e.showDate?d.get("date-formats/month-day-time"):"LT",e.showFullMessage=!1,e.drillToTopic=r,e.tagClickHandler=c,e.getMarkupClasses=o,e.$watchCollection("message.messages",function(){e.message.messages&&e.message.messages.length&&(e.displayTimestamp=a(e.message.messages[0].created).format(e.dateFormat))}),e.$watchCollection("message.accesses",function(){if(e.message.accesses){var n=[],t=[];e.message.accesses.forEach(function(e){"USER"==e.type&&n.push(e),"GROUP"==e.type&&t.push(e)}),e.users=n,e.groups=t,e.totalUGLength=n.length+t.length}}),e.explicitDate=a(e.message.lastUpdated).tz(p).format("LLL z"),e.displayMessage=e.message.messages?e.message.messages[0]:null,e.displayMessage&&e.displayMessage.createdById&&"USER"===e.displayMessage.createdByType&&s.getUser(e.displayMessage.createdById).then(function(n){e.displayUser=n})}}}])},1812:function(e,n,t){var a=t(1813);"string"==typeof a&&(a=[[e.id,a,""]]);var i,s={};s.transform=i;t(3)(a,s);a.locals&&(e.exports=a.locals)},1813:function(e,n){e.exports="bz-huddle-message{display:block;padding:8px 0}bz-huddle-message .message-container{margin-left:10px;margin-right:10px;display:-webkit-box;display:-ms-flexbox;display:flex;cursor:pointer}bz-huddle-message .message-container .thread-icon{margin-right:8px}bz-huddle-message .message-container .thread-icon i{padding-top:6px;display:block;height:34px;width:40px;border:2px solid #9ce;color:#9ce;border-radius:50%}bz-huddle-message .message-container .thread-icon span{display:block;color:#9ce}bz-huddle-message .message-container .header{position:relative}bz-huddle-message .message-container .header .huddle-title{font-weight:600;color:rgba(0,0,0,0.8);font-size:14px;margin-bottom:4px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}bz-huddle-message .message-container .header .thread-type,bz-huddle-message .message-container .header .unread-messages{color:rgba(0,0,0,0.6)}bz-huddle-message .message-container .header i{font-size:14px;opacity:0.6}bz-huddle-message .message-container .header .separator{font-size:12px;color:rgba(0,0,0,0.6)}bz-huddle-message .message-container .header .important-notification{background:#e4584f;border-radius:50%;color:#ffffff;display:block;position:absolute;top:0;right:0;text-align:center;font-size:12px;font-weight:bold;height:18px;min-width:18px;box-sizing:border-box}bz-huddle-message .message-container .container{border:1px solid #dcedf8;-webkit-box-flex:2;-ms-flex-positive:2;flex-grow:2;padding:12px 16px 16px 18px;border-radius:4px;background:#F2F8FC;overflow:hidden}bz-huddle-message .message-container .container hr{border-color:rgba(153,204,238,0.6)}bz-huddle-message .message-container .container .message{display:-webkit-box;display:-ms-flexbox;display:flex;margin-top:8px}bz-huddle-message .message-container .container .message .avatar{margin-right:8px}bz-huddle-message .message-container .container .message .message-body{width:100%;overflow:auto}bz-huddle-message .message-container .container .message .message-body .user-timestamp{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;margin-bottom:8px}bz-huddle-message .message-container .footer{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;margin-top:12px}bz-huddle-message .message-container .footer .db-button{color:#4b87b0;border:1px solid #dcedf8}\n"},1814:function(e,n){e.exports='<div class="message-container huddle" ng-class="{\'old-buzz\': message.migratedFromV2, \'greyed-out\':!message.channelId }" ng-switch=!!message.migratedFromV2 ng-click=drillToTopic()>\n<div class=thread-icon>\n<i class="icon-chat-bubble-lines md"></i>\n<span class=bz-text-label dm-i18n=buzz/huddle></span>\n</div>\n<div class=container>\n<div class=header>\n<div class=huddle-title>{{message.title}}</div>\n<div>\n<i ng-class="{\'icon-lock-open\': message.inheritPermissions, \'icon-lock-closed\': !message.inheritPermissions}"></i>\n<span class="bz-text-caption thread-type secondary">\n<span ng-if=message.inheritPermissions dm-i18n=buzz/public-huddle></span>\n<span ng-if=!message.inheritPermissions dm-i18n=buzz/private-huddle></span>\n</span>\n<span class=separator ng-if=message.unreadCounts.messages> • </span>\n<span class="bz-text-caption unread-messages secondary" ng-if=message.unreadCounts.messages dm-i18n=buzz/unread-messages-count data="{count: message.unreadCounts.messages}"></span>\n</div>\n<div class=important-notification ng-if=message.importantCounts.messages>{{message.importantCounts.messages}}</div>\n</div>\n<hr/>\n<div class=body>\n<span class="bz-text-label secondary" dm-i18n=buzz/most-recent-message-colon></span>\n<div class=message>\n<div class="avatar bz-avatar" dm-avatar-widget="{{ message.messages[0].createdBy.id }}" size=large></div>\n<div class=message-body>\n<div class=user-timestamp>\n<span class=font-weight-semi-bold>{{message.messages[0].createdBy.displayName}}</span>\n<span class="bz-text-caption secondary">{{displayTimestamp}}</span>\n</div>\n<div>\n<bz-markup-renderer ng-class=getMarkupClasses(message) content=message.messages[0].content tag-click-handler=tagClickHandler>\n</bz-markup-renderer>\n<bz-attachment class=quote-attachment prevent-click-events=true message-id=message.id attachment=attachment layout=expanded ng-repeat="attachment in message.messages[0].attachments"></bz-attachment>\n</div>\n</div>\n</div>\n</div>\n<div class=footer>\n<div class=avatars>\n<dm-avatar-cluster users=users groups=groups limit=4 total-items-count=totalUGLength ng-if=!message.inheritPermissions></dm-avatar-cluster>\n</div>\n<db-button><span dm-i18n=buzz/reply></span></db-button>\n</div>\n</div>\n</div>'},1815:function(e,n,t){var a=t(47),i=t(1493);angular.module("buzz").directive("bzSidePane",["bzRootPath","bzService","bzMessageService","bzHelpers","bzEvents","bzStates","CurrentUserId","bzStore","bzModals","dmI18n","Analytics","$location","Auth","authorities","$filter","features","dmSocialUserService","bzMessage","jstz","$q","$ocLazyLoad","buzzContainerService",function(e,n,s,o,r,c,l,d,u,p,h,g,m,b,v,f,z,y,w,k,C,x){return{restrict:"E",replace:!0,template:t(2354),scope:{},link:function(e,t){function T(){M(),ce.push(r.channelChange.on(E)),ce.push(r.currentChannelUpdated.on(D)),ce.push(r.favoriteMessage.on(P)),ce.push(r.messageUpdated.on(P)),ce.push(r.myMessageUpdated.on(P)),ce.push(r.updatePeopleCount.on($)),d.currentChannel.id&&(E(),J()),e.$on("$destroy",function(){_.each(ce,function(e){e()})})}function M(){e.vm.i18n={details:p.get("buzz/details"),notificationSettings:p.get("buzz/notification-settings"),bots:p.get("buzz/bots"),favorite:p.get("buzz/add-as-favorite"),unfavorite:p.get("buzz/unfavorite"),pinToBuzz:p.get("buzz/pin-to-buzz"),unpinToBuzz:p.get("buzz/unpin-to-buzz"),favoritedMessages:p.get("buzz/favorited-messages"),people:p.get("common/people"),startedConversationOn:p.get("buzz/started-conversation-on"),conversationStartedOn:p.get("buzz/conversation-started-on"),addTitle:p.get("buzz/add-a-title"),addDescription:p.get("buzz/add-a-description"),botsTooltip:p.get("buzz/bots-tooltip"),favoriteConversationTooltip:p.get("buzz/favorite-conversation-tooltip"),favoritedMessagesTooltip:p.get("buzz/favorited-messages-tooltip"),pinConversationTooltip:p.get("buzz/pin-conversation-tooltip"),unfollowConversationTooltip:p.get("buzz/unfollow-conversation-tooltip"),unfavoriteConversationTooltip:p.get("buzz/unfavorite-conversation-tooltip"),confirm:p.get("buzz/confirm"),relatedConversations:p.get("buzz/related-conversations"),relatedConversationsTooltip:p.get("buzz/related-conversations-tooltip"),attachments:p.get("buzz/attachments"),search:p.get("search"),searchChannelTooltip:p.get("buzz/search-channel-tooltip"),searchChatTooltip:p.get("buzz/search-chat-tooltip")}}function I(){return e.channel.isObjectChannel()||"OBJECT_CHAT"===e.channel.parentChannelType?p.get("buzz/channel"):p.get("buzz/chat")}function $(n){e.accordianCounts.people=v("number")(n)}function A(n){e.accordianCounts.attachments=n&&n.length}function S(n){e.accordianCounts.bots=n&&n.length}function P(n){var t=n.huddleId||n.channelId;t===e.channel.id&&e.favorites&&Y(n)}function E(){D(),O(),L(),ie(),J(),e.canDelete=B(),e.canMakeThreadPublic=G(),e.vm.i18n.makeThreadPublicTooltip=p.get("buzz/make-thread-public-tooltip",{type:I()}),e.vm.i18n.makeThreadPublicBody=p.get("buzz/make-thread-public-body",{type:U()});var t=e.channel.objectType;"ObjectChat"===e.channel.type&&"PROJECT"!==t&&n["CARD"===t?"getCardObject":"getPageObject"](e.channel.objectId).then(function(n){var t=n.length?n[0]:n,a=!t.locked||t.locked&&t.ownerId===l||b.on("cards.admin")||m.permission("CAN_EDIT_ANY_CARD");e.inviteToIndividualTopic=e.inviteToIndividualTopic&&a}),e.peopleListType=e.channel.inheritPermissions?o.getChannelUsersType(d.channels[e.channel.id]||d.channels[e.channel.channelId]):o.getChannelUsersType(e.channel),e.inviteToIndividualTopic=e.channel.isChannel()||e.channel.isObjectChannel()||e.channel.isThread()&&"DirectChat"!==e.channel.parentChannel.type&&!(e.channel.isPublicThread()&&"GroupChat"===e.channel.parentChannel.type),e.inviteToIndividualTopic=e.inviteToIndividualTopic&&(!z.isSocialUser()||z.isSocialUser()&&"ObjectChat"!=e.channel.parentChannel.type),e.channel.isThread()&&e.channel.parentChannel.isObjectChannel()?e.hasInvitePermission=b.on("content.card.edit"):e.channel.isObjectChannel()&&"PROJECT"!==e.channel.objectType?e.hasInvitePermission=b.on("content.card.edit"):e.hasInvitePermission=e.inviteToIndividualTopic,e.peopleTotal=e.accordianCounts.people=null}function O(){e.channel.isObjectChannel()?e.vm.i18n.created=_.unescape(p.get("buzz/created-on",{date:a(e.channel.created).format("ll")})):o.getChannelCreator(e.channel.createdById).then(function(n){e.vm.i18n.created=_.unescape(p.get("buzz/created-by",{user:n.displayName,date:a(e.channel.created).format("ll")}))})}function U(){switch(e.channel.normalizedNotificationType){case"channels":return p.get("buzz/channel");case"chats":return p.get("buzz/chat")}}function D(){e.channel=d.currentChannel}function R(){n.pinChannel(e.channel).then(function(){e.isPinned=!0})}function j(){n.unpinChannel(e.channel).then(function(){e.isPinned=!1})}function L(){var n=b.on("buzz.admin"),t=l===+e.channel.createdById;e.updateAccess="GroupChat"===e.channel.type||"Topic"===e.channel.type&&(n||t)||"Huddle"===e.channel.type}function N(){("Topic"!==e.channel.type||e.updateAccess)&&("Huddle"===e.channel.type?n.updateHuddle(e.channel.id,{title:e.channel.title,description:e.channel.description}):"Topic"===e.channel.type?n.updateChannel(e.channel.id,{title:e.channel.title,description:e.channel.description}):n.updateGroupChat(e.channel.id,{title:e.channel.title,description:e.channel.description}))}function F(){e.channel.favoritePosition>=0?h.track("'buzz_details_unfavorite_conversation"):h.track("buzz_details_favorite_conversation"),e.channel.toggleFavorite()}function H(e){u.open("deleteChannel",{channel:e})}function B(){return(b.on("buzz.admin")||+e.channel.createdById===+l)&&("Topic"==e.channel.type&&e.channel.title!=re||"Huddle"==e.channel.type)}function G(){return e.channel.isPrivateThread()&&(b.on("buzz.admin")||+e.channel.createdById===+l)&&!e.channel.parentChannel.isDirectChat()}function V(t){e.makingThreadPublic=!0;var a={inheritPermissions:!t.inheritPermissions};n.toggleThreadPermissions(t.id,a).then(function(n){r.refreshChannelAccess.trigger(),q(),e.canMakeThreadPublic=!1,e.makingThreadPublic=!1})}function q(){e.showMakePublicPopover=!e.showMakePublicPopover}function W(){var n={entity:JSON.stringify({field:"_type",value:"buzz,buzz_channel",facetType:null,count:1}),facets:JSON.stringify({field:"channel_title",value:e.channel.parentChannelTitle||e.channel.title,facetType:"SearchFacetValue",filterType:"term"})};"DirectChat"!==e.channel.type&&"DIRECT_CHAT"!==e.channel.parentChannelType||(n.facets=JSON.stringify({field:"message_from_id",value:e.channel.themId,facetType:"user",filterType:"term",label:_.findWhere(e.channel.accesses,{id:e.channel.themId}).DISPLAY})),g.path("/search"),g.search({entity:n.entity,facets:n.facets}),x.toggleFullscreen(!1)}function Y(n){var t=_.findWhere(e.favorites,{id:n.id});n.showCreator=!0,t?(t=_.extend(t,n),t.favorited&&"SYSTEM"!==t.messageType||e.favorites.splice(e.favorites.indexOf(t),1)):n.favorited&&"SYSTEM"!==n.messageType&&(h.track("buzz_favorite_message",{channel_id:e.channel.id,channel_type:e.channel.type}),e.favorites.push(n)),_.defer(function(){e.$digest()})}function J(){s.getFavorites(e.channel.id,{type:e.channel.type}).then(function(n){var t=y.fromServer(n.messages,n.me,n.properties);e.favorites=_.filter(t,function(e){return e.showCreator=!0,"SYSTEM"!==e.messageType||e.viaId})})}function K(e){g.path("/buzz-link/"+e.channelId+"/"+e.id),c.messages()}function Z(n){n&&n.urn&&(m.SOCIAL_USER&&h.track("social_card_click_in_buzz",{channel_id:e.channel.id,channel_type:e.channel.type}),r.cardMentionClicked.trigger({cardId:n.urn}))}function Q(){e.channel.isDirectChat()?e.doConvertToGroup():e.inviteToIndividualTopic?e.inviteToPublicChannel():e.channel.parentChannel.isGroupChat()&&e.inviteToChannel()}function X(){u.open("inviteToChannel").then(function(){ne()})}function ee(){u.open("inviteToPublicChannel",{privateProject:le}).then(function(){ne()})}function ne(){e.peopleListType.then(function(n){r.refreshChannelAccess.trigger(e.channel)})}function te(){var n="inviteToDirect";e.channel.getUsersWithAccess().then(function(e){var t=_.pluck(e,"id");u.open(n,{users:t,onStart:function(){u.close(n),ae(t)},onCancel:function(){u.close(n)}})})}function ae(e){var n="createChat";e=_.filter(e,function(e){return e!=""+l}),u.open(n,{populatedUsers:e})}function ie(){le=!1,e.channel.parentChannel.isProjectChannel()&&e.channel.parentChannel.isPrivateProjectChannel().then(function(e){le=e})}function se(){u.open("shareLink",{channel:e.channel})}function oe(){var e=this,n=void 0;return n=this.hasLoaded?k.when(!0):i.directLazyLoad("configwizard",k,C).then(function(){return e.hasLoaded=!0,!0},function(){return!1})}oe().then(function(){e.cwLoaded=!0});var re="General",ce=[],le=!1;w.determine().name();e.channel={},e.accordions={details:!0,notifications:!1,bots:!1,people:!0},e.peopleTotal=null,e.peopleListType=null,e.modals=u.modalRefs,e.accordianCounts={attachments:void 0,bots:void 0,favorites:void 0,people:void 0},e.inviteToIndividualTopic=!1,e.huddleParentType=void 0,e.canDelete=!1,e.canMakeThreadPublic=!1,e.showMakePublicPopover=!1,e.makingThreadPublic=!1,e.hasInvitePermission=!1,e.relatedConversations={},e.relatedConversations.channelCount=0,e.pin=R,e.unpin=j,e.inviteToChannel=X,e.inviteToPublicChannel=ee,e.onFavoritesOpen=J,e.channelDetailsUpdate=N,e.favoriteClick=K,e.showBadgeModal=Z,e.toggleChannelFavorite=F,e.doConvertToGroup=te,e.deleteChannel=H,e.makeThreadPublic=V,e.toggleMakePublicPopover=q,e.handleInvite=Q,e.showShareLinkModal=se,e.onAttachmentsUpdated=A,e.onBotsUpdated=S,e.searchChannel=W,e.updateAccess=!1,e.botsEnabled=f.on("bots"),e.inChannelSearch=f.on("buzz-channel-search"),e.vm={},T()}}}])},2354:function(e,n){e.exports='<div class="bz-side-pane pane">\n<div class=pane-body>\n<bz-side-accordion class=details accordion-title={{::vm.i18n.details}} default-open=true>\n<span class=display-card ng-if="channel.objectType === \'CARD\' || channel.parentObjectType === \'CARD\'">\n<dm-badge class=card-section badge="channel.objectId || channel.parentObjectId" size=medium interactive=false frame=true header=true footer=false gear-menu=false details-link=true click-handler=showBadgeModal(model)></dm-badge>\n</span>\n<div class=margin-bottom-xxsmall ng-if="channel.type === \'Huddle\' || channel.objectType !== \'CARD\'">\n<div class="details-label bz-text-body secondary" dm-i18n=buzz/title></div>\n<span ng-class="{unlocked: updateAccess}">\n<span class="bz-text-edit bz-text-body" ng-if="(channel.objectType !== \'PAGE\' || (channel.objectType !== \'PAGE\' && channel.type === \'Huddle\'))" live-edit text=channel.title save=channelDetailsUpdate() noedit=!updateAccess placeholder={{::vm.i18n.addTitle}}></span>\n<span class=bz-text-body ng-if="channel.objectType === \'PAGE\'">{{channel.title}}</span>\n</span>\n</div>\n<div class=margin-bottom-xxsmall ng-if="channel.type !== \'DirectChat\' && channel.type !== \'ObjectChat\'">\n<div class="details-label bz-text-body secondary" dm-i18n=buzz/description></div>\n<span class=bz-text-edit ng-class="{unlocked: updateAccess}">\n<span class="bz-text-edit bz-text-body" live-edit text=channel.description save=channelDetailsUpdate() noedit=!updateAccess placeholder={{::vm.i18n.addDescription}}></span>\n</span>\n</div>\n<div ng-if="channel.type !== \'DirectChat\'" class="details-label italics bz-text-body secondary">{{vm.i18n.created}}</div>\n<div ng-if="channel.type !== \'DirectChat\'">\n<br/>\n<div class=channel-actions>\n<span ng-if=::inChannelSearch class=action-link>\n<i class="icon-search left-icon"></i>\n<a ng-click=searchChannel()>{{::vm.i18n.search}}</a>\n<i class="icon-question-circle info-icon" db-tooltip={{vm.i18n.searchChannelTooltip}} db-tooltip-max-width=400></i>\n</span>\n<span class=action-link>\n<i class="icon-chain-linked left-icon"></i>\n<a ng-click=showShareLinkModal() dm-i18n=buzz/share-link></a>\n</span>\n<span ng-if="channel.favoritePosition < 0 && channel.isFirstClassChannel" class=action-link>\n<i class="icon-star-outline left-icon"></i>\n<a ng-click=toggleChannelFavorite()>{{::vm.i18n.favorite}}</a>\n<i class="icon-question-circle info-icon" db-tooltip={{vm.i18n.favoriteConversationTooltip}} db-tooltip-max-width=400></i>\n</span>\n<span ng-if="channel.favoritePosition >= 0 && channel.isFirstClassChannel" class=action-link>\n<i class="icon-star left-icon"></i>\n<a ng-click=toggleChannelFavorite()>{{::vm.i18n.unfavorite}}</a>\n<i class="icon-question-circle info-icon" db-tooltip={{vm.i18n.unfavoriteConversationTooltip}} db-tooltip-max-width=400></i>\n</span>\n<span ng-if=canMakeThreadPublic class=action-link>\n<div class=bz-make-thread-public-anchor>\n<db-popover class=popover ng-show=showMakePublicPopover placement=left-center self-close=true>\n<div class=popover-arrow></div>\n<div>\n<span class="bz-text-display-6 bold" dm-i18n=buzz/make-public></span>\n</div>\n<div class=bz-make-thread-public-body>\n<span>{{vm.i18n.makeThreadPublicBody}}</span>\n</div>\n<div class=bz-make-thread-public-actions>\n<div class="spinner medium" ng-if=makingThreadPublic></div>\n<db-button theme=alt ng-click=toggleMakePublicPopover()><span dm-i18n=cancel></span></db-button>\n<db-button theme=primary ng-click=makeThreadPublic(channel);><span dm-i18n=buzz/confirm></span></db-button>\n</div>\n</db-popover>\n</div>\n<i class="icon-megaphone left-icon"></i>\n<a ng-click=toggleMakePublicPopover() dm-i18n=buzz/make-public></a>\n<i class="icon-question-circle info-icon" db-tooltip={{vm.i18n.makeThreadPublicTooltip}}></i>\n</span>\n<span ng-if=canDelete class=action-link>\n<i class="icon-trash left-icon"></i>\n<a ng-click=deleteChannel(channel) dm-i18n=buzz/delete></a>\n</span>\n<span ng-if=channel.isFirstClassChannel class=action-link>\n<span ng-if="!channel.pin || (channel.pin && channel.invited)">\n<i class="icon-plus-circle-outline left-icon"></i>\n<a ng-click=pin() class=width-100 dm-i18n=buzz/follow></a>\n<i class="icon-question-circle info-icon" db-tooltip={{::vm.i18n.pinConversationTooltip}} db-tooltip-max-width=400></i>\n</span>\n<span ng-if="channel.pin && !channel.invited">\n<i class="icon-minus-circle-outline left-icon"></i>\n<a ng-click=unpin() class=width-100 dm-i18n=buzz/unfollow></a>\n<i class="icon-question-circle info-icon" db-tooltip={{::vm.i18n.unfollowConversationTooltip}} db-tooltip-max-width=400></i>\n</span>\n</span>\n</div>\n</div>\n<div ng-if="channel.type === \'DirectChat\'" class=channel-actions>\n<span ng-if=::inChannelSearch class=action-link>\n<i class="icon-search left-icon"></i>\n<a ng-click=searchChannel()>{{::vm.i18n.search}}</a>\n<i class="icon-question-circle info-icon" db-tooltip={{vm.i18n.searchChatTooltip}} db-tooltip-max-width=400></i>\n</span>\n<span ng-if="channel.favoritePosition < 0" class=action-link>\n<i class="icon-star left-icon"></i>\n<a ng-click=toggleChannelFavorite()>{{::vm.i18n.favorite}}</a>\n<i class="icon-question-circle info-icon" db-tooltip={{vm.i18n.favoriteConversationTooltip}} db-tooltip-max-width=400></i>\n</span>\n<span ng-if="channel.favoritePosition >= 0" class=action-link>\n<i class="icon-star-outline left-icon"></i>\n<a ng-click=toggleChannelFavorite()>{{::vm.i18n.unfavorite}}</a>\n<i class="icon-question-circle info-icon" db-tooltip={{vm.i18n.unfavoriteConversationTooltip}} db-tooltip-max-width=400></i>\n</span>\n<span ng-if=canDelete class=action-link>\n<i class="icon-trash left-icon"></i>\n<a ng-click=deleteChannel(channel) dm-i18n=buzz/delete></a>\n</span>\n</div>\n</bz-side-accordion>\n<bz-side-accordion class=notifications accordion-title={{::vm.i18n.notificationSettings}}>\n<bz-channel-notification-settings></bz-channel-notification-settings>\n</bz-side-accordion>\n<bz-side-accordion class=attachments accordion-title={{::vm.i18n.attachments}} accordion-meta="{{ accordianCounts.attachments }}">\n<bz-channel-attachments on-attachments-updated=onAttachmentsUpdated(attachments)></bz-channel-attachments>\n</bz-side-accordion>\n<bz-side-accordion accordion-title={{::vm.i18n.bots}} tooltip-text=vm.i18n.botsTooltip ng-if="channel.type !== \'Huddle\' && cwLoaded" disabled=!botsEnabled accordion-meta="{{ accordianCounts.bots }}">\n<bz-integrations on-integrations-updated=onBotsUpdated(integrations)></bz-integrations>\n</bz-side-accordion>\n<bz-side-accordion class="favorites cursor-pointer" accordion-title={{::vm.i18n.favoritedMessages}} tooltip-text=vm.i18n.favoritedMessagesTooltip ng-click=onFavoritesOpen(); accordion-meta="{{ favorites.length }}">\n<div class=message-wrapper ng-repeat="message in favorites | orderBy:\'-created\' track by message.id" ng-click=favoriteClick(message)>\n<bz-message message=message class="block is-last-of-message-group show-creator show-favorite" show-date=true></bz-message>\n</div>\n<div ng-if=!favorites.length class="details-label bz-text-body secondary text-align-center" dm-i18n=buzz/no-favorites-in-conversation></div>\n</bz-side-accordion>\n<bz-side-accordion ng-show="(channel.parentChannel.type == \'DirectChat\' || channel.parentChannel.type == \'ObjectChat\') && relatedConversations.channelCount > 0" class="related cursor-pointer" accordion-title={{::vm.i18n.relatedConversations}} tooltip-text=vm.i18n.relatedConversationsTooltip ng-click=onRelatedConversationsOpen(); default-open=true>\n<bz-related-conversation-list bz-channel=channel channel-id=channel.channelId display-people="channel.type == \'DirectChat\' || channel.parentChannelType == \'DIRECT_CHAT\'" related-conversations=relatedConversations>\n</bz-related-conversation-list>\n</bz-side-accordion>\n<bz-side-accordion class=people accordion-title={{::vm.i18n.people}} accordion-meta="{{ accordianCounts.people }}" default-open=true>\n<bz-side-accordion-actions db-stopbubble>\n<db-button class=invite-button ng-if="channel.parentChannel.isGroupChat() || (channel.isDirectChat() && channel.themId !== \'buzzintro\') || inviteToIndividualTopic && hasInvitePermission" ng-click=handleInvite()>\n<div class=invite-button-wrapper>\n<span class="invite-icon icon-person-plus sm"></span>\n<span class=invite-text dm-i18n=buzz/invite></span>\n</div>\n</db-button>\n</bz-side-accordion-actions>\n<bz-user-list-preview></bz-user-list-preview>\n</bz-side-accordion>\n</div>\n</div>\n';
},2355:function(e,n,t){angular.module("buzz").directive("bzConnectionStatus",["bzEvents","bzRootPath","$timeout","features",function(e,n,a,i){return{restrict:"E",template:t(2356),link:function(n){function t(e){o&&a.cancel(o),o=a(function(){n.currentState=s[e],n.messagei18n="buzz/"+s[e],n.hide=!1,"connected"===s[e]&&a(function(){n.hide=!0},2e3)},750)}if(i.isElectron()){var s={offline:"offline",connecting:"connecting",connected:"connected",online:"connected"};n.currentState="connected",n.messagei18n=null,n.hide=!0,n.close=function(){n.hide=!0},n.$on("$destroy",e.buzzConnectivityChanged.on(t));var o}}}}])},2356:function(e,n){e.exports='<div class="bz-connection-status bz-top-banner bz-status-bg bz-status-{{ currentState }}" ng-show=!hide>\n<span class=message-description>\n<i class=icon-check ng-show="currentState === \'connected\'"></i>\n<span class=message-desc dm-i18n={{messagei18n}}>Connected</span>\n</span>\n<span class=right>\n<i class=icon-x ng-click=::close()></i>\n</span>\n</div>'},2357:function(e,n,t){function a(e){if(Array.isArray(e)){for(var n=0,t=Array(e.length);n<e.length;n++)t[n]=e[n];return t}return Array.from(e)}t(2358),angular.module("buzz").directive("bzUniversalCompose",["$q","dmCachedGroups","dmI18n","bzService","bzStore","bzEvents","bzMessageService","bzRouteTracking","bzAttachmentAdapter","CurrentUserId","bzHelpers","bzModals","$timeout",function(e,n,i,s,o,r,c,l,d,u,p,h,g){return{restrict:"E",template:t(2360),scope:{onCreate:"&",onCancel:"&",populatedData:"=?"},link:function(n,t){function l(){n.createMessageApi={},n.disableAudience=!0,n.typeaheadPopover=!0,n.searching=!1,n.hideInput=!1,n.avatarGroupOptions={user:{noclick:!0,noTooltip:!0},group:{noclick:!0,noTooltip:!0}},n.selectedItems=[],n.searchTerm="",n.conversationTitle="",n.i18n={},n.preventChannelChange=!1,n.mentions=[],n.messages=[],n.isPrivate=!0,n.send=E,n.onUnmentioned=R,n.onMentioned=j,n.onAttachmentAdded=L,n.onAttachmentRemoved=N,n.finishGrantAccess=G,n.channelClicked=I,n.deselectItem=M,n.selectItem=T,n.getObjectIcon=P,n.resetSelectedConversation=S,n.quoteMessage=y,n.deleteMessage=w,n.giphySearch=v,n.gifSelected=f,n.search=X,n.toggleToFieldOptions=Y,ee.push(r.channelChange.on(d)),ee.push(r.messageReceived.on(m)),Q.on("focusin focus",function(e){e.preventDefault()}),setTimeout(function(){Q.select()},200),C(),b(),z(),n.$on("$destroy",function(){ee.forEach(function(e){e()})}),n.$watchCollection("selectedItems",function(){n.messages=[],n.selectedItems.length<=0||O().then(function(e){n.channel=e,k(),n.mentions=B(n.mentions,n.selectedItems)})})}function d(){n.preventChannelChange||n.onCancel&&n.onCancel(),n.preventChannelChange=!1}function m(e){e.createdById==u&&n.onCancel&&n.onCancel()}function b(){function e(){_.isUndefined(n.highlightedItem)?a():(T(n.highlightedItem),K=void 0,n.highlightedItem=void 0)}function t(){_.isUndefined(K)?(K=n.usersGroups.length-1,n.highlightedItem=n.usersGroups[K]):K>0&&K<=n.usersGroups.length-1?(K--,n.highlightedItem=n.usersGroups[K],_.isUndefined(n.highlightedItem)&&t()):K<n.usersGroups.length-1&&(K=n.usersGroups.length-1,n.highlightedItem=n.usersGroups[K])}function a(){_.isUndefined(K)?(K=0,n.highlightedItem=n.usersGroups[K]):K<=n.usersGroups.length-1?(K++,n.highlightedItem=n.usersGroups[K],_.isUndefined(n.highlightedItem)&&a()):K>=n.usersGroups.length-1&&(K=0,n.highlightedItem=n.usersGroups[K])}Q.on("keyup",function(i){13==i.keyCode&&e(),38==i.keyCode&&t(),40==i.keyCode&&a(),9==i.keyCode&&""===Q.val().trim()?n.createMessageApi.focus():9==i.keyCode&&e(),_.defer(function(){n.$digest()})})}function v(e){e.forEach(function(e){e.images.fixed_height_small.url=e.images.fixed_height_small.url.replace(/http(?!s)/,"https")}),n.giphyResults=e}function f(e){n.createMessageApi.addText(" #"+e.id)}function z(){function t(){function t(){return 100==i?void a.reject("Timed out waiting for createMessageApi"):(n.createMessageApi.addAttachment?a.resolve():g(t,200),void i++)}var a=e.defer(),i=0;return t(),a.promise}if(n.populatedData&&(n.populatedData.attachedImage&&t().then(function(){n.createMessageApi.addFileAttachment(n.populatedData.attachedImage)}).catch(console.error),n.populatedData.card)){var a=n.populatedData.card;t().then(function(){n.createMessageApi.insertMention({marker:"@",displayName:a.getTitle(),start:0,type:"CARD",value:a.get("kpiId"),noAttachment:!0,length:a.getTitle().length}),n.createMessageApi.moveCursorToEnd()})}}function y(e){n.createMessageApi.quoteMessage(e)}function w(e){c.deleteMessage(e,n.channel.id).then(function(){r.messageDeleted.trigger(e);for(var t=n.messages.length;t>0;--t)if(n.messages[t]&&n.messages[t].id===e){n.messages[t].content.text=i.get("buzz/message-deleted"),n.messages[t].messageType="SYSTEM";break}},function(){console.error(i.get("buzz/error-deleting"))})}function k(){var t=n.channel.id;Z&&Z.resolve(),Z=e.defer(),c.getMessages(t,{},Z.promise).then(function(e){var a=e.messages;p.setDateBreaks(a,!1),o.messages[t]=a,n.messages=a})}function C(){n.i18n.searchPlaceholder=i.get("buzz/people-groups-convos"),n.i18n.conversationTitle=i.get("buzz/conversation-title"),n.i18n.titlePlaceholder=i.get("buzz/required-for-public")}function x(e){if(n.hideInput=e.length>0,$(),""!=e){n.searching=!0,n.searchingChannels=!0;var t=V(e);t.usersGroups.then(function(e){n.searching=!1,n.usersGroups=e}),t.channels.then(function(e){n.searchingChannels=!1,n.existingConversations=e})}else _.defer(function(){n.$digest()})}function T(e){var t=_.findWhere(n.selectedItems,function(n){return n.value===e.value||n.id===e.id});t||(e.title=e.displayName.substr(0,30),n.selectedItems.push(e),A())}function M(e){var t=n.selectedItems.indexOf(e),a=n.mentions.indexOf(e);t>=0&&(n.selectedItems.splice(t,1),n.mentions.splice(a,1))}function I(e){n.selectedConversation=e,o.channels[e.id]||(o.channels[e.id]=e),o.channels[e.id].unsentMessage=n.createMessageApi.getUnsentMessage(),n.onCancel&&n.onCancel(),n.preventChannelChange=!0,o.setCurrentChannel(e.id)}function $(){n.usersGroups=[],n.existingConversations=[]}function A(){$(),Q.focus(),Q.val(""),n.hideInput=!1}function S(){n.selectedConversation=void 0,A()}function P(e){var n;switch(e.objectType){case"CARD":n="icon-chart-bar-vertical";break;case"PAGE":n="icon-pages-bars";break;case"PROJECT":case"PROJECT_TASK":n="icon-project"}return n}function E(e,t){!t&&U(e)||(n.messages.push(e),n.isPrivate||(n.publicChannelLoader=!0),O().then(function(t){c.sendMessage(t.id,e).then(function(){o.setCurrentChannel(t.id).then(function(){setTimeout(function(){n.onCreate&&n.onCreate()},150),s.pinChannel(t)})})}))}function O(){for(var t={title:"",description:"",accesses:[],pin:!1,defaultPermission:"ADMIN"},a=0;a<n.selectedItems.length;a++){var i=n.selectedItems[a];t.accesses.push({id:i.value||i.id,type:i.type})}return n.isPrivate?1==n.selectedItems.length&&"USER"===n.selectedItems[0].type||2==n.selectedItems.length&&_.findWhere(n.selectedItems,{value:u})?s.getUserChannel(n.selectedItems[0].value).then(function(n){return e.when(n)}):s.createGroup(t).then(function(n){return e.when(n)}):(t.title=n.conversationTitle,t.pin=!0,t.defaultPermission=t.publicPermission="INVITE_OTHERS",s.createTopicChannel(t).then(function(n){return e.when(n)}))}function U(e){var n=/^\/support\b/;return!!n.test(e.content.text)&&(D(e,function(e){E(e,!0)}),!0)}function D(e,n){h.open("createSupportTicket",{message:e,onSubmit:n},{"control-close":"true"})}function R(e,t){"CARD"==e.type&&_.findWhere(n.createMessageApi.getAttachments(),{type:e.type,value:e.value})||(t.splice(_.indexOf(t,e),1),n.mentions=t)}function j(e,t){if(e.value){var a=_.findWhere(n.selectedItems,{value:e.value});a||"USER"!=e.type&&"GROUP"!=e.type||n.selectedItems.push({displayName:e.displayName,type:e.type,value:e.value}),n.mentions=B(t,n.selectedItems)}}function L(e){var t=n.mentions||[],a=F(e);H(a)||(t.push(a),n.mentions=B(t,n.selectedItems))}function N(e){var t=F(e);if("CARD"==t.data.type){for(var a=!1,i=n.createMessageApi.getMentions(),s=0;s<i.length;s++){var o=i[s].data;if(o.type==t.data.type&&o.value==t.data.value){a=!0;break}}if(a)return}var r=n.mentions||[];r=_.filter(r,function(e){return e.data.type!=t.data.type&&e.data.value!=t.data.value}),n.mentions=r}function F(e){var n={data:e};return n.data.value=n.data.id,n}function H(e){return _.filter(n.mentions,function(n){return n.data.type==e.data.type&&n.data.value==e.data.value}).length>0}function B(e,n){for(var t=[],i=0;i<n.length;i++){var s=n[i];t.push({data:s})}return[].concat(a(e),t)}function G(){n.autoGrantApi={},n.mentions=void 0}function V(e){var n,t,a=e.replace(/^@/i,""),i=a.toLowerCase();return n=W(i),t=q(i),{usersGroups:n,channels:t}}function q(e){for(var t=[],a={},i=0;i<n.selectedItems.length;i++){var o=n.selectedItems[i];t.push(o.type+":"+o.value)}return t.length>0&&(a.accessFilterFlag=!0,a.filterMode="CONTAINS_ALL",a.filters=t.join(",")),s.channelSearch(e,15,null,a).then(function(n){var t;return n.filter(function(n){return""!=n.title&&(t=n.title.toLowerCase().indexOf(e),n)})})}function W(n){J&&J.resolve(),J=e.defer();var t=["userByName","group"],i={params:{filter:n,limit:20,type:t},timeout:J.promise};return s.typeaheadSearch(i).then(function(e){var n=e.data.users.map(function(e){return{value:e.id,displayName:e.displayName,type:"USER"}}),t=e.data.groups.map(function(e){return{value:e.id,displayName:e.name||e.displayName,customIcon:"icon-people",type:"GROUP"}});return[].concat(a(n),a(t))})}function Y(){n.toFieldOptions=!n.toFieldOptions}var J,K,Z,Q=t.find(".pill-box input"),X=_.debounce(x,200),ee=[];l()}}}])},2358:function(e,n,t){var a=t(2359);"string"==typeof a&&(a=[[e.id,a,""]]);var i,s={};s.transform=i;t(3)(a,s);a.locals&&(e.exports=a.locals)},2359:function(e,n){e.exports="bz-universal-compose{position:absolute;z-index:3;top:0;left:0;right:0;background-color:#fff;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;bottom:0}bz-universal-compose .selected-channel{display:none;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;padding:14px;border-bottom:1px solid rgba(0,0,0,0.2);border-top:1px solid rgba(0,0,0,0.2)}bz-universal-compose .selected-channel .db-button{overflow:visible}bz-universal-compose .selected-channel .title{min-width:0;font-size:16px;font-weight:600}bz-universal-compose .selected-channel .icon{width:40px;height:40px;text-align:center}bz-universal-compose .selected-channel .icon i{font-size:24px}bz-universal-compose .header{padding:10px 14px;font-size:16px;font-weight:600}bz-universal-compose .header .close-compose{float:right;cursor:pointer}bz-universal-compose .loading-spinner{width:100%;text-align:center;padding:12px 0}bz-universal-compose .bz-create-message{margin-bottom:0}bz-universal-compose .to-field{position:relative;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding:5px 60px 5px 0;box-sizing:border-box;min-height:40px;border-top:1px solid rgba(0,0,0,0.1);border-bottom:1px solid rgba(0,0,0,0.1);color:#bcbebf}bz-universal-compose .to-field .search-pillbox-wrapper{-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;-ms-flex-preferred-size:0px;flex-basis:0px}bz-universal-compose .to-field .search-pillbox-wrapper .pill-box{width:100%;border:none;outline:none;padding-bottom:0}bz-universal-compose .to-field .search-pillbox-wrapper .pill-box.focus,bz-universal-compose .to-field .search-pillbox-wrapper .pill-box:focus{box-shadow:none;border:none}bz-universal-compose .to-field .search-pillbox-wrapper .pill-box input{padding-left:3px}bz-universal-compose .to-field .search-pillbox-wrapper .pill-box .placeholder{padding-left:24px}bz-universal-compose .to-field .to{margin-left:14px;margin-right:8px}bz-universal-compose .to-field-options-toggle{position:absolute;top:4px;right:4px}bz-universal-compose .to-field-options-toggle i{margin:0}bz-universal-compose .to-field-options-anchor{position:absolute;bottom:12px;right:4px;width:1px}bz-universal-compose .uc-conversation-title{position:relative;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;box-sizing:border-box;color:#bcbebf}bz-universal-compose .uc-conversation-title .required-message{width:100%;padding:8px;font-size:13px;color:#333;box-sizing:border-box;font-weight:600;background:#fff;border-bottom:1px solid rgba(0,0,0,0.1)}bz-universal-compose .uc-conversation-title .input{min-height:40px;width:100%;border:none}bz-universal-compose .uc-conversation-title .input:focus{border:none;box-shadow:0px 0px 0px transparent}bz-universal-compose .list-item-header{padding:14px}bz-universal-compose .list-item{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:start;-ms-flex-pack:start;justify-content:flex-start;padding:8px 14px;cursor:pointer}bz-universal-compose .list-item:hover{background:#F0F8FD}bz-universal-compose .list-item.small-icon .title{padding:0 8px 0 17px}bz-universal-compose .list-item.small-icon .icon{height:30px;width:30px}bz-universal-compose .list-item.highlighted{background-color:rgba(153,204,238,0.1)}bz-universal-compose .list-item .title{min-width:0;padding:0 8px}bz-universal-compose .list-item .sub-title{white-space:nowrap;text-transform:lowercase}bz-universal-compose .list-item .sub-title::first-letter{text-transform:capitalize}bz-universal-compose .list-item .icon{width:40px;height:40px;text-align:center}bz-universal-compose .list-item .icon i{font-size:24px}bz-universal-compose .conversation-list{-webkit-box-flex:2;-ms-flex-positive:2;flex-grow:2;overflow-y:scroll}bz-universal-compose .message-section{position:relative;min-height:53px}bz-universal-compose .messages{-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;-ms-flex-preferred-size:0;flex-basis:0;overflow:hidden;position:relative;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end}bz-universal-compose .auto-grant-access{padding:6px 12px}bz-universal-compose .auto-grant-access bz-auto-grant-item{line-height:20px}bz-universal-compose .auto-grant-access .icon-exclamation-triangle{color:#FC8F13;vertical-align:text-top}bz-universal-compose .auto-grant-access span{vertical-align:middle}bz-universal-compose .auto-grant-access .display-block{display:block}bz-universal-compose .auto-grant-access .access-item-object{font-weight:700;vertical-align:top;margin-bottom:3px}bz-universal-compose .auto-grant-access .access-item{vertical-align:top;margin-bottom:3px}bz-universal-compose .auto-grant-access .access-item.user,bz-universal-compose .auto-grant-access .access-item.group{color:#43799e;cursor:pointer}.uc-to-field-options{display:-webkit-box;display:-ms-flexbox;display:flex}.uc-to-field-options span{margin:0 4px;padding-right:5px}.uc-to-field-options i{font-size:14px}.uc-to-field-options db-toggle{top:4px;position:relative}.uc-to-field-options db-toggle .db-toggle{display:block}\n"},2360:function(e,n){e.exports='<div class=header>\n<span dm-i18n=buzz/new-buzz-message></span>\n<i class="icon-x close-compose" ng-if=onCancel ng-click=onCancel()></i>\n</div>\n<div class=to-field>\n<span class=to>To:</span>\n<div class=search-pillbox-wrapper db-dropdown selected-items=selectedItems searchterm=chatSearchTerm on-search=search(searchTerm) on-item-selected=selectItem(item) on-item-removed="deselectItem(item, selectedItems)" label-attribute=displayName placeholder-text={{i18n.searchPlaceholder}}>\n<db-dropdown-pill-box></db-dropdown-pill-box>\n</div>\n<db-button theme=alt class="button-container to-field-options-toggle" ng-click=toggleToFieldOptions() db-stopbubble>\n<i class="icon-dots-horizontal margin-left-xsmall"></i>\n</db-button>\n<div class=to-field-options-anchor>\n<div db-popover class=popover placement=bottom-right ng-show=toFieldOptions self-close>\n<div class=uc-to-field-options>\n<i ng-class="{\'icon-lock-open\': !isPrivate, \'icon-lock-closed\':isPrivate}"></i>\n<span ng-hide=!isPrivate dm-i18n=private></span>\n<span ng-show=!isPrivate dm-i18n=public></span>\n<db-toggle ng-model=isPrivate></db-toggle>\n</div>\n</div>\n</div>\n</div>\n<div class="loading-spinner spinner medium" ng-if="(searching && hideInput) || (!isPrivate && publicChannelLoader)"></div>\n<div class=messages ng-if=!hideInput>\n<bz-messages-body ng-hide=!isPrivate channel=channel messages=messages quote-message=quoteMessage(message) on-delete=deleteMessage(messageId) disable-thread-create=true></bz-messages-body>\n</div>\n<div class=conversation-list ng-if="hideInput && (usersGroups.length > 0 || existingConversations.length > 0)">\n<div ng-if="usersGroups.length > 0" class="list-item-header bz-text-label secondary" dm-i18n=buzz/people-and-groups></div>\n<div class="list-item small-icon" ng-repeat="item in usersGroups" ng-click=selectItem(item) ng-class="{highlighted: item.value && item.value == highlightedItem.value}">\n<span class=icon>\n<span ng-if="item.type === \'USER\'" dm-avatar-widget={{item.value}}></span>\n<i ng-if="item.type === \'GROUP\'" ng-class=item.customIcon></i>\n</span>\n<span class="bz-text-body title bz-text-overflow">{{item.displayName}}</span>\n</div>\n<div class="loading-spinner spinner medium" ng-if="searchingChannels && hideInput"></div>\n<div ng-if="existingConversations.length > 0" class="list-item-header bz-text-label secondary" dm-i18n=buzz/existing-conversations></div>\n<div class=list-item ng-repeat="channel in existingConversations" ng-switch=channel.type ng-click=channelClicked(channel)>\n<div class=icon>\n<i class=icon-chat-bubbles ng-switch-when=Topic ng-if=channel.isPrivateChannel()></i>\n<i class=icon-lock-closed ng-switch-when=Topic ng-if=channel.isPrivateChannel()></i>\n<i ng-switch-when=ObjectChat ng-class=getObjectIcon(channel)></i>\n<span dm-avatar-widget=channel.themId ng-switch-when=DirectChat></span>\n<dynamic-avatar-group ng-switch-when=GroupChat accesses=channel.accesses options=avatarGroupOptions></dynamic-avatar-group>\n</div>\n<span class="bz-text-body title bz-text-overflow">{{channel.title}}</span>\n<span class="bz-text-caption secondary sub-title">\n<span dm-i18n=buzz/channel-title-public-conversation ng-switch-when=Topic ng-if=channel.isPrivateChannel()></span>\n<span dm-i18n=buzz/channel-title-private-conversation ng-switch-when=Topic ng-if=channel.isPrivateChannel()></span>\n<span dm-i18n=buzz/channel-title-private-conversation ng-switch-when=DirectChat></span>\n<span dm-i18n=buzz/channel-title-private-conversation ng-switch-when=GroupChat></span>\n<span dm-i18n=buzz/channel-title-object-conversation data="{type: channel.objectType}" ng-switch-when=ObjectChat></span>\n</span>\n</div>\n</div>\n<div class=message-section ng-hide=hideInput>\n<bz-auto-grant-access class=auto-grant-access ng-if=mentions.length mentions=mentions on-access-exists=finishGrantAccess() api=autoGrantApi provided-channel=channel></bz-auto-grant-access>\n<bz-giphy-selector class=dm-animate ng-if=giphyResults.length gifs=giphyResults on-gif-selected=gifSelected(gif)></bz-giphy-selector>\n<div class=uc-conversation-title ng-show="!isPrivate && !hideInput">\n<div class=required-message>{{::i18n.titlePlaceholder}}</div>\n<input type=text class=input placeholder={{::i18n.conversationTitle}} ng-model=conversationTitle />\n</div>\n<bz-create-message class="bz-create-message margin-bottom-xxsmall" api=createMessageApi is-disabled="!isPrivate && !conversationTitle.length" disable-thread=true on-giphy-search=giphySearch(giphyResults) on-mentioned="onMentioned(mention, mentions)" on-unmentioned="onUnmentioned(mention, mentions)" on-attachment-added=onAttachmentAdded(attachment) on-attachment-removed=onAttachmentRemoved(attachment) on-create=send(message) typeahead-popover=typeaheadPopover disable-audience=disableAudience manual-channel=channel ignore-current-channel=true>\n</bz-create-message>\n</div>'},2361:function(e,n,t){angular.module("buzz").directive("bzMessagesSidebarHeader",["bzRootPath",function(e){return{restrict:"E",template:t(2362),controller:"bzMessagesSidebarHeaderController",controllerAs:"$ctrl"}}]),angular.module("buzz").controller("bzMessagesSidebarHeaderController",["$scope","bzStates","bzEvents","dmI18n","bzService","features","bzUniversalComposeService","Analytics","bzHotkeyService","bzStore","buzzContainerService",function(e,n,t,a,i,s,o,r,c,l,d){function u(){f.vm.i18n={makeFullscreen:c.hotkeyWithI18n("buzz/make-fullscreen","toggleFullscreen"),createNewMessage:a.get("buzz/create-new-message")};var n=t.missedImportant.on(b);e.$on("$destroy",function(){n()})}function p(){function e(){v&&v.close(),v=void 0,l.hasCurrentChannel()||(n.zeroState(),n.isZeroState=!0)}v?e():v=o.open({onCancel:e,onCreate:e})}function h(){return d.isFullscreen}function g(e){r.track("buzz_full"),d.toggleFullscreen(e)}function m(){"menu"!==n.current?n.menu():n.isZeroState?n.zeroState():n.messages()}function b(e){_.isUndefined(e.totalCount)||(f.missedMessageCount=e.totalCount)}var v,f=this;f.vm={},f.openMenu=m,f.missedMessageCount=0,f.isFullScreen=h,f.toggleFullscreen=g,f.universalCompose=p,u()}])},2362:function(e,n){e.exports='<img class=logo-midnight src=/public/javascripts/buzz/buzz-logo-white-small.png />\n<div class=actions>\n<db-button class=universal-compose-icon theme=alt db-stopbubble ng-click=$ctrl.universalCompose() db-tooltip-placement=left db-tooltip={{::$ctrl.vm.i18n.createNewMessage}}>\n<i class="icon-pencil-box hide-when-electron" db-tooltip-placement=left></i>\n</db-button>\n<db-button class=menu-fullscreen-btn theme=alt db-stopbubble ng-click=$ctrl.toggleFullscreen(true)>\n<i class="menu-icon hoverable icon-expand hide-when-electron" ng-if=!$ctrl.isFullscreen() db-tooltip-placement=left db-tooltip={{::$ctrl.vm.i18n.makeFullscreen}}></i>\n</db-button>\n</div>\n'},2363:function(e,n,t){var a=t(8);angular.module("buzz").directive("bzViewDirector",["$rootScope","bzStates","bzEvents","features","CurrentUser","dmSocialUserService","$location",function(e,n,t,i,s,o,r){return{restrict:"E",transclude:!0,template:'<div class="panes full-width-menu" ng-transclude visible-panes="{{ visiblePanes }}" current-pane="{{ currentPane }}"></div>',link:function(e,i){function s(){h=n.stateLookup,u(),n.panesReady.promise.then(function(){r(),_.defer(function(){a(window).trigger("resize"),o()}),n.lastDiff&&l(n.lastDiff),p.push(t.sizeChange.on(o))}),e.$on("$destroy",function(){p.forEach(function(e){e()})})}function o(){e.visiblePanes=n.panes>2&&n.panesOverride?n.panesOverride:n.panes}function r(){for(var e in h){var n=h[e],t=i.find(n.selector);t.addClass("pane")}}function c(){_.contains(n.states,"side-pane")&&(n.isZeroState?_.contains(n.states,"zero-state")||n.zeroState():_.contains(n.states,"messages")||n.messages())}function l(n){e.currentPane=h[n[1].to].position;for(var t=0;t<n.length;t++){var a,i,s=n[t];s.from&&(a=_.extend(h[s.from],{node:d(s.from)}),i=_.extend(h[s.to],{node:d(s.to)}),a&&(a.node.siblings().removeClass("from"),a.node.addClass("from")),i&&(i.node.siblings().removeClass("to"),i.node.addClass("to"),i.node.siblings().removeClass("visible"),i.node.addClass("visible")))}}function d(e){if(""!==e&&e)return i.find(h[e].selector)}function u(){p.push(t.stateChange.on(l))}var p=[],h={};e.currentPane=2,e.setMessagesState=c,s()}}}])},2364:function(e,n,t){angular.module("buzz").directive("bzProTip",["bzRootPath","dmI18n","dmUtils","$timeout","bzPreferences","Analytics",function(e,n,a,i,s,o){return{template:t(2365),restrict:"E",scope:{tips:"=?",custom:"=?",show:"=?",api:"&?",method:"=?"},link:function(e,t){function i(){h();var n=function(){switch(e.method){case"current":return u;case"daily":return d;case"random":return p;default:return u}}();e.proTip=e.custom||n(),e.api={getRandomProTip:p,getUsersCurrentTip:u,getDailyTip:d},e.hide=r,e.next=c,e.previous=l}function r(){o.track("buzz_pro_tips_closed"),s.enableBuzzProTips=!1}function c(){o.track("buzz_pro_tips_next_tip_clicked"),u()}function l(){o.track("buzz_pro_tips_previous_tip_clicked"),e.index--,u()}function d(){return e.index=new Date((new Date).toDateString()).getTime()%_.keys(g).length,e.proTip=g[m[e.index]]}function u(){return e.index>=m.length&&(e.index=0),e.proTip=g[m[e.index++]]}function p(){return e.index=Math.floor(Math.random()*m.length),e.proTip=g[m[e.index]]}function h(){var n="buzz-pro-tip-index",t=a.localStorageRead(n)||0;Object.defineProperty(e,"index",{get:function(){return t},set:function(e){t=e,a.localStorageWrite(n,t)}})}var g={atAll:{title:n.get("pro-tips/bz-at-all-title"),tip:n.get("pro-tips/bz-at-all-tip")},bots:{title:n.get("pro-tips/bz-bots-title"),tip:n.get("pro-tips/bz-bots-tip")},commands:{title:n.get("pro-tips/bz-commands-title"),tip:n.get("pro-tips/bz-commands-tip")},favorite:{title:n.get("pro-tips/bz-favorite-title"),tip:n.get("pro-tips/bz-favorite-tip")},inviteAnyone:{title:n.get("pro-tips/bz-invite-anyone-title"),tip:n.get("pro-tips/bz-invite-anyone-tip")},mention:{title:n.get("pro-tips/bz-mention-title"),tip:n.get("pro-tips/bz-mention-tip")},reactions:{title:n.get("pro-tips/bz-reactions-title"),tip:n.get("pro-tips/bz-reactions-tip")},tasks:{title:n.get("pro-tips/bz-tasks-title"),tip:n.get("pro-tips/bz-tasks-tip")},threads:{title:n.get("pro-tips/bz-threads-title"),tip:n.get("pro-tips/bz-threads-tip")}},m=e.tips||_.keys(g);"string"==typeof m&&(m=[m]),i()}}}])},2365:function(e,n){e.exports='<div class="bz-pro-tip dm-animate" ng-if=show>\n<div class="bz-pro-tip-message bz-text-caption" ng-click=next()>\n<span class=bz-pro-tip-title>{{proTip.title}}</span> <span class=bz-pro-tip-text>{{proTip.tip}}</span>\n</div>\n<i class=icon-x ng-click=hide()></i>\n</div>'},2366:function(e,n,t){angular.module("buzz").directive("bzChannelDetailsHeader",["bzRootPath","bzStates","Analytics","dmI18n",function(e,n,a,i){return{restrict:"E",scope:!0,template:t(2367),link:function(e,t){function a(){e.navigateTo=o,e.vm={},e.active="sidePane",s()}function s(){e.vm.i18n={attachments:i.get("buzz/attachments"),conversationDetails:i.get("buzz/conversation-details")}}function o(t){e.active=t,n[t]&&n[t]()}a()}}}])},2367:function(e,n){e.exports='<bz-main-header class=center>\n<db-buttons>\n<db-button ng-class="{active: active === \'sidePane\'}" ng-click="navigateTo(\'sidePane\')" db-tooltip-placement=bottom db-tooltip={{::vm.i18n.conversationDetails}}>\n<i class="icon-info-circle sm"></i>\n<span class=text-transform-uppercase dm-i18n=info></span>\n</db-button>\n<db-button ng-class="{active: active === \'channelAttachments\'}" ng-click="navigateTo(\'channelAttachments\')" db-tooltip-placement=bottom db-tooltip={{::vm.i18n.attachments}}>\n<i class="icon-paperclip sm"></i>\n<span class=text-transform-uppercase>{{::vm.i18n.attachments}}</span>\n</db-button>\n</db-buttons>\n</bz-main-header>'},2368:function(e,n,t){angular.module("buzz").directive("bzChannelNotificationSettings",["bzStore","bzNotificationService","bzService","bzEvents","dmI18n","$location","Analytics","features","buzzContainerService",function(e,n,a,i,s,o,r,c,l){return{restrict:"E",template:t(2369),link:function(t,c){function d(){t.goToMainChannel=h,t.saveNotificationSettings=m,t.resetNotificationSettings=_.debounce(b,500),t.manageNotifications=v,t.toggleMute=g,u(),p(),f.push(i.channelChange.on(p)),f.push(i.currentChannelUpdated.on(p)),t.$on("$destroy",function(){f.forEach(function(e){e()})})}function u(){t.i18n={desktopNotifications:s.get("buzz/desktop-notifications"),mobileNotifications:s.get("buzz/mobile-notifications"),emailNotifications:s.get("buzz/email-notifications"),smsNotifications:s.get("buzz/sms-notifications"),mentionsTooltip:s.get("buzz/mentions-description")}}function p(){t.channel=e.currentChannel,t.disabledSettings="Huddle"===t.channel.type}function h(){e.setCurrentChannel(t.channel.channelId)}function g(){t.channel.notify&&r.track("buzz_mute_conversation",{channel_id:t.channel.id,channel_type:t.channel.type}),a.setNotifyOnChannel(t.channel,!t.channel.notify)}function m(e){t.channel.setNotifications(e),z(t.channel,t.channel.notifications)}function b(){t.channel.setNotifications({desktop:null,mobile:null,email:null,sms:null}),n.resetNotificationSettings(t.channel.id)}function v(){l.toggleFullscreen(!1),o.path("/notificationcenter").search({typeId:"notifications"})}var f=[],z=_.debounce(a.modifyMe,1e3);d()}}}])},2369:function(e,n){e.exports='<div ng-switch="channel.type !== \'Huddle\'" class="notification-settings-text margin-bottom-small">\n<span ng-switch-when=true ng-if=!channel.desktop><span dm-i18n=buzz/inherit-notification-settings></span> <a ng-click=manageNotifications() dm-i18n=buzz/manage-global-notify-settings></a></span>\n<span ng-switch-when=true ng-if=channel.desktop><span dm-i18n=buzz/custom-notification-settings></span> <a ng-click=resetNotificationSettings() dm-i18n=buzz/reset-to-default></a></span>\n<span ng-switch-when=false><span dm-i18n=buzz/huddle-notification-settings></span> <a ng-click=goToMainChannel() dm-i18n=buzz/return-to-main-channel></a></span>\n</div>\n<div class=notification-settings ng-switch="channel.parentChannel.type === \'DirectChat\'" ng-class="{disabled: disabledSettings}">\n<div class="labels notification-row">\n<i></i>\n<span class="bz-text-caption secondary" dm-i18n=buzz/none></span>\n<span ng-switch-when=false class="bz-text-caption secondary" dm-i18n=buzz/mentions db-tooltip={{::vm.i18n.mentionsTooltip}}></span>\n<span ng-switch-when=true></span>\n<span class="bz-text-caption secondary" dm-i18n=buzz/everything></span>\n</div>\n<div class="desktop notification-row">\n<i class=icon-computer db-tooltip={{::vm.i18n.desktopNotifications}}></i>\n<db-radio-button disabled=disabledSettings always-enabled="disabledSettings && channel.notifications.desktop === \'NONE\'" model=channel.notifications.desktop ng-click="saveNotificationSettings({desktop: \'NONE\'})" value=NONE>\n</db-radio-button>\n<db-radio-button disabled=disabledSettings always-enabled="disabledSettings && channel.notifications.desktop === \'GROUP_MENTIONS\'" ng-switch-when=false model=channel.notifications.desktop ng-click="saveNotificationSettings({desktop: \'GROUP_MENTIONS\'})" value=GROUP_MENTIONS>\n</db-radio-button>\n<span ng-switch-when=true></span>\n<db-radio-button disabled=disabledSettings always-enabled="disabledSettings && channel.notifications.desktop === \'ALL\'" model=channel.notifications.desktop ng-click="saveNotificationSettings({desktop: \'ALL\'})" value=ALL>\n</db-radio-button>\n</div>\n<div class="mobile notification-row">\n<i class=icon-cell-phone db-tooltip={{::vm.i18n.mobileNotifications}}></i>\n<db-radio-button disabled=disabledSettings always-enabled="disabledSettings && channel.notifications.mobile === \'NONE\'" model=channel.notifications.mobile ng-click="saveNotificationSettings({mobile: \'NONE\'})" value=NONE>\n</db-radio-button>\n<db-radio-button disabled=disabledSettings always-enabled="disabledSettings && channel.notifications.mobile === \'GROUP_MENTIONS\'" ng-switch-when=false model=channel.notifications.mobile ng-click="saveNotificationSettings({mobile: \'GROUP_MENTIONS\'})" value=GROUP_MENTIONS>\n</db-radio-button>\n<span ng-switch-when=true></span>\n<db-radio-button disabled=disabledSettings always-enabled="disabledSettings && channel.notifications.mobile === \'ALL\'" model=channel.notifications.mobile ng-click="saveNotificationSettings({mobile: \'ALL\'})" value=ALL>\n</db-radio-button>\n</div>\n<div class="email notification-row">\n<i class=icon-envelope db-tooltip={{::vm.i18n.emailNotifications}}></i>\n<db-radio-button disabled=disabledSettings always-enabled="disabledSettings && channel.notifications.email === \'NONE\'" model=channel.notifications.email ng-click="saveNotificationSettings({email: \'NONE\'})" value=NONE>\n</db-radio-button>\n<db-radio-button disabled=disabledSettings always-enabled="disabledSettings && channel.notifications.email === \'GROUP_MENTIONS\'" ng-switch-when=false model=channel.notifications.email ng-click="saveNotificationSettings({email: \'GROUP_MENTIONS\'})" value=GROUP_MENTIONS>\n</db-radio-button>\n<span ng-switch-when=true></span>\n<db-radio-button disabled=disabledSettings always-enabled="disabledSettings && channel.notifications.email === \'ALL\'" model=channel.notifications.email ng-click="saveNotificationSettings({email: \'ALL\'})" value=ALL>\n</db-radio-button>\n</div>\n<div class="sms notification-row">\n<i class=icon-sms db-tooltip={{::vm.i18n.smsNotifications}}></i>\n<db-radio-button disabled=disabledSettings always-enabled="disabledSettings && channel.notifications.sms === \'NONE\'" model=channel.notifications.sms ng-click="saveNotificationSettings({sms: \'NONE\'})" value=NONE>\n</db-radio-button>\n<db-radio-button disabled=disabledSettings always-enabled="disabledSettings && channel.notifications.sms === \'GROUP_MENTIONS\'" ng-switch-when=false model=channel.notifications.sms ng-click="saveNotificationSettings({sms: \'GROUP_MENTIONS\'})" value=GROUP_MENTIONS>\n</db-radio-button>\n<span ng-switch-when=true></span>\n<db-radio-button disabled=disabledSettings always-enabled="disabledSettings && channel.notifications.sms === \'ALL\'" model=channel.notifications.sms ng-click="saveNotificationSettings({sms: \'ALL\'})" value=ALL>\n</db-radio-button>\n</div>\n</div>\n';
},2370:function(e,n,t){angular.module("buzz").directive("bzChannelAttachments",["bzRootPath","bzEvents","bzStates","bzService","bzStore","bzAttachmentLoader","$q",function(e,n,a,i,s,o,r){return{restrict:"E",replace:!0,scope:{onAttachmentsUpdated:"&?"},template:t(2371),link:function(e,t){function a(){s.currentChannel.id&&(h=!1,e.attachments=e.attachmentQueue=[],d(s.currentChannel.id))}function i(){e.attachments=e.attachments.concat(e.attachmentQueue.splice(0,g)),c()}function c(){return e.attachmentQueue.length>=g||e.attachmentsLoader.done?r.when(e.isLoading=!1):(e.isLoading=!0,e.attachmentsLoader.nextPage().then(function(n){return n?(e.attachmentQueue=e.attachmentQueue.concat(n),c()):e.isLoading=!1},function(){e.isLoading=!1}))}function l(n){n.channelId===s.currentChannel.id&&e.attachmentsLoader.filter(n.attachments).length&&(_.each(n.attachments,function(e){e.messageId=n.id}),Array.prototype.unshift.apply(e.attachments,n.attachments))}function d(n){e.attachmentsLoader=o.newLoader(n),c().then(i)}function u(n){e.attachments=_.reject(e.attachments,{messageId:n})}function p(e){u(e.id),l(e)}var h,g=10;e.showMore=!0,e.isLoading=!1,e.attachments=[],e.attachmentQueue=[],e.attachmentsLoader=void 0,e.loadAttachments=c,e.showMoreAttachments=i;var m=[];m.push(n.channelChange.on(a)),m.push(n.messageReceived.on(l)),m.push(n.messageDeleted.on(u)),m.push(n.messageUpdated.on(p)),a(),e.$watchCollection("attachments",function(){e.onAttachmentsUpdated&&e.onAttachmentsUpdated({attachments:e.attachments})}),e.$on("$destroy",function(){_.each(m,function(e){e()})})}}}])},2371:function(e,n){e.exports='<div class=bz-channel-attachments>\n<div ng-if=!attachments.length class="bz-text-body secondary" dm-i18n=buzz/no-attachments-in-conversation></div>\n<div class=scroll-list>\n<div class=attachment-list>\n<div class=attachment ng-repeat="attachment in attachments | orderBy:\'-created\'">\n<bz-attachment attachment=attachment></bz-attachment>\n</div>\n<div class=attachment-show-more ng-show="attachmentQueue.length && !isLoading" ng-click=showMoreAttachments() dm-i18n=buzz/show-more></div>\n</div>\n<span class="spinner small" ng-if=isLoading></span>\n</div>\n</div>'},2372:function(e,n,t){var a=t(8);angular.module("buzz").directive("bzIntegrations",["bzRootPath","bzIntegrationsService","bzIntegrationModel","bzStates","bzEvents","bzStore","dmI18n","cwConfigWizardUtils","features","$routeParams",function(e,n,i,s,o,r,c,l,d,u){return{replace:!0,restrict:"E",scope:{onIntegrationsUpdated:"&?"},template:t(2373),link:function(e,n,t){function s(){i.registerListener(k),e.integrationSelected=y,e.pickedAccount=z,e.saveIntegration=w,e.stepAction=C,e.removeIntegration=T,e.editInstance=f,e.toProviders=v,e.updateFilterText=b,e.channelName="",e.showDeleteModal=g,e.changeHandler=x,e.setNameInputToDirty=M,e.vm={},h(),k(),$=o.channelChange.on(m),e.$on("$destroy",$),e.$watch(function(){if(e.model.currentIntegration)return p(e.model.currentIntegration.configurations)},function(n){e.wizardIsValid=n}),e.$watch("model.currentIntegration.configurations",function(e,n){e&&i.setName(e)},!0),e.$watchCollection("model.existingIntegrations",function(n,t){e.model.existingIntegrations&&e.onIntegrationsUpdated&&e.onIntegrationsUpdated({integrations:e.model.existingIntegrations})})}function p(n){var t=!1;return _.each(n,function(n,a){var i=n.configuration,s=l.getWizardValidity(i);s&&e.model.currentIntegration.integrationName&&(t=!0)}),t}function h(){e.vm.i18n={getSocialUpdates:c.get("buzz/get-social-updates"),browseAll:c.get("buzz/browse-all"),addABot:c.get("buzz/add-a-bot",{bot:c.get("buzz/bot")}),addANewBot:c.get("buzz/add-a-new-bot",{bot:c.get("buzz/bot")}),noAccessToBot:c.get("buzz/no-access-to-bot",{bot:c.get("buzz/bot")}),addBotBlurb:c.get("buzz/add-bot-blurb"),webhooks:c.get("buzz/webhooks"),periodicUpdates:c.get("buzz/periodic-updates"),email:c.get("buzz/email"),attention:c.get("buzz/attention"),errorMessage:c.get("buzz/generic-error-message"),nameYourBot:c.get("buzz/name-your-bot"),webhook:c.get("buzz/webhook"),twoWayBot:c.get("buzz/two-way-bot")}}function g(){e.integrationToDelete=this.existingIntegration,e.deleteModal=!0}function m(){e.channelName=r.currentChannel.title,i.channelChanged()}function b(){i.updateFilter(this.filterText)}function v(){i.forwardStep()}function f(e){e.access&&i.editInstance(e)}function z(e){i.setAccount(e)}function y(e){i.setIntegration(e)}function w(n){return n?(i.saveIntegration(n),void(e.wizardIsValid=!1)):void i.backStep()}function k(){e.model=i.getModel(),1===e.model.step&&setTimeout(function(){a("#integrationSearch").focus()},50),I()}function C(){i.backStep(),e.wizardIsValid=!1}function x(e){i.changeHandler(e)}function T(){i.removeIntegration(e.integrationToDelete)}function M(){i.setIntegrationNameToDirty()}function I(){e.model.instanceError?S.html('<i class="icon-exclamation-triangle" style="color: #fc8f13; vertical-align: top; padding-right: 5px;"></i>'+c.get("buzz/bots")):e.model.instanceRequestInProgress?S.html('<span class="spinner small" style="vertical-align: top; padding-right: 5px;"></span>'+c.get("buzz/bots")):S.text(c.get("buzz/bots"))}var $,A=a('div[accordion-title="'+c.get("buzz/bots")+'"]'),S=A.find(".accordion-title");"showBots"===u.guideModal&&i.forwardStep(),d.on("bots")&&s()}}}])},2373:function(e,n){e.exports='<div class=bz-integrations>\n<div>\n<div>\n<div class="provider white-space-none" style=margin-bottom:5px>\n<div style="display:inline-block;line-height:75px;text-align:center;border:1px dashed #ccc;background-color:#efefef;cursor:pointer;width:75px;height:75px" ng-click=toProviders()>\n<i class=icon-plus style=font-size:32px;color:#333></i>\n</div>\n<div class="inline-block vertical-align-top padding-left-xxsmall cursor-pointer" style=width:65% ng-click=toProviders()>\n<div class=font-weight-bold>{{::vm.i18n.addANewBot}}</div>\n<div class="font-size-small color-gray">\n<span>{{::vm.i18n.getSocialUpdates}}</span><a> {{::vm.i18n.browseAll}}</a>\n</div>\n</div>\n</div>\n<div ng-class="{\'cursor-pointer\': existingIntegration.access}" class="existing-integration padding-top-xxsmall padding-bottom-xxsmall" ng-repeat="existingIntegration in model.existingIntegrations" ng-click=editInstance(existingIntegration)>\n<div class=float-right style=line-height:75px db-stopbubble>\n<i ng-show=existingIntegration.access class="icon-trash color-alert-red" ng-click=showDeleteModal()></i>\n<i ng-show=!existingIntegration.access db-tooltip={{::vm.i18n.noAccessToBot}} class=icon-lock-closed></i>\n</div>\n<span dm-logo provider={{existingIntegration.integration.dataProviderKey}} size=large></span>\n<div class="existing-integration-name single-line-ellipsis inline-block vertical-align-top padding-left-xxsmall font-weight-semi-bold" db-tooltip={{existingIntegration.name}} style=line-height:75px><span ng-if=existingIntegration.error><i class=icon-exclamation-triangle style=color:#fc8f13;padding-right:5px></i></span>{{existingIntegration.name}}</div>\n</div>\n</div>\n</div>\n<db-modal modal-show=deleteModal modal-close="deleteModal = !deleteModal">\n<db-modal-header>\n<db-modal-title><span dm-i18n key=buzz/delete-bot></span></db-modal-title>\n</db-modal-header>\n<db-modal-body>\n<span dm-i18n key=buzz/confirm-bot-delete data="{botName: integrationToDelete.name}"></span>\n</db-modal-body>\n<db-modal-footer>\n<db-modal-buttons>\n<db-modal-button button-class="button alternative"><span dm-i18n key=common/cancel></span></db-modal-button>\n<db-modal-button button-class="button danger" button-action=removeIntegration()><span dm-i18n key=common/delete></span></db-modal-button>\n</db-modal-buttons>\n</db-modal-footer>\n</db-modal>\n<db-modal modal-show=model.step modal-close=stepAction()>\n<db-modal-header>\n<db-modal-title class=padding-left-xxsmall>{{::vm.i18n.addABot}}</db-modal-title>\n</db-modal-header>\n<div class="bz-integrations padding-left-xxsmall modal-height">\n<div ng-if="model.step === 1" class="">\n<div class=padding-bottom-small>\n{{::vm.i18n.addBotBlurb}}\n</div>\n<div class=padding-bottom-small>\n<div class=search-box style="">\n<i class=icon-search></i>\n<input id=integrationSearch type=text class=input placeholder="{{\'datacenter/search\' | i18n}}" ng-model=filterText ng-change=updateFilterText()>\n</div>\n</div>\n<div class="provider cursor-pointer inline-block dm-animate" style=padding-right:10px;padding-bottom:10px ng-repeat="provider in model.filteredList" ng-click=integrationSelected(provider)>\n<span dm-logo provider={{provider.dataProviderKey}} size=xlarge db-tooltip={{provider.name}}></span>\n</div>\n</div>\n<div ng-if="model.step > 1">\n<div ng-if=model.currentIntegration.error>\n<div class="padding-medium integration-error margin-bottom-medium">\n<div class=left-side><i class=icon-exclamation-triangle></i></div>\n<div class=right-side>\n<div class=top-line>{{::vm.i18n.attention}}</div>\n<div class=bottom-line>{{model.currentIntegration.errorMessage}}</div>\n</div>\n</div>\n</div>\n<div class="" style="">\n<span dm-logo provider={{model.currentIntegration.dataProviderKey}} size=large></span>\n<div style=max-width:80% class="inline-block vertical-align-top padding-left-xxsmall">\n<div class=font-weight-bold style="">{{model.currentIntegration.name}}</div>\n<div class="font-size-small color-gray" ng-bind-html=model.currentIntegration.description></div>\n</div>\n</div>\n</div>\n<div ng-if="model.step === 2 || model.step === 3">\n<div class=config-form>\n<label class="config-section-label ng-scope" style=display:block;padding-top:20px;margin-bottom:-15px>\n<span class=required>*</span>\n<b style=vertical-align:top class="color-gray-5 font-weight-semi-bold font-size-small ng-binding">{{::vm.i18n.nameYourBot}}</b>\n</label>\n<input ng-change=setNameInputToDirty() type=text class="input margin-vertical-small" ng-model=model.currentIntegration.integrationName placeholder="Bot Name"/>\n</div>\n<div class="" ng-if="model.handlerOptions > 1">\n<db-tabs active-tab=model.handler style=margin-left:-10px;display:block;margin-bottom:15px>\n<db-tab name=PUSH ng-click="changeHandler(\'PUSH\')" ng-if="model.currentIntegration.configurations.PUSH && model.handlerOptions > 1">{{::vm.i18n.webhook}}</db-tab>\n<db-tab name=PULL ng-click="changeHandler(\'PULL\')" ng-if="model.currentIntegration.configurations.PULL && model.handlerOptions > 1">{{::vm.i18n.periodicUpdates}}</db-tab>\n<db-tab name=SMTP ng-click="changeHandler(\'SMTP\')" ng-if="model.currentIntegration.configurations.SMTP && model.handlerOptions > 1">{{::vm.i18n.email}}</db-tab>\n<db-tab name=COMMAND ng-click="changeHandler(\'COMMAND\')" ng-if="model.currentIntegration.configurations.COMMAND && model.handlerOptions > 1">{{::vm.i18n.twoWayBot}}</db-tab>\n</db-tabs>\n</div>\n<div class="">\n<cw-config-wizard ng-if="model.handler === \'PULL\'" data=model.currentIntegration.configurations.PULL.configuration current-step-num=1 layout=single-column on-validate=dummy() on-finished=saveIntegration(values)></cw-config-wizard>\n<cw-config-wizard ng-if="model.handler === \'PUSH\'" data=model.currentIntegration.configurations.PUSH.configuration current-step-num=1 layout=single-column on-validate=dummy() on-finished=saveIntegration(values)></cw-config-wizard>\n<cw-config-wizard ng-if="model.handler === \'SMTP\'" data=model.currentIntegration.configurations.SMTP.configuration current-step-num=1 layout=single-column on-validate=dummy() on-finished=saveIntegration(values)></cw-config-wizard>\n<cw-config-wizard ng-if="model.handler === \'COMMAND\'" data=model.currentIntegration.configurations.COMMAND.configuration current-step-num=1 layout=single-column on-validate=dummy() on-finished=saveIntegration(values)></cw-config-wizard>\n</div>\n</div>\n</div>\n<db-modal-footer>\n<db-modal-buttons>\n<db-button ng-if="model.step === 2 || model.step === 3" ng-disabled=!wizardIsValid theme=primary ng-click="saveIntegration(\'finished\')"><span dm-i18n key=common/save></span></db-button>\n<db-button ng-click=stepAction()><span dm-i18n key=common/cancel></span></db-button>\n</db-modal-buttons>\n</db-modal-footer>\n</db-modal>\n</div>\n'},2374:function(e,n){angular.module("buzz").factory("bzIntegrationsService",["$http","$q","cnNewConnectorData","bzStore","features",function(e,n,t,a,i){function s(t){var a=n.defer();return e.post("/api/data/v1/validation/configuration",t.configurations).then(function(n){n.data.errors||n.data.warnings?a.resolve(n):(delete t.configurations.dataProviderKey,e.put(g+"/v1/integration-instances/"+t.id,t).then(function(e){a.resolve(e)}))}),a.promise}function o(n){e.delete(g+"/v1/integration-instances/"+n.id).then(function(e){})}function r(t){var a=n.defer();return e.get("/api/data/v1/accounts/"+t).then(function(e){a.resolve(e.data)}),a.promise}function c(){var t=n.defer();return e.get(g+"/v1/integrations").then(function(e){t.resolve(e.data)}),t.promise}function l(){var t=n.defer(),i={};return a.currentChannel.id?e.get(g+"/v1/integration-instances?channel="+a.currentChannel.id).then(function(e){_.each(e.data,function(e){e.createdBy===Domo.CurrentUser.USER_ID||"Admin"===Domo.CurrentUser.USER_ROLE?e.access=!0:e.access=!1}),i.instances=e.data,t.resolve(i)}):t.reject(),t.promise}function d(t){var a=n.defer();return e.get(g+"/v1/integrations/"+t).then(function(e){a.resolve(e.data)}),a.promise}function u(t){var a=n.defer();return e.post("/api/data/v1/validation/configuration",t.configurations).then(function(n){n.data.errors||n.data.warnings?a.resolve(n):(delete t.configurations.dataProviderKey,e.post(g+"/v1/integration-instances",t).then(function(e){a.resolve(e)}))}),a.promise}function p(){var n=Date.now(),t=36e5;return(!h||n-h.lastCheck>t)&&(h=e.get(g+"/v1/integrations").then(function(e){var n={};return _.each(e.data,function(e){n[e.name]||(n[e.name]=e)}),n}),h.lastCheck=n),h}var h,g=i.on("integrations")?"/api/integrations":"/api/buzz",m={getAvailableIntegrations:c,getExistingIntegrations:l,getIntegrationDetails:d,saveNewIntegration:u,getIntegrationProviders:p,lookupAccount:r,removeIntegration:o,updateIntegration:s};return m}])},2375:function(e,n){angular.module("buzz").factory("bzIntegrationModel",["bzIntegrationsService","bzStore","cwConfigWizardValuesUtils",function(e,n,t){function a(){x.dirtyIntegrationName=!0}function i(e){x.handler=e}function s(){x.channelId=n.currentChannel.id,x.existingIntegrations=null,x.providers=null,T=!1,m()}function o(e){x.filteredList=_.sortBy(_.filter(x.providers,function(n){return n.name.toLowerCase().match(e.toLowerCase())||n.dataProviderKey.match(e.toLowerCase())}),function(e){return e.name.toLowerCase()}),m()}function r(e){x.step=3,_.each(e.integration.configurations,function(n,a){e.configurations[a]&&(n.configuration=t.setWizardSectionValues(n.configuration,e.configurations[a].configuration,e.validation))}),x.editingInstance=e,e.integration.integrationName=e.name,a(),_.each(e.integration.configurations,function(n){n.configuration.integrationId=e.integration.dataProviderKey}),x.currentIntegration=e.integration,x.currentIntegration.error=e.error,e.validation.errors&&(x.currentIntegration.errorMessage=e.validation.errors[0].errorMessage),x.handlerOptions=_.keys(x.currentIntegration.configurations).length,e.integration.configurations.PUSH?x.handler="PUSH":e.integration.configurations.PULL?x.handler="PULL":e.integration.configurations.SMTP?x.handler="SMTP":x.handler="COMMAND",m()}function c(e){if(e){var n=z(e);n&&(x.currentIntegration.integrationName=n,m())}}function l(){return x.providers||T?x.providers:(T=!0,void e.getIntegrationProviders().then(function(e){x.providers=e,x.filteredList=_.sortBy(_.toArray(e),function(e){return e.name.toLowerCase()}),m()}))}function d(n){e.removeIntegration(n),x.existingIntegrations=_.without(x.existingIntegrations,n),k(),m()}function u(){return x.existingIntegrations||x.instanceRequestInProgress?x.existingIntegrations:(x.instanceRequestInProgress=!0,m(),e.getExistingIntegrations().then(function(e){x.existingIntegrations=e.instances,k(),x.instanceRequestInProgress=!1,m()},function(e){x.instanceRequestInProgress=!1}),null)}function p(){x.step++,o(""),m()}function h(e){e||x.editingInstance?x.step=0:x.step--,x.currentIntegration&&w(x.currentIntegration),x.currentIntegration&&(x.currentIntegration=null),x.integrations&&(x.integrations=null,x.account=null),x.editingInstance=null,x.currentAccountName="",x.currentAccountId=null,x.dirtyIntegrationName=!1,o("")}function g(e){C.push(e)}function m(e,n){_.each(C,function(e){e()})}function b(){return u(),l(),x.channelId=n.currentChannel.id,x}function v(n){x.currentIntegration&&w(x.currentIntegration),x.dirtyIntegrationName=!1,e.getIntegrationDetails(n.id).then(function(e){x.currentIntegration=e,_.each(x.currentIntegration.configurations,function(e){e.configuration.integrationId=x.currentIntegration.dataProviderKey}),x.step=2,x.handlerOptions=_.keys(x.currentIntegration.configurations).length,x.currentIntegration.configurations.PUSH?x.handler="PUSH":x.currentIntegration.configurations.PULL?x.handler="PULL":x.currentIntegration.configurations.SMTP?x.handler="SMTP":x.handler="COMMAND",m()})}function f(){var n={};if(_.each(x.currentIntegration.configurations,function(e,a){var i=t.getValuesFromData(e.configuration);n[a]={},n[a].configuration=i}),n.dataProviderKey=x.currentIntegration.dataProviderKey,x.editingInstance){var a={id:x.editingInstance.id,channelId:x.channelId,integrationId:x.editingInstance.integration.id,createdBy:Domo.CurrentUser.USER_ID,domoUserId:Domo.CurrentUser.USER_ID,accountId:x.currentAccountId,name:x.currentIntegration.integrationName,modifiedAt:Date.now(),modifiedBy:Domo.CurrentUser.USER_ID,configurations:n||{}};return void e.updateIntegration(a).then(function(e){e.data.integration=x.editingInstance.integration,e.data.access=!0;for(var n=0;n<x.existingIntegrations.length;n++)x.existingIntegrations[n].id===e.data.id&&(x.existingIntegrations[n]=e.data);k(),m(),h(!0)})}var i={channelId:x.channelId,integrationId:x.currentIntegration.id,createdBy:Domo.CurrentUser.USER_ID,domoUserId:Domo.CurrentUser.USER_ID,accountId:x.currentAccountId,name:x.currentIntegration.integrationName,configurations:n||{}};e.saveNewIntegration(i).then(function(e){e.data.errors?(t.setWizardSectionValues(x.currentIntegration.configuration,n,e.data),m()):(e.data.access=!0,e.data.integration=x.currentIntegration,x.existingIntegrations.unshift(e.data),k(),w(x.currentIntegration),delete x.currentIntegration,x.editingInstance=null,m(),h(!0))})}function z(n){var t="";return _.each(n,function(n){_.each(n.configuration.steps,function(n){_.each(n.sections,function(n){n.value&&"accountId"===n.name&&(x.dirtyIntegrationName||x.dirtyIntegrationName&&n.value===x.currentAccountId?x.editingInstance||(x.currentIntegration.integrationName=y(x.currentIntegration.integrationName)):e.lookupAccount(n.value).then(function(e){x.currentAccountName=e.displayName,t=x.currentIntegration.name,t=t+" - "+e.displayName,t=y(t),x.currentIntegration.integrationName=t,m()}),x.currentAccountId=n.value)})})}),x.dirtyIntegrationName?void(x.editingInstance||(x.currentIntegration.integrationName=y(x.currentIntegration.integrationName))):(t=x.currentIntegration.name,x.currentAccountName&&(t=t+" - "+x.currentAccountName),t=y(t))}function y(e){return _.findWhere(x.existingIntegrations,{name:e})?parseInt(parseInt(e.substr(e.lastIndexOf(" ")+1,e.length)))?(e=e.replace(/([0-9]*)$/,parseInt(e.substr(e.lastIndexOf(" ")+1,e.length))+1),y(e)):(e+=" 2",y(e)):e}function w(e){x.editingInstance=null,e.integrationName=null,_.each(e.configurations,function(e){_.each(e.configuration.steps,function(e){_.each(e.sections,function(e){delete e.errorMessage,e.setInvalid=!1,e.valid=!0,e.value=null,e.userModified=!1})})})}function k(){var e=!1;_.each(x.existingIntegrations,function(n){"VALID"!==n.validation.state&&"NOT_VALIDATED"!==n.validation.state?(e=!0,n.error=!0):n.error=!1}),x.instanceError=e}var C=[],x={step:0,currentAccountName:"",filteredList:[],channelId:null,handler:null,instanceRequestInProgress:!1},T=!1,M={registerListener:g,updateModel:m,getModel:b,setIntegration:v,saveIntegration:f,backStep:h,forwardStep:p,removeIntegration:d,setName:c,editInstance:r,updateFilter:o,channelChanged:s,changeHandler:i,setIntegrationNameToDirty:a};return M}])},2376:function(e,n,t){angular.module("buzz").directive("bzEmailIntegration",["bzRootPath","bzIntegrationModel","ZeroClipboard",function(e,n,a){return{restrict:"E",replace:!0,template:t(2377),link:function(e,n,t){e.copied=!1,e.emailIntegrationName=e.model.currentIntegration.configuration.steps[0].sections?e.model.currentIntegration.configuration.steps[0].sections[0].value:"Email Bot","usps"===e.emailIntegrationName&&(e.emailIntegrationName="Email Bot");var i=n.find("#copyButton"),s=new a(i);s.on("copy",function(n){var t=n.clipboardData;t.setData("text/plain",e.model.channelId+"@domo.com"),e.copied=!0})}}}])},2377:function(e,n){e.exports='<div>\n<h4><span dm-i18n key=send-updates-to-email></span></h4>\n<div><span dm-i18n key=buzz/email-description></span></div>\n<div class=padding-vertical-small>\n<span ng-class="{\'color-gray-6\': copied}">{{model.channelId}}@domo.com</span>\n<a id=copyButton style=padding-left:15px ng-show=!copied><span dm-i18n key=buzz/copy-email></span></a>\n<i class="icon-check color-alert-green padding-left-medium" ng-show=copied></i>\n</div>\n<label class=config-section-label>\n<b class="color-gray-5 font-weight-semi-bold font-size-small text-transform-uppercase">\n<span dm-i18n key=buzz/bot-name></span>\n</b>\n</label>\n<div class="input margin-top-xxsmall">\n<input ng-model=emailIntegrationName type=text class=input />\n</div>\n<div class=margin-top-medium>\n<db-button theme=primary ng-click="saveIntegration({integrationName: emailIntegrationName})"><span dm-i18n key=common/save></span></db-button>\n<db-button ng-click=stepAction()><span dm-i18n key=common/cancel></span></db-button>\n</div>\n</div>\n'},2378:function(e,n,t){angular.module("buzz").directive("bzSideAccordion",["bzRootPath","dmI18n",function(e,n){return{replace:!0,restrict:"E",transclude:!0,template:t(2379),scope:{defaultOpen:"@",accordionTitle:"@",accordionMeta:"@?",onOpen:"=",disabled:"=",tooltipText:"=?"},link:function(e,t){e.disabled&&(t.find(".accordion-header").css({cursor:"default"}),t.find(".accordion-header").find("i").replaceWith('<span class="coming-soon"><i class="icon-clock-arrow color-gray-4"></i><span class="padding-left-xxsmall inline-block">'+n.get("domohome/coming-soon")+"</span></span>"));var a=t.find("bz-side-accordion-actions");a.length&&t.find(".accordion-header").append(a),e.toggle=!!e.defaultOpen,e.toggleAccordion=function(){e.disabled||(e.toggle=!e.toggle,_.isFunction(e.onOpen)&&e.onOpen())}}}}])},2379:function(e,n){e.exports='<div class=bz-side-accordion>\n<div class=accordion-header ng-click=toggleAccordion() ng-class="{closed: !toggle}">\n<span class="accordion-title bz-text-display-6 bold" db-tooltip={{tooltipText}} db-tooltip-max-width=400>{{ accordionTitle }}</span>\n<span ng-if=accordionMeta class="accordion-meta bz-text-caption secondary">{{ accordionMeta }}</span>\n<i class=icon-chevron-right ng-class="{\'toggled\': toggle}"></i>\n</div>\n<div class=accordion-content ng-show=toggle ng-transclude></div>\n</div>'},2380:function(e,n,t){var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};angular.module("buzz").directive("bzNewChatModal",["bzRootPath","bzService","bzStates","bzStore","bzModals","BootstrappedCurrentUser","dmCachedGroups","$q","$rootScope","Analytics","features","bzHelpers","dmUserService","dmUserState","dmUserInviteModalService","dmI18n","CurrentUserId","dmBootstrap",function(e,n,i,s,o,r,c,l,d,u,p,h,g,m,b,v,f,z){return{restrict:"E",template:t(2381),scope:{populatedUsers:"=?",populatedGroups:"=?",onCreate:"&?"},link:function(e,t,y){function w(){function n(){t.off("keydown",T)}ne(),e.groupChatFilters=[],e.haveResults=!1,e.displayTitle=!1,e.displayOptions=!1,e.searchResults=!0,e.selectedUsers=[],e.groups=[],e.groupChats=[],e.users=[],e.freeInvite=(ce||le)&&!p.on("no-buzz"),e.remove={waiting:!1,searching:!1},e.chat={accesses:[],defaultPermission:"INVITE_OTHERS",publicPermission:"NONE",title:"",description:""},e.inputField=t.find(".pill-box input"),e.currentUser={domoUserId:r.USER_ID,userRole:r.USER_ROLE},e.vm={},e.vm.chatSearchTerm="",e.vm.i18n={searchForPeople:v.get("buzz/search-for-people-groups-existing"),addTitle:v.get("buzz/add-title"),chatAbout:v.get("buzz/chat-about")},e.allowInviting=!0,e.search=_.debounce(R,250),e.openGroupChat=D,e.selectUser=S,e.deselectUser=P,e.createChat=G,e.cancelChat=J,e.addTitle=E,e.toggleOptions=O,e.inviteUser=A,e.disableTitle=C,e.disableSubmit=x,e.updatePrivacy=U,e.addTitle=E,ee(),setTimeout(function(){I(),t.on("keydown",T),e.$on("$destroy",n)},250)}function k(){_.defer(function(){he.scrollTop=he.scrollHeight})}function C(){return e.selectedUsers.length<=1}function x(){return"NONE"===e.chat.publicPermission&&e.selectedUsers.length<=0||"INVITE_OTHERS"===e.chat.publicPermission&&!e.chat.title.length||e.remove.waiting}function T(n){n&&(13==n.keyCode&&e.selectedUsers&&e.selectedUsers.length>0&&ge&&G(),13!=n.keyCode||ge||M(),38==n.keyCode&&(me=ge=!1,X()),40==n.keyCode&&(me=ge=!1,Q()),9==n.keyCode&&me?(me=!1,Q()):9==n.keyCode&&M())}function M(){if(se){var e=se.scope();_.isUndefined(e.user)?_.isUndefined(e.group)?_.isUndefined(e.chat)?A():D(e.chat):S(e.group):S(e.user)}}function I(){de.focus()}function $(){var e=angular.element("input.new-chat-title");e.focus()}function A(){b.open({element:de,prepop:e.vm.chatSearchTerm,message:v.get("common/invite-new-description"),analyticsEvent:"buzz_nav"}).result.then(function(n){n&&(Array.isArray(n)?e.selectedUsers=e.selectedUsers.concat(n):n||"object"!==("undefined"==typeof n?"undefined":a(n))||e.selectedUsers.push(n),I(),B())},function(e){I(),B()})}function S(n){for(var t=!0,a=0;a<e.selectedUsers.length;++a)e.selectedUsers[a].hasOwnProperty("value")&&e.selectedUsers[a].value==n.value?t=!1:e.selectedUsers[a].hasOwnProperty("id")&&e.selectedUsers[a].id==n.id&&(t=!1);t&&(me=ge=!0,e.selectedUsers.push(n),k(),B(),R(e.vm.chatSearchTerm)),I()}function P(n){var t=e.selectedUsers.indexOf(n);t>=0&&e.selectedUsers.splice(t,1),k(),R(e.vm.chatSearchTerm).then(function(e){I()})}function E(){return _.defer(function(){e.displayTitle?$():I(),e.$digest()}),e.displayTitle=!e.displayTitle}function O(){return _.defer(function(){u.track("buzz_conversation_toggle"),I(),e.$digest()}),e.displayOptions=!e.displayOptions}function U(){_.defer(function(){"INVITE_OTHERS"===e.chat.publicPermission&&$()})}function D(e){e.highlightedTitle=null,n.pinChannel(e),s.setCurrentChannel(e.id,void 0,!0).then(function(){i.messages()}),o.close("createChat")}function R(n,t){var a=l.defer();if(e.haveResults=!1,e.remove.searching=!0,e.searchingChannels=!0,e.vm.chatSearchTerm=n,n||t||(n=e.vm.chatSearchTerm),""===n||n){pe("buzz_people_add_chat_search",n);var i=j(n);i.usersGroups.then(function(n){e.users=n[0]||[],e.groups=n[1]||[],e.searchResults=e.users.length>0||e.groups.length>0,e.remove.searching=!1,me=!0,e.haveResults=!0,Z(),a.resolve()}),i.channels.then(function(n){e.groupChats=n[0]||[],e.channelSearchResults=e.groupChats.length>0,e.searchingChannels=!1})}else _.defer(function(){e.users=[],e.groups=[],e.groupChats=[],e.haveResults=!0,e.$digest()});return a.promise}function j(n){var t,a=n.toLowerCase(),i=[];return(0==e.selectedUsers.length||e.selectedUsers.length>0&&""!=n)&&(i.push(L(a)),i.push(N(a))),(e.selectedUsers.length>0||""!==n)&&(t=F(a)),{usersGroups:l.all(i),channels:l.all([t])}}function L(e){if(te&&te.resolve(),te=l.defer(),""===e)return g.getPagedUsers(25,0,null,te.promise).then(function(e){return e.map(function(e){return e.value=e.id,e.type="USER",e})});var t=0;return n.getUsers(e,10,null,te.promise).then(function(n){return n.map(function(n){return t=n.displayName.toLowerCase().indexOf(e),n.highlightedDisplayName=H(n.displayName,t,t+e.length),n})})}function N(n){var t=0;return c.filterForUser(n,e.currentUser).then(K).then(function(e){return e=e.splice(0,9),e.map(function(e){return t=e.displayName.toLowerCase().indexOf(n),e.highlightedDisplayName=H(e.displayName,t,t+n.length),e})})}function F(t){function a(){return e.groupChatFilters=[],e.selectedUsers.forEach(function(n){"USER"==n.type?e.groupChatFilters.push("USER:"+(n.value||n.id)):"GROUP"==n.type&&e.groupChatFilters.push("GROUP:"+(n.value||n.id))}),e.groupChatFilters}ae&&ae.resolve(),ae=l.defer();var i=a(),s={channelLimit:10,sortMode:"MOST_RECENT",filterMode:"CONTAINS_ALL",filters:i.toString(),accessFilterFlag:!0,channelTypes:["GROUP_CHAT","TOPIC"]};return n.getOtherConversations(t,s,ae.promise).then(function(e){var n=0;return e.channels.filter(function(e){return!(!e.title||""==e.title)&&(n=e.title.toLowerCase().indexOf(t),e.highlightedTitle=H(e.title,n,n+t.length),e)})})}function H(e,n,t){return[e.substring(0,n),e.substring(n,t),e.substring(t,e.length)]}function B(){e.vm.chatSearchTerm="",e.inputField.val("")}function G(){e.remove.waiting=!0;var t,a=[],r=[];_.map(e.selectedUsers,function(e){"USER"==e.type&&a.push(e.value),"Social"==e.role&&a.push(e.id),"GROUP"==e.type&&r.push(e.id)},[]),e.chat.accesses=[],e.chat.accesses.push.apply(e.chat.accesses,h.formatUsers(a)),e.chat.accesses.push.apply(e.chat.accesses,h.formatGroups(r)),t=1===a.length&&0===r.length||2===a.length&&_.contains(a,f)?V(a[0]):"NONE"===e.chat.publicPermission?q():W(),t.then(function(e){u.track("buzz_people_add_chat_preview"),e&&(Y(e),n.pinChannel(e),s.setCurrentChannel(e.id),o.close("createChat"),i.messages())})}function V(e){return n.getUserChannel(e)}function q(){return e.chat.defaultPermission="ADMIN",n.createGroup(e.chat)}function W(){return p.on("pendo")&&window.pendo&&window.pendo.isGuideShown()&&(d.$broadcast("domotalk-event-created"),m.markThatUserHasVisitedBuzz()),e.chat.title&&e.chat.title.length?n.createTopicChannel(e.chat):l.when()}function Y(n){u.track("buzz_new_chat_creation",{channel_id:n.id,channel_type:n.type}),_.has(y,"onCreate")&&e.onCreate({channel:n})}function J(){o.close("createChat")}function K(e){return _.map(e,function(e){return{id:e.id,displayName:e.name||e.displayName,customIcon:"icon-people",trackById:"GROUP_"+e.id,type:"GROUP"}})}function Z(){ie=void 0,re=void 0,se=void 0,oe=void 0}function Q(){_.isUndefined(ie)&&(ie=angular.element(".bz-new-chat-items li")),_.isUndefined(re)?(re=0,se=angular.element(ie[re]),se.addClass("selected")):re<ie.length-1?(oe=se,oe.removeClass("selected"),re++,se=angular.element(ie[re]),se.addClass("selected"),se[0].getBoundingClientRect().bottom-ue[0].getBoundingClientRect().bottom>0&&(ue[0].scrollTop+=se[0].getBoundingClientRect().bottom-ue[0].getBoundingClientRect().bottom)):re==ie.length-1&&ie.length>1&&(re=-1,ue[0].scrollTop=0,Q())}function X(){_.isUndefined(ie)&&(ie=angular.element(".bz-new-chat-items li")),_.isUndefined(re)?(re=ie.length-1,se=angular.element(ie[re]),se.addClass("selected"),se[0].getBoundingClientRect().top-ue[0].getBoundingClientRect().top>0&&(ue[0].scrollTop-=(se[0].getBoundingClientRect().top-ue[0].getBoundingClientRect().top)*-1)):re>0?(oe=se,oe.removeClass("selected"),re--,se=angular.element(ie[re]),se.addClass("selected"),se[0].getBoundingClientRect().top-ue[0].getBoundingClientRect().top<0&&(ue[0].scrollTop-=(se[0].getBoundingClientRect().top-ue[0].getBoundingClientRect().top)*-1)):0==re&&ie.length>1&&(re=ie.length,ue[0].scrollTop=ue[0].scrollHeight,X())}function ee(){_.has(y,"populatedUsers")&&(e.$watchCollection("populatedUsers",function(n,t){n&&n.length&&g.getUsers(n).then(function(n){_.each(n,function(n){n.type="USER",n.value=n.id,e.selectedUsers.push(n)})})}),_.has(y,"populatedGroups")&&e.$watchCollection("populatedGroups",function(n,t){n&&n.length&&c.getByIds(n).then(function(n){_.each(n,function(n){n.type="GROUP",n.value=n.id,e.selectedUsers.push(n)})})}))}function ne(){p.on("free-role")&&n.getAllowInviteSettingStatus().then(function(n){e.allowInviting=n.data.enabled;
})}var te,ae,ie,se,oe,re,ce=p.on("free-invite")&&p.on("free-role"),le="free"==z.data.customerTier||"trial"==z.data.customerTier,de=angular.element(".bz-modal-new-chat-wrapper .search-pillbox-wrapper input"),ue=angular.element(".results-wrapper"),pe=_.debounce(function(e,n){n&&n.length&&u.track(e,{search_term:n})},1250),he=t.find(".bz-modal-new-chat-wrapper .pill-box")[0],ge=!1,me=!0;w()}}}])},2381:function(e,n){e.exports='<db-modal-header>\n<span class=bz-text-display-4 dm-i18n=buzz/start-a-chat-find-existing></span>\n</db-modal-header>\n<db-modal-body>\n<div class=bz-modal-new-chat-wrapper>\n<div class=search-box>\n<div class="search-pillbox-wrapper margin-top-xsmall" db-dropdown selected-items=$parent.selectedUsers search-term=vm.chatSearchTerm on-search=search(searchTerm) on-item-selected=selectUser(item) on-item-removed="deselectUser(item, selectedItems)" label-attribute=displayName placeholder-text={{::vm.i18n.searchForPeople}}>\n<db-dropdown-pill-box></db-dropdown-pill-box>\n<i class=icon-search></i>\n</div>\n</div>\n<div class=results-wrapper ng-class="{\'show-options\':displayOptions}">\n<span class=searching-spinner ng-if=remove.searching>\n<span class="spinner large"></span>\n</span>\n<ul ng-if=!remove.searching class="channel-list bz-new-chat-items">\n<li class="bz-chat-modal-user-results buzz-invite-user-item" ng-if="haveResults && freeInvite && allowInviting" ng-click=inviteUser()>\n<div class=list-item>\n<div class=left-content>\n<div class=buzz-invite-new-user-icon>\n<i class="icon-person-plus _24"></i>\n</div>\n<div class=content>\n<div class="bz-text-display-6 bold" dm-i18n=buzz/add-new-contact></div>\n</div>\n</div>\n</div>\n</li>\n<li class=bz-chat-modal-user-results ng-repeat="user in users | orderBy: \'displayName\' track by $index" ng-click=selectUser(user)>\n<div class=list-item>\n<div class=left-content>\n<div class=image>\n<div dm-avatar-widget={{user.value}} no-tooltip=true class=bz-avatar size=large show-status=true></div>\n</div>\n<div class=content>\n<div class="bz-text-display-6 bold" ng-hide=user.highlightedDisplayName>{{user.displayName}}</div>\n<div class="bz-text-display-6 bold" ng-show=user.highlightedDisplayName>\n<span>{{user.highlightedDisplayName[0]}}</span><em>{{user.highlightedDisplayName[1]}}</em><span>{{user.highlightedDisplayName[2]}}</span>\n</div>\n</div>\n</div>\n</div>\n</li>\n<li class=bz-chat-modal-user-results ng-repeat="group in groups | orderBy: \'displayName\' track by $index" ng-click=selectUser(group)>\n<div class=list-item>\n<div class=left-content>\n<div class="image group-icon">\n<i class="icon-people _24"></i>\n</div>\n<div class=content>\n<div class="bz-text-display-6 bold" ng-hide=group.highlightedDisplayName>{{group.displayName}}</div>\n<div class="bz-text-display-6 bold" ng-show=group.highlightedDisplayName>\n<span>{{group.highlightedDisplayName[0]}}</span><em>{{group.highlightedDisplayName[1]}}</em><span>{{group.highlightedDisplayName[2]}}</span>\n</div>\n</div>\n</div>\n</div>\n</li>\n<li class=bz-chat-modal-group-spinner ng-if=searchingChannels>\n<span class="spinner medium"></span>\n</li>\n<li class=bz-chat-modal-group-results ng-repeat="groupChat in groupChats">\n<div class=list-item>\n<div class=left-content>\n<div class="image group-chat-icon">\n<bz-conversation-icon bz-channel=::groupChat></bz-conversation-icon>\n</div>\n<div class=content>\n<div class="bz-text-body secondary">\n<div class="bz-text-display-6 bold bz-text-overflow" ng-hide=groupChat.highlightedTitle>groupChat.title</div>\n<div class="bz-text-display-6 bold bz-text-overflow" ng-show=groupChat.highlightedTitle>\n<span>{{groupChat.highlightedTitle[0]}}</span><em>{{groupChat.highlightedTitle[1]}}</em><span>{{groupChat.highlightedTitle[2]}}</span>\n</div>\n<span dm-i18n=buzz/message-count data="{replies: groupChat.replyCount}"></span>\n</div>\n</div>\n</div>\n<div class=right-content>\n<div class=actions>\n<db-button ng-click=(openGroupChat(groupChat)) dm-i18n=buzz/view></db-button>\n</div>\n</div>\n</div>\n</li>\n</ul>\n<div class=no-results-wrapper ng-if="!searchResults && !channelSearchResults && !searchingChannels && !remove.searching">\n<div class="bz-text-display-3 no-results-message" dm-i18n=buzz/no-results-found></div>\n</div>\n</div>\n<div class=chat-options-wrapper ng-if=displayOptions>\n<span class="content sub-header" dm-i18n=buzz/options></span>\n<div class="content section-heading" dm-i18n=buzz/privacy></div>\n<div class=privacy-input>\n<db-radio-button model=chat.publicPermission on-change=updatePrivacy() value=NONE></db-radio-button>\n<div class=privacy-label>\n<span dm-i18n=buzz/is-private-conversation></span>\n<div class=privacy-description dm-i18n=buzz/is-private-description></div>\n</div>\n</div>\n<div class=privacy-input>\n<db-radio-button model=chat.publicPermission on-change=updatePrivacy() value=INVITE_OTHERS></db-radio-button>\n<div class=privacy-label>\n<span dm-i18n=buzz/is-public-conversation></span>\n<div class=privacy-description dm-i18n=buzz/is-public-description></div>\n</div>\n</div>\n<div class="content section-heading" dm-i18n=buzz/subject></div>\n<input type=text class="new-chat-title margin-top-xxsmall input cursor-pointer" ng-model=chat.title ng-model-options="{debounce: { \'default\': 100, \'blur\': 0 }}" placeholder={{vm.i18n.chatAbout}}>\n<div class=new-chat-title-description dm-i18n=buzz/new-chat-title-description></div>\n</div>\n<div class=chat-title-wrapper ng-if=displayTitle>\n<div class="content section-heading" dm-i18n=buzz/chat-name></div>\n<input type=text class="new-chat-title margin-top-xxsmall input cursor-pointer" ng-model=chat.title ng-model-options="{debounce: { \'default\': 100, \'blur\': 0 }}" placeholder={{vm.i18n.addTitle}}>\n</div>\n</div>\n</db-modal-body>\n<db-modal-footer>\n<span ng-if=remove.waiting>\n<span class="spinner small"></span>\n</span>\n<db-button class=new-chat-name-button ng-hide=displayOptions ng-click=toggleOptions() dm-i18n=buzz/show-options></db-button>\n<db-button class=new-chat-name-button ng-show=displayOptions ng-click=toggleOptions() dm-i18n=buzz/hide-options></db-button>\n<db-button ng-click=cancelChat() dm-i18n=buzz/cancel></db-button>\n<db-button class=new-chat-start-button ng-disabled=disableSubmit() theme=primary ng-click=createChat() dm-i18n=start></db-button>\n</db-modal-footer>\n'},2382:function(e,n,t){angular.module("buzz").directive("bzNewChannelModal",["bzRootPath","bzMessageService","bzService","bzStates","bzStore","bzEvents","$timeout","bzModals","dmI18n","$filter","features","Analytics",function(e,n,a,i,s,o,r,c,l,d,u,p){return{restrict:"E",template:t(2383),scope:!0,link:function(e,n,t){function r(){e.store=s,e.isSearching=!1,e.searchType=k="Cards",e.search=_.debounce(b,350),e.newChannel=f,e.openChannel=g,e.toggleChannel=m,e.previewChannel=z,e.clearField=h,e.setSearchType=v,e.vm={},u(),e.searchPlaceholder=e.vm.i18n["search"+k],w=n.find(".search-channels"),y=o.stateChange.on(h),e.$on("$destroy",y),b("").then(function(){e.initialChanneCount=e.channels.length})}function u(){e.vm.i18n={searchChannels:l.get("buzz/search-channels"),searchCards:l.get("buzz/search-card-channels"),searchPages:l.get("buzz/search-page-channels"),pin:l.get("buzz/pin"),pinned:l.get("buzz/pinned"),invited:l.get("buzz/invited"),ignore:l.get("buzz/ignore"),unpin:l.get("buzz/unpin"),preview:l.get("buzz/preview"),noResultsFound:l.get("buzz/no-results-found"),clearSearch:l.get("buzz/clear-search"),view:l.get("buzz/view")}}function h(){i.states.indexOf("new-channel")===-1&&(w.val(""),e.searchTerm="",b("",!0))}function g(e){e.isThread()?s.setCurrentChannel(e.channelId,void 0,!0).then(function(){s.setCurrentThread(e)}):s.setCurrentChannel(e.id,void 0,!0).then(function(e){i.messages()})}function m(e){return e.isThread()?a.storeChannelById(e.channelId).then(function(e){m(e)}):void(s.channels[e.id]&&s.channels[e.id].pin?(a.unpinChannel(e),e.id===s.currentChannel.channelId&&s.nextChannel(1)):a.pinChannel(e))}function b(n,t){e.isSearching=!0,e.channels=[],""===n&&setTimeout(function(){w[0].focus()},150),n||t||(n=e.searchTerm);var i=function(){switch(k){case"Cards":return a.cardSearch;case"Pages":return a.pageSearch;case"Activity":case"Channels":default:return a.channelSearch}}();return"Activity"===k?i(n,50,["TOPIC","OBJECT_CHAT","HUDDLE"],{messageLimit:3,includeMessages:!0,sortMode:"MOST_RECENT_EXCLUDING_HUDDLES",showEmptyChannels:!1}).then(function(n){e.channels=n,e.isSearching=!1}):("Cards"!==k&&"Pages"!==k||C("buzz_data_add_chat_search",n),i(n,50,"TOPIC").then(function(n){e.channels=d("orderBy")(n,["title","displayName"]),e.isSearching=!1}))}function v(t){k!==t&&(k=t,e.channels=[],e.searchPlaceholder=e.vm.i18n["search"+t],n.find(".search-channels").focus(),b().then(function(){e.searchType=k}))}function f(){c.close("newChannel"),c.open("createChannel")}function z(n){if(p.track("buzz_data_add_chat_preview"),"Channels"!==e.searchType&&"Activity"!==e.searchType){var t={type:"Cards"===e.searchType?"CARD":"PAGE",id:n.id};a.createObjectChannel(t).then(function(e){g(e),c.close("newChannel")})}else g(n),c.close("newChannel")}var y,w,k,C=_.debounce(function(e,n){n&&n.length&&p.track(e,{search_term:n})},1250);r()}}}])},2383:function(e,n){e.exports='<db-modal-header>\n<div class=search-box>\n<span ng-if="searchType === \'Channels\' || searchType === \'Activity\'" class=bz-text-display-4 dm-i18n=buzz/browse-channels></span>\n<span ng-if="searchType === \'Cards\'" class=bz-text-display-4 dm-i18n=buzz/browse-card-channels></span>\n<span ng-if="searchType === \'Pages\'" class=bz-text-display-4 dm-i18n=buzz/browse-page-channels></span>\n<span class=search-input>\n<i class=icon-search></i>\n<input autofocus=true type=text class="input search-channels" ng-model=$parent.$parent.searchTerm ng-model-options="{debounce: { \'default\': 100, \'blur\': 0 }}" ng-change=search() placeholder={{searchPlaceholder}}>\n<i class="icon-x-circle sm" ng-click=clearField() ng-if="$parent.$parent.searchTerm.length > 0"></i>\n</span>\n</div>\n<div class=search-tabs>\n<db-tabs active-tab=bits.selectedTab on-active-tab-change=bits.onSelectedTab(tab)>\n<db-tab name=searchCards ng-click="setSearchType(\'Cards\')" dm-i18n=buzz/cards></db-tab>\n<db-tab name=searchPages ng-click="setSearchType(\'Pages\')" dm-i18n=buzz/pages></db-tab>\n</db-tabs>\n</div>\n</db-modal-header>\n<db-modal-body class=dm-animate>\n<div ng-if="(initialChanneCount < 5)" class="bz-text-body secondary bz-text-italics margin-top-small margin-bottom-large" dm-i18n=buzz/no-channels-in-channelModal></div>\n<ul class=channel-list>\n<li ng-repeat="channel in channels">\n<div class=list-item>\n<div class=left-content>\n<div class=image>\n<i ng-if="(channel.type === \'Topic\' || channel.parentChannelType === \'TOPIC\') && channel.publicPermission === \'NONE\'" class="icon-lock-closed _24"></i>\n<i ng-if="(channel.type === \'Topic\' || channel.parentChannelType === \'TOPIC\') && channel.publicPermission !== \'NONE\'" class="icon-chat-bubbles _24"></i>\n<i ng-if="channel.objectType === \'CARD\' || channel.parentObjectType === \'CARD\' || searchType === \'Cards\'" class="icon-chart-bar-vertical _24"></i>\n<i ng-if="channel.objectType === \'PAGE\' || channel.parentObjectType === \'PAGE\' || searchType === \'Pages\'" class="icon-pages-bars _24"></i>\n<i ng-if="channel.objectType === \'PROJECT\' || channel.parentObjectType === \'PROJECT\'" class="icon-project _24"></i>\n<dynamic-avatar-group ng-if="channel.type === \'GroupChat\' || channel.parentChannelType === \'GROUP_CHAT\'" accesses=channel.accesses options=avatarGroupOptions></dynamic-avatar-group>\n</div>\n<div class=content>\n<div class="bz-text-display-6 bold title">{{channel.title || channel.displayName}}</div>\n<div ng-if="searchType === \'Channels\'" class="bz-text-body secondary channel-description">{{channel.description}}</div>\n<div ng-if="searchType === \'Channels\'" class="bz-text-body secondary">\n<span dm-i18n=buzz/num-people data="{ count: channel.formattedPinnedCount }"></span>\n<span dm-i18n=buzz/num-messages data="{ count: channel.formattedReplyCount }"></span>\n</div>\n<div ng-if="(!channel.title && !channel.displayName) && channel.type == \'Huddle\'" class="bz-text-display-6 bold" dm-i18n=buzz/thread></div>\n<div ng-if="channel.type == \'Huddle\' && channel.parentChannelTitle" class="title sub-title" dm-i18n=buzz/in-channel-no-quotes data="{channelName: channel.parentChannelTitle}"></div>\n</div>\n</div>\n<div class=right-content>\n<div class=actions>\n<db-button stateful=true stateful-manual=true stateful-state-active="{{ store.channels[channel.channelId].pin ? \'true\' : \'false\' }}" ng-if="searchType === \'Channels\' || searchType === \'Activity\'" ng-click=toggleChannel(channel)>\n<div state-off="">\n<i class=icon-plus></i>\n<span>{{::vm.i18n.pin}}</span>\n</div>\n<div state-on="">\n<i class=icon-check></i>\n<span ng-if="store.channels[channel.channelId].pin && !store.channels[channel.channelId].invited">{{::vm.i18n.pinned}}</span>\n<span ng-if="store.channels[channel.channelId].pin && store.channels[channel.channelId].invited">{{::vm.i18n.invited}}</span>\n</div>\n<div state-on-and-hover="">\n<i class=icon-x></i>\n<span ng-if="store.channels[channel.channelId].pin && !store.channels[channel.channelId].invited">{{::vm.i18n.unpin}}</span>\n<span ng-if="store.channels[channel.channelId].pin && store.channels[channel.channelId].invited">{{::vm.i18n.ignore}}</span>\n</div>\n</db-button>\n<db-button ng-click=previewChannel(channel)>{{::vm.i18n.preview}}</db-button>\n</div>\n</div>\n</div>\n<div>\n<div ng-if="searchType === \'Activity\' && channel.messages.length" class=channel-messages>\n<div class=caret></div>\n<div ng-repeat="msg in channel.messages.slice().reverse() track by msg.id" class=channel-message>\n<span class=avatar ng-if=!msg.createdBy.iconUrl dm-avatar-widget={{msg.createdById}} size=micro></span>\n<span class=tp-avatar ng-if=msg.createdBy.iconUrl><img ng-src={{::msg.createdBy.iconUrl}}></span>\n<div class=message-content>\n<div class=message-header>\n<span>{{msg.createdBy.displayName}}</span>\n<span dm-moment={{msg.created}} format=lll class="bz-text-body secondary"></span>\n</div>\n<span ng-if="!msg.content.text.length && msg.attachments.length" class="bz-text-italics secondary" dm-i18n=buzz/attachment-posted></span>\n<bz-markup-renderer class="bz-text-body secondary" content=msg.content></bz-markup-renderer>\n</div>\n</div>\n</div>\n</div>\n</li>\n</ul>\n<div ng-if=!channels.length class=channel-list-empty ng-switch=isSearching>\n<div ng-switch-when=false class=content>\n<div class=bz-text-display-3>{{::vm.i18n.noResultsFound}}</div>\n<db-button ng-click=clearField()>{{::vm.i18n.clearSearch}}</db-button>\n</div>\n<div ng-switch-when=true class=content>\n<span class="spinner large"></span>\n</div>\n</div>\n</db-modal-body>\n'},2384:function(e,n,t){angular.module("buzz").directive("bzCreateChannelModal",["bzRootPath","bzService","bzStates","bzEvents","bzStore","bzModals","dmI18n","Analytics","$rootScope","dmUserState","features",function(e,n,a,i,s,o,r,c,l,d,u){return{restrict:"E",scope:{},template:t(2385),link:function(e,t,p){function h(){g(),b(),e.disabled=z,e.createChannel=y,e.cancel=k,e.focusPeopleInput=v,m(),e.$on("$destroy",C)}function g(){e.channel={},e.channel.title="",e.channel.description="",e.channel.defaultPermission="INVITE_OTHERS",e.channel.publicPermission="INVITE_OTHERS",e.channel.accesses=[],e.groups=[],e.users=[],e.vm={},e.nameLength=32,e.descLength=140}function m(){e.vm.i18n={channelDescription:r.get("buzz/channel-description"),channelName:r.get("buzz/channel-name"),inviteSomeone:r.get("buzz/invite-someone")}}function b(){setTimeout(function(){x.focus()},150)}function v(){setTimeout(function(){t.find("input[db-autogrow-input]").focus()},100)}function f(){a.states.indexOf("create-group")===-1&&g()}function z(){return void 0===e.channel.title||""===e.channel.title||e.saving}function y(){u.on("pendo")&&window.pendo&&window.pendo.isGuideShown()&&(l.$broadcast("domotalk-event-created"),d.markThatUserHasVisitedBuzz()),e.saving=!0,w(),n.createTopicChannel(e.channel).then(function(n){"NONE"===e.channel.publicPermission?c.track("buzz_new_channel_creation_private",{channel_id:n.id,channel_type:n.type}):c.track("buzz_new_channel_creation",{channel_id:n.id,channel_type:n.type}),s.setCurrentChannel(n.id),a.messages(),o.close("createChannel")})}function w(){var n,t=[];for(n=0;n<e.users.length;n++){var a=e.users[n];t.push({type:"USER",id:a})}for(n=0;n<e.groups.length;n++){var i=e.groups[n];t.push({type:"GROUP",id:i})}e.channel.accesses=t}function k(){o.close("createChannel"),g()}var C=i.stateChange.on(f),x=t.find(".room-name");h()}}}])},2385:function(e,n){e.exports='<db-modal-header>\n<div class=bz-text-display-4 dm-i18n=buzz/new-channel></div>\n</db-modal-header>\n<db-modal-body>\n<p dm-i18n=buzz/create-channel-description></p>\n<div class=room>\n<div class="input-container input-container-text">\n<input class="room-name input" type=text ng-model=channel.title maxlength={{nameLength}} placeholder={{::vm.i18n.channelName}} />\n<span class=char-limit>{{nameLength - channel.title.length}}</span>\n</div>\n<div class="input-container input-container-textarea">\n<textarea class="room-desc input" ng-model=channel.description maxlength={{descLength}} placeholder={{::vm.i18n.channelDescription}}></textarea>\n<span class=char-limit>{{descLength - channel.description.length}}</span>\n</div>\n</div>\n<div class="accesses margin-bottom-small" ng-if="channel.publicPermission === \'NONE\'">\n<div class="bz-text-label secondary margin-bottom-xxsmall">Invite people to this channel</div>\n<div class=user-input dm-user-select multi-select=true groups=$parent.$parent.groups users=$parent.$parent.users max-results=8 show-defaults-on-focus=false no-results-message=false avatar-click-off=false on-change=focusPeopleInput() allow-at-mention=true placeholder-text={{i18n.inviteSomeone}}></div>\n</div>\n<div class=privacy>\n<label class="bz-text-label secondary" dm-i18n=buzz/privacy></label>\n<span class="bz-text-body secondary block margin-top-xxsmall" dm-i18n=buzz/new-channel-privacy-text></span>\n<div class=privacy-option>\n<db-radio-button model=channel.publicPermission value=INVITE_OTHERS></db-radio-button>\n<div>\n<span class=block dm-i18n=buzz/make-channel-public></span>\n<span class="bz-text-body secondary block margin-top-xxsmall" dm-i18n=buzz/new-channel-privacy-text-public></span>\n</div>\n</div>\n<div class="privacy-option margin-top-small">\n<db-radio-button model=channel.publicPermission value=NONE></db-radio-button>\n<div>\n<span class=block dm-i18n=buzz/make-channel-private></span>\n<span class="bz-text-body secondary block margin-top-xxsmall" dm-i18n=buzz/new-channel-privacy-text-private></span>\n</div>\n</div>\n</div>\n</db-modal-body>\n<db-modal-footer>\n<span ng-if=saving class="spinner small"></span>\n<db-button ng-click=cancel() theme=alt size=large dm-i18n=buzz/cancel></db-button>\n<db-button size=large theme=primary ng-disabled=disabled() ng-click=createChannel() dm-i18n=buzz/create></db-button>\n</db-modal-footer>\n'},2386:function(e,n,t){angular.module("buzz").directive("bzLeaveConversationModal",["bzRootPath","bzService","bzModals","bzStore",function(e,n,a,i){return{template:t(2387),restrict:"E",link:function(e){function n(){i.unpinChannel(e.modalOptions.channel).then(function(){angular.element('.tooltip[role="tooltip"]').remove()}),e.modalOptions.channel.id===i.currentChannel.channelId&&i.nextChannel(1),a.close("leaveConversation")}function t(){a.close("leaveConversation")}e.confirm=n,e.cancel=t}}}])},2387:function(e,n){e.exports="<db-modal-header>\n<div class=bz-text-display-4 dm-i18n=buzz/leave-conversation></div>\n</db-modal-header>\n<db-modal-body>\n<p class=bz-text-body dm-i18n=buzz/leave-conversation-body></p>\n</db-modal-body>\n<db-modal-footer>\n<db-modal-buttons>\n<db-button size=large ng-click=confirm() theme=danger dm-i18n=confirm></db-button>\n<db-button ng-click=cancel() theme=alt size=large dm-i18n=cancel></db-button>\n</db-modal-buttons>\n</db-modal-footer>"},2388:function(e,n,t){angular.module("buzz").directive("bzDeleteChannelModal",["bzRootPath","bzService","bzModals","bzStore","dmI18n","bzUserListFactory","bzPeopleHelper","$filter","Analytics",function(e,n,a,i,s,o,r,c,l){return{template:t(2389),restrict:"E",scope:{channel:"="},link:function(e){function t(){e.publicChannel=e.channel.isPublicSomehow(),i(),e.publicChannel||d()}function i(){e.vm.i18n={deleteConversation:s.get("buzz/delete-conversation"),peopleAffected:s.get("buzz/people-affected"),cancel:s.get("buzz/cancel"),delete:s.get("buzz/delete"),publicConversation:s.get("buzz/public-conversation",{type:m})},e.publicChannel&&(e.vm.i18n.deleteConversationSubtext=s.get("buzz/delete-public-conversation-subtext",{type:m}))}function d(){e.scrollLoader=o.getUserAccessesScrollLoader(e.channel.id,30,0,void 0,"Huddle"===e.channel.type),e.scrollLoader.nextPage().then(function(n){e.vm.i18n.deleteConversationSubtext=s.get("buzz/delete-conversation-subtext",{type:m,total:n.total}),e.loadingPeople=!1,p(n,n.total)})}function u(){e.scrollLoader.nextPage().then(function(e){null!==e&&p(e,e.total)})}function p(n,t){n&&(n=r.processPeople(n,e.channel.type),_.each(n,function(n){e.users.push(n)}),e.userTotal=c("number")(t))}function h(t){function i(){switch(t.type){case"DirectChat":l.track("buzz_channel_deleted_direct",{channel_id:t.id,channel_type:t.type});break;case"GroupChat":l.track("buzz_channel_deleted_group",{channel_id:t.id,channel_type:t.type});break;case"Topic":e.channel.isPrivateChannel()?l.track("buzz_channel_deleted_private_channel",{channel_id:t.id,channel_type:t.type}):l.track("buzz_channel_deleted_public_channel",{channel_id:t.id,channel_type:t.type});break;case"ObjectChat":l.track("buzz_channel_deleted_object_channel",{channel_id:t.id,channel_type:t.type});break;case"Huddle":l.track("buzz_channel_deleted_thread",{channel_id:t.id,channel_type:t.type,parent_channel_type:t.parentChannel.type})}}return i(),e.showSpinner=!0,e.errorDeleting=!1,n.deleteChannel(t.id).then(function(){a.close("deleteChannel")},function(){e.showSpinner=!1,e.errorDeleting=!0})}function g(){a.close("deleteChannel")}var m="Huddle"===e.channel.type?s.get("buzz/thread").toLowerCase():s.get("buzz/conversation").toLowerCase();e.vm={},e.errorDeleting=!1,e.showSpinner=!1,e.loadingPeople=!0,e.publicChannel=!1,e.users=[],e.onDelete=h,e.onCancel=g,e.onScroll=u,t()}}}])},2389:function(e,n){e.exports='<db-modal-header>\n<div class=bz-text-display-4>{{vm.i18n.deleteConversation}}</div>\n</db-modal-header>\n<db-modal-body>\n<p class=bz-text-body>{{::vm.i18n.deleteConversationSubtext}}</p>\n<div class=people-affected>\n<div class=message-label>{{::vm.i18n.peopleAffected}}</div>\n<div class="spinner medium" ng-if="loadingPeople && !publicChannel"></div>\n<div class=people-list-container>\n<div ng-if=publicChannel class=people-list-public>{{::vm.i18n.publicConversation}}</div>\n<ul ng-if=!publicChannel class=people-list dm-infinite-scroll=onScroll()>\n<li ng-repeat="user in users track by user.id" class=user-list-item>\n<bz-user-list-item id="{{ user.id }}" type="{{ user.type }}" name="{{ user.DISPLAY }}">\n</bz-user-list-item>\n</li>\n</ul>\n</div>\n</div>\n</db-modal-body>\n<db-modal-footer>\n<div class=footer-wrapper>\n<div ng-if=errorDeleting class="error-message error-banner margin-bottom-small">\n<i class="icon-exclamation-triangle color-alert-yellow"></i>\n<span dm-i18n=buzz/error-deleting-channel></span>\n</div>\n<span ng-if=showSpinner class="spinner medium margin-right-medium"></span>\n<span class=action-buttons>\n<db-button class=buttons ng-click=onCancel() theme=alt dm-i18n=cancel></db-button>\n<db-button class=buttons ng-click=onDelete(channel) theme=danger dm-i18n=delete ng-disabled=showSpinner></db-button>\n</span>\n</div>\n</db-modal-footer>\n'},2390:function(e,n,t){angular.module("buzz").directive("bzZeroState",["bzRootPath","bzStates",function(e,n){return{replace:!0,restrict:"E",template:t(2391),scope:{},link:function(e,t,a){e.goToZeroState=function(){n.zeroState()}}}}])},2391:function(e,n){e.exports='<div class="bz-zero-state pane" ng-click=goToZeroState()>\n<div class=pane-header>\n<bz-main-header></bz-main-header>\n</div>\n<div class=pane-body>\n<div class=text-align-center>\n<div class=font-weight-bold dm-i18n=buzz/welcome-to-buzz></div>\n<div class=font-weight-bold dm-i18n=buzz/start-or-join-chat></div>\n</div>\n</div>\n</div>\n'},2392:function(e,n,t){angular.module("buzz").directive("bzRemoveUserModal",["bzRootPath","dmI18n",function(e,n){return{restrict:"E",template:t(2393),scope:{onRemove:"=?",onCancel:"=",userToRemove:"=?"},link:function(e){}}}])},2393:function(e,n){e.exports='<db-modal-header>\n<div class=bz-text-display-4 dm-i18n=buzz/remove-from-conversation></div>\n</db-modal-header>\n<db-modal-body>\n<p class=bz-text-body dm-i18n=buzz/remove-user-check data="{userName: userToRemove.DISPLAY}"></p>\n</db-modal-body>\n<db-modal-footer>\n<db-modal-buttons>\n<db-button size=large ng-click=onRemove() theme=danger dm-i18n=remove>\n</db-button>\n<db-button ng-click=onCancel() theme=alt size=large dm-i18n=cancel></db-button>\n</db-modal-buttons>\n</db-modal-footer>'},2394:function(e,n,t){angular.module("buzz").directive("bzInviteToDirectModal",["bzRootPath",function(e){return{restrict:"E",template:t(2395),scope:{onStart:"&",onCancel:"&",users:"=",groups:"=?"},link:function(e){function n(){}n()}}}])},2395:function(e,n){e.exports='<db-modal-header>\n<div class=bz-text-display-4 dm-i18n=buzz/start-new-chat-header></div>\n</db-modal-header>\n<db-modal-body>\n<p class=bz-text-body dm-i18n=buzz/start-new-chat-desc></p>\n<div ng-repeat="user in users" class=margin-vertical-xsmall>\n<span dm-avatar-widget={{user}} size=nano show-user-name=true></span>\n</div>\n<div ng-if="groups && groups.length" ng-repeat="group in groups" class=margin-vertical-xsmall>\n<span dm-avatar-group-widget=group size=nano show-group-name=true show-member-count=true></span>\n</div>\n</db-modal-body>\n<db-modal-footer>\n<db-modal-buttons>\n<db-button size=large ng-click=onStart() theme=primary dm-i18n=buzz/start-new-chat>\n</db-button>\n<db-button ng-click=onCancel() theme=alt size=large dm-i18n=cancel></db-button>\n</db-modal-buttons>\n</db-modal-footer>'},2396:function(e,n,t){angular.module("buzz").directive("bzNoChannelAccessModal",["bzRootPath","dmI18n","bzModals",function(e,n,a){return{restrict:"E",template:t(2397),scope:{statusCode:"="},link:function(e){function t(){e.cancel=o,e.statusCode=e.statusCode||403,i()}function i(){e.text={accessDenied:n.get("buzz/access-denied"),noAccessDialog:s(e.statusCode),close:n.get("common/close")}}function s(e){switch(e){case 404:return n.get("buzz/channel-not-found");case 403:return n.get("buzz/no-access-dialog")}}function o(){a.close("noChannelAccess")}t()}}}])},2397:function(e,n){e.exports='<db-modal-header>\n<div class=bz-text-display-4>\n{{ :: text.accessDenied }}\n</div>\n</db-modal-header>\n<db-modal-body>\n<div class="bz-text-body bz-no-access-text-padding">\n{{ :: text.noAccessDialog }}\n</div>\n<div class=text-align-right>\n<db-button ng-click=cancel() theme=alt>\n{{ :: text.close }}\n</db-button>\n</div>\n</db-modal-body>\n'},2398:function(e,n,t){angular.module("buzz").directive("bzShareLinkModal",["bzRootPath","dmI18n","bzService",function(e,n,a){return{restrict:"E",template:t(2399),scope:{channel:"="},link:function(e,n){function t(){e.channel&&e.channel.url||a.getChannelUrl(e.channel.id).then(function(n){e.channel.url=n}),e.copyUrlToClipboard=i}function i(){window.getSelection().removeAllRanges(),n.find("input").select(),window.getSelection();var t=document.execCommand("copy");t&&(e.copied=!0,_.delay(function(){e.copied=!1,e.$digest()},1600)),window.getSelection().removeAllRanges()}t()}}}])},2399:function(e,n){e.exports="<db-modal-header>\n<div class=bz-text-display-4 dm-i18n=buzz/shareable-url-title></div>\n</db-modal-header>\n<db-modal-body>\n<p class=bz-text-body dm-i18n=buzz/shareable-url-description></p>\n<input class=input type=text readonly=readonly ng-model=channel.url class=bz-share-url />\n</db-modal-body>\n<db-modal-footer>\n<db-modal-buttons>\n<db-button ng-hide=copied ng-click=copyUrlToClipboard() theme=primary dm-i18n=buzz/copy-link></db-button>\n<db-button ng-show=copied theme=primary><i class=icon-check></i></db-button>\n</db-modal-buttons>\n</db-modal-footer>"},2400:function(e,n,t){angular.module("buzz").directive("bzAllUsersModal",["bzRootPath","dmI18n","bzStore","bzEvents","bzUserListFactory","$filter","tasksService","$q","bzService","bzModals","bzHelpers","dmCachedGroups","bzPeopleHelper","$timeout",function(e,n,a,i,s,o,r,c,l,d,u,p,h,g){return{template:t(2401),restrict:"E",replace:!0,scope:{channelId:"=?",threadId:"=?"},link:function(e,t,i){function r(){e.filterPeople=m,e.onScroll=d,e.onUserRemove=b,e.peopleFilterTerm="",e.users=[],e.vm={i18n:{search:n.get("search"),removeFromConversation:n.get("buzz/remove-from-conversation")}},e.channel=e.channelId?a.channels[e.channelId]:a.currentChannel,e.threadId&&e.channel&&(e.channel=_.findWhere(e.channel.huddles,{id:e.threadId})),e.showRemove=h.shouldShowRemoveForChannel(e.channel),v(),g(function(){l()},100)}function l(){z.focus()}function d(){e.scrollLoader.nextPage().then(function(e){null!==e&&f(e,e.total)})}function p(){y.scrollTop=0}function m(n){e.users=[],v(n),p()}function b(n){h.removeUserFromChannel(n,e.channel).then(function(){e.users=[],v()})}function v(n){var t;t="Access"===i.userType?c.when(i.userType):e.channel.inheritPermissions?u.getChannelUsersType(e.channel.parentChannel):u.getChannelUsersType(e.channel),t.then(function(t){e.listType=t,"Access"===t?e.scrollLoader=s.getUserAccessesScrollLoader(e.channel.id,30,0,n,"Huddle"===e.channel.type):e.scrollLoader=s.getPinnedUsersScrollLoader(e.channel.id,30,0,n),e.scrollLoader.nextPage().then(function(e){f(e,e.total)})})}function f(n,t){n&&(n=h.processPeople(n,e.channel.type),_.each(n,function(n){e.users.push(n)}),e.userTotal=o("number")(t))}var z=angular.element("#bzPeopleListSearch"),y=t.find(".people-list")[0];r()}}}])},2401:function(e,n){e.exports='<div class="bz-modal-content margin-medium">\n<db-modal-header>\n<div>\n<span class="bz-text-display-4 margin-right-xxsmall" dm-i18n=people></span>\n<span class="accordion-meta bz-text-caption secondary">\n{{ userTotal || \'\' }}\n</span>\n<div class="bz-people-list-search margin-top-small">\n<input id=bzPeopleListSearch class=input type=text placeholder={{::vm.i18n.search}} ng-model=peopleFilterTerm ng-change=filterPeople(peopleFilterTerm) ng-model-options="{updateOn: \'default\', debounce: { \'default\': 300 }}"/>\n<i class=icon-search></i>\n</div>\n</div>\n</db-modal-header>\n<db-modal-body>\n<div class=scroll-list>\n<ul class=people-list vs-repeat vs-scrolled-to-end=onScroll() vs-scroll-parent=.modal-body vs-excess=25>\n<li ng-repeat="user in users track by user.id" class=user-list-item>\n<bz-user-list-item id="{{ user.id }}" type="{{ user.type }}" name="{{ user.DISPLAY }}">\n<div class=admin-actions ng-if="showRemove && user.hasRemove">\n<i ng-click=onUserRemove(user) class=icon-x db-tooltip={{::vm.i18n.removeFromConversation}} db-tooltip-placement=left></i>\n</div>\n</bz-user-list-item>\n</li>\n</ul>\n<div ng-hide="users.length || scrollLoader.isLoading()" class="people-list-zero-state bz-text-italics" dm-i18n=buzz/people-list-zero-state></div>\n<div ng-if=scrollLoader.isLoading() class="text-align-center block">\n<span class="spinner medium"></span>\n</div>\n</div>\n</db-modal-body>\n</div>'},2402:function(e,n,t){angular.module("buzz").directive("bzGiphySelector",["bzRootPath",function(e){return{template:t(2403),restrict:"E",scope:{gifs:"=",onGifSelected:"&"},link:function(e,n){e.selectGif=function(n){e.gifs=[],e.onGifSelected({gif:n})}}}}])},2403:function(e,n){e.exports='<div class=scroll>\n<img class="giphy-img dm-animate" ng-click=selectGif(gif) ng-src={{gif.images.fixed_height_small.url}} ng-repeat="gif in gifs track by gif.id">\n</div>\n'},2404:function(e,n,t){
angular.module("buzz").directive("bzDeleteGroupChat",["bzRootPath","dmI18n","bzStore","bzService","bzModals","bzEvents",function(e,n,a,i,s,o){return{restrict:"E",template:t(2405),scope:{onCancel:"&"},link:function(e,t){function r(){s.close("deleteGroupChat")}function c(){i.deleteChannel(e.channel.id).then(function(){s.close("deleteGroupChat"),o.deleteChannel.trigger(e.channel.id)})}e.channel=a.currentChannel,e.cancel=r,e.confirm=c,e.text={confirmGroupChatDelete:n.get("buzz/confirm-group-chat-delete")}}}}])},2405:function(e,n){e.exports="<db-modal-header>\n<div class=bz-text-display-4 dm-i18n=buzz/delete-group-chat></div>\n</db-modal-header>\n<db-modal-body>\n<p class=bz-text-body>\n{{ ::text.confirmGroupChatDelete }}\n</p>\n</db-modal-body>\n<db-modal-footer>\n<db-modal-buttons>\n<db-button size=large ng-click=confirm() theme=danger dm-i18n=delete>\n</db-button>\n<db-button ng-click=cancel() theme=alt size=large dm-i18n=cancel></db-button>\n</db-modal-buttons>\n</db-modal-footer>"},2406:function(e,n,t){angular.module("buzz").directive("bzThirdPartyAvatar",["bzRootPath",function(e){return{template:t(2407),restrict:"E",scope:{iconUrl:"="},link:function(e,n,t){e.avatarSize=t.avatarSize||"micro"}}}])},2407:function(e,n){e.exports='<span>\n<div class="avatar-widget {{avatarSize}} bz-third-party-creator">\n<img ng-src={{::iconUrl}} class=third-party-icon>\n</div>\n</span>'},2408:function(e,n,t){t(2409),t(2410)},2409:function(e,n){angular.module("buzz").service("bzCodeSnippetTheme",["dmUtils",function(e){function n(){return s.current=a(),s}function t(n){s.current=i[n]?n:"default",e.localStorageWrite("codesnippet.theme",s.current)}function a(){return e.localStorageRead("codesnippet.theme","default")}var i={default:"Default",dark:"Dark",funky:"Funky",okaidia:"Okaidia",twilight:"Twilight",coy:"Coy",solarizedlight:"Solarized Light"},s={themes:i,current:"default",get:a,set:t};return n()}])},2410:function(e,n,t){var a=t(2411),i=t(2413),s=t(2434),o=t(2436),r=t(2462);t(2463),angular.module("buzz").component("bzCodeSnippet",{bindings:{language:"@?",content:"@"},transclude:!0,template:t(2465),controller:["$element","$window","$transclude","$scope","bzCodeSnippetTheme","DmNotification","dmI18n",function(e,n,t,c,l,d,u){function p(){v(function(e){f(function(n){b(e,n),w.addClass("language-"+y.language),e.highlightElement(w[0])})})}function h(){w=null,z.destroy(),e=null}function g(){w.html(y.content),r(function(n){z=new n(e.find(".clipboard")[0],{text:function(e){return w[0].textContent}})}),y.language&&(w.addClass("language-"+y.language),v(function(e){e.highlightElement(w[0])}))}function m(e){e.altKey?y.themePickerOpen=!0:new d(u.get("buzz/copied-to-clipboard"),{body:y.content,tag:"bzCodeSnippetCopiedToClipboard",icon:"clipboard-copy"})}function b(e,n){if(!e.languages[y.language]){var t=n.highlightAuto(y.content),a=e.languages[t.language]?t.language:null;!a&&t.second_best&&(a=e.languages[t.second_best.language]?t.second_best.language:null),a=a||"markup",y.language=a}}function v(e){a(function(n){i(function(){e(n)})})}function f(e){s(function(n){o(function(t){n.registerLanguage("apache",t.apache),n.registerLanguage("cpp",t.cpp),n.registerLanguage("xml",t.xml),n.registerLanguage("bash",t.bash),n.registerLanguage("css",t.css),n.registerLanguage("markdown",t.markdown),n.registerLanguage("dart",t.dart),n.registerLanguage("ruby",t.ruby),n.registerLanguage("go",t.go),n.registerLanguage("haml",t.haml),n.registerLanguage("java",t.java),n.registerLanguage("javascript",t.javascript),n.registerLanguage("json",t.json),n.registerLanguage("makefile",t.makefile),n.registerLanguage("perl",t.perl),n.registerLanguage("objectivec",t.objectivec),n.registerLanguage("php",t.php),n.registerLanguage("python",t.python),n.registerLanguage("r",t.r),n.registerLanguage("scss",t.scss),n.registerLanguage("sql",t.sql),n.registerLanguage("swift",t.swift),n.registerLanguage("yaml",t.yaml),e(n)})})}var z,y=this,w=e.find("code");y.themeManager=l,y.content=t()[0].innerHTML,y.copy=m,y.destroy=h,y.$postLink=g,y.$onInit=p}]})},2411:function(e,n,t){e.exports=function(e){t.e(36,function(n){e(t(2412))})}},2413:function(e,n,t){e.exports=function(e){t.e(37,function(n){e(t(2414))})}},2434:function(e,n,t){e.exports=function(e){t.e(38,function(n){e(t(2435))})}},2436:function(e,n,t){e.exports=function(e){t.e(39,function(n){e(t(2437))})}},2462:function(e,n,t){e.exports=function(e){!function(n){e(t(1088))}(t)}},2463:function(e,n,t){var a=t(2464);"string"==typeof a&&(a=[[e.id,a,""]]);var i,s={};s.transform=i;t(3)(a,s);a.locals&&(e.exports=a.locals)},2464:function(e,n){e.exports='code[class*="language-"],pre[class*="language-"]{color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, \'Andale Mono\', \'Ubuntu Mono\', monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*="language-"]::-moz-selection,pre[class*="language-"] ::-moz-selection,code[class*="language-"]::-moz-selection,code[class*="language-"] ::-moz-selection{text-shadow:none;background:#b3d4fc}pre[class*="language-"]::selection,pre[class*="language-"] ::selection,code[class*="language-"]::selection,code[class*="language-"] ::selection{text-shadow:none;background:#b3d4fc}@media print{code[class*="language-"],pre[class*="language-"]{text-shadow:none}}pre[class*="language-"]{padding:1em;margin:.5em 0;overflow:auto}:not(pre)>code[class*="language-"],pre[class*="language-"]{background:#f5f2f0}:not(pre)>code[class*="language-"]{padding:.1em;border-radius:.3em;white-space:normal}.token.comment,.token.prolog,.token.doctype,.token.cdata{color:slategray}.token.punctuation{color:#999}.namespace{opacity:.7}.token.property,.token.tag,.token.boolean,.token.number,.token.constant,.token.symbol,.token.deleted{color:#905}.token.selector,.token.attr-name,.token.string,.token.char,.token.builtin,.token.inserted{color:#690}.token.operator,.token.entity,.token.url,.language-css .token.string,.style .token.string{color:#a67f59;background:rgba(255,255,255,0.5)}.token.atrule,.token.attr-value,.token.keyword{color:#07a}.token.function{color:#DD4A68}.token.regex,.token.important,.token.variable{color:#e90}.token.important,.token.bold{font-weight:bold}.token.italic{font-style:italic}.token.entity{cursor:help}bz-code-snippet{display:block}bz-code-snippet:hover .actions{opacity:1}bz-code-snippet .inner{position:relative;white-space:normal}bz-code-snippet .actions{position:absolute;top:0;right:0;z-index:1;padding:4px;opacity:0}bz-code-snippet .actions .action{padding:4px;cursor:pointer;border-radius:1000px;width:30px;text-align:center;box-sizing:border-box;background-color:white;border:1px solid rgba(0,0,0,0.15);box-shadow:0 1px 3px rgba(0,0,0,0.15)}bz-code-snippet .actions .action:hover{background-color:#f9f9f9}bz-code-snippet .line-numbers-rows{top:-2px !important}bz-code-snippet pre[class*="language-"]{border-radius:6px;overflow-x:auto;min-height:32px;margin:0 !important;padding-right:32px !important}bz-code-snippet .theme-default pre[class*="language-"]{background-color:rgba(0,0,0,0.03)}bz-code-snippet .theme-dark code[class*="language-"],bz-code-snippet .theme-dark pre[class*="language-"]{color:white;background:none;text-shadow:0 -.1em .2em black;font-family:Consolas, Monaco, \'Andale Mono\', \'Ubuntu Mono\', monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}@media print{bz-code-snippet .theme-dark code[class*="language-"],bz-code-snippet .theme-dark pre[class*="language-"]{text-shadow:none}}bz-code-snippet .theme-dark pre[class*="language-"],bz-code-snippet .theme-dark :not(pre)>code[class*="language-"]{background:#4d4033}bz-code-snippet .theme-dark pre[class*="language-"]{padding:1em;margin:.5em 0;overflow:auto;border:0.3em solid #7a6652;border-radius:.5em;box-shadow:1px 1px .5em black inset}bz-code-snippet .theme-dark :not(pre)>code[class*="language-"]{padding:.15em .2em .05em;border-radius:.3em;border:0.13em solid #7a6652;box-shadow:1px 1px .3em -.1em black inset;white-space:normal}bz-code-snippet .theme-dark .token.comment,bz-code-snippet .theme-dark .token.prolog,bz-code-snippet .theme-dark .token.doctype,bz-code-snippet .theme-dark .token.cdata{color:#998066}bz-code-snippet .theme-dark .token.punctuation{opacity:.7}bz-code-snippet .theme-dark .namespace{opacity:.7}bz-code-snippet .theme-dark .token.property,bz-code-snippet .theme-dark .token.tag,bz-code-snippet .theme-dark .token.boolean,bz-code-snippet .theme-dark .token.number,bz-code-snippet .theme-dark .token.constant,bz-code-snippet .theme-dark .token.symbol{color:#d1949e}bz-code-snippet .theme-dark .token.selector,bz-code-snippet .theme-dark .token.attr-name,bz-code-snippet .theme-dark .token.string,bz-code-snippet .theme-dark .token.char,bz-code-snippet .theme-dark .token.builtin,bz-code-snippet .theme-dark .token.inserted{color:#bde052}bz-code-snippet .theme-dark .token.operator,bz-code-snippet .theme-dark .token.entity,bz-code-snippet .theme-dark .token.url,bz-code-snippet .theme-dark .language-css .token.string,bz-code-snippet .theme-dark .style .token.string,bz-code-snippet .theme-dark .token.variable{color:#f5b83d}bz-code-snippet .theme-dark .token.atrule,bz-code-snippet .theme-dark .token.attr-value,bz-code-snippet .theme-dark .token.keyword{color:#d1949e}bz-code-snippet .theme-dark .token.regex,bz-code-snippet .theme-dark .token.important{color:#e90}bz-code-snippet .theme-dark .token.important,bz-code-snippet .theme-dark .token.bold{font-weight:bold}bz-code-snippet .theme-dark .token.italic{font-style:italic}bz-code-snippet .theme-dark .token.entity{cursor:help}bz-code-snippet .theme-dark .token.deleted{color:red}bz-code-snippet .theme-dark .action{color:white}bz-code-snippet .theme-funky code[class*="language-"],bz-code-snippet .theme-funky pre[class*="language-"]{font-family:Consolas, Monaco, \'Andale Mono\', \'Ubuntu Mono\', monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}bz-code-snippet .theme-funky pre[class*="language-"]{padding:.4em .8em;margin:.5em 0;overflow:auto;background:url(\'data:image/svg+xml;charset=utf-8,<svg%20version%3D"1.1"%20xmlns%3D"http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg"%20width%3D"100"%20height%3D"100"%20fill%3D"rgba(0%2C0%2C0%2C.2)">%0D%0A<polygon%20points%3D"0%2C50%2050%2C0%200%2C0"%20%2F>%0D%0A<polygon%20points%3D"0%2C100%2050%2C100%20100%2C50%20100%2C0"%20%2F>%0D%0A<%2Fsvg>\');background-size:1em 1em}bz-code-snippet .theme-funky code[class*="language-"]{background:black;color:white;box-shadow:-.3em 0 0 .3em black, .3em 0 0 .3em black}bz-code-snippet .theme-funky :not(pre)>code[class*="language-"]{padding:.2em;border-radius:.3em;box-shadow:none;white-space:normal}bz-code-snippet .theme-funky .token.comment,bz-code-snippet .theme-funky .token.prolog,bz-code-snippet .theme-funky .token.doctype,bz-code-snippet .theme-funky .token.cdata{color:#aaa}bz-code-snippet .theme-funky .token.punctuation{color:#999}bz-code-snippet .theme-funky .namespace{opacity:.7}bz-code-snippet .theme-funky .token.property,bz-code-snippet .theme-funky .token.tag,bz-code-snippet .theme-funky .token.boolean,bz-code-snippet .theme-funky .token.number,bz-code-snippet .theme-funky .token.constant,bz-code-snippet .theme-funky .token.symbol{color:#0cf}bz-code-snippet .theme-funky .token.selector,bz-code-snippet .theme-funky .token.attr-name,bz-code-snippet .theme-funky .token.string,bz-code-snippet .theme-funky .token.char,bz-code-snippet .theme-funky .token.builtin{color:yellow}bz-code-snippet .theme-funky .token.operator,bz-code-snippet .theme-funky .token.entity,bz-code-snippet .theme-funky .token.url,bz-code-snippet .theme-funky .language-css .token.string,bz-code-snippet .theme-funky .toke.variable,bz-code-snippet .theme-funky .token.inserted{color:yellowgreen}bz-code-snippet .theme-funky .token.atrule,bz-code-snippet .theme-funky .token.attr-value,bz-code-snippet .theme-funky .token.keyword{color:deeppink}bz-code-snippet .theme-funky .token.regex,bz-code-snippet .theme-funky .token.important{color:orange}bz-code-snippet .theme-funky .token.important,bz-code-snippet .theme-funky .token.bold{font-weight:bold}bz-code-snippet .theme-funky .token.italic{font-style:italic}bz-code-snippet .theme-funky .token.entity{cursor:help}bz-code-snippet .theme-funky .token.deleted{color:red}bz-code-snippet .theme-funky .action{color:#07CDFF;opacity:1}bz-code-snippet .theme-okaidia code[class*="language-"],bz-code-snippet .theme-okaidia pre[class*="language-"]{color:#f8f8f2;background:none;text-shadow:0 1px rgba(0,0,0,0.3);font-family:Consolas, Monaco, \'Andale Mono\', \'Ubuntu Mono\', monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}bz-code-snippet .theme-okaidia pre[class*="language-"]{padding:1em;margin:.5em 0;overflow:auto;border-radius:0.3em}bz-code-snippet .theme-okaidia :not(pre)>code[class*="language-"],bz-code-snippet .theme-okaidia pre[class*="language-"]{background:#272822}bz-code-snippet .theme-okaidia :not(pre)>code[class*="language-"]{padding:.1em;border-radius:.3em;white-space:normal}bz-code-snippet .theme-okaidia .token.comment,bz-code-snippet .theme-okaidia .token.prolog,bz-code-snippet .theme-okaidia .token.doctype,bz-code-snippet .theme-okaidia .token.cdata{color:slategray}bz-code-snippet .theme-okaidia .token.punctuation{color:#f8f8f2}bz-code-snippet .theme-okaidia .namespace{opacity:.7}bz-code-snippet .theme-okaidia .token.property,bz-code-snippet .theme-okaidia .token.tag,bz-code-snippet .theme-okaidia .token.constant,bz-code-snippet .theme-okaidia .token.symbol,bz-code-snippet .theme-okaidia .token.deleted{color:#f92672}bz-code-snippet .theme-okaidia .token.boolean,bz-code-snippet .theme-okaidia .token.number{color:#ae81ff}bz-code-snippet .theme-okaidia .token.selector,bz-code-snippet .theme-okaidia .token.attr-name,bz-code-snippet .theme-okaidia .token.string,bz-code-snippet .theme-okaidia .token.char,bz-code-snippet .theme-okaidia .token.builtin,bz-code-snippet .theme-okaidia .token.inserted{color:#a6e22e}bz-code-snippet .theme-okaidia .token.operator,bz-code-snippet .theme-okaidia .token.entity,bz-code-snippet .theme-okaidia .token.url,bz-code-snippet .theme-okaidia .language-css .token.string,bz-code-snippet .theme-okaidia .style .token.string,bz-code-snippet .theme-okaidia .token.variable{color:#f8f8f2}bz-code-snippet .theme-okaidia .token.atrule,bz-code-snippet .theme-okaidia .token.attr-value,bz-code-snippet .theme-okaidia .token.function{color:#e6db74}bz-code-snippet .theme-okaidia .token.keyword{color:#66d9ef}bz-code-snippet .theme-okaidia .token.regex,bz-code-snippet .theme-okaidia .token.important{color:#fd971f}bz-code-snippet .theme-okaidia .token.important,bz-code-snippet .theme-okaidia .token.bold{font-weight:bold}bz-code-snippet .theme-okaidia .token.italic{font-style:italic}bz-code-snippet .theme-okaidia .token.entity{cursor:help}bz-code-snippet .theme-okaidia .action{color:white}bz-code-snippet .theme-twilight code[class*="language-"],bz-code-snippet .theme-twilight pre[class*="language-"]{color:white;background:none;font-family:Consolas, Monaco, \'Andale Mono\', \'Ubuntu Mono\', monospace;text-align:left;text-shadow:0 -.1em .2em black;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}bz-code-snippet .theme-twilight pre[class*="language-"],bz-code-snippet .theme-twilight :not(pre)>code[class*="language-"]{background:#141414}bz-code-snippet .theme-twilight pre[class*="language-"]{border-radius:.5em;border:0.3em solid #545454;box-shadow:1px 1px .5em black inset;margin:.5em 0;overflow:auto;padding:1em}bz-code-snippet .theme-twilight pre[class*="language-"]::-moz-selection{background:#27292a}bz-code-snippet .theme-twilight pre[class*="language-"]::selection{background:#27292a}bz-code-snippet .theme-twilight pre[class*="language-"]::-moz-selection,bz-code-snippet .theme-twilight pre[class*="language-"] ::-moz-selection,bz-code-snippet .theme-twilight code[class*="language-"]::-moz-selection,bz-code-snippet .theme-twilight code[class*="language-"] ::-moz-selection{text-shadow:none;background:rgba(237,237,237,0.15)}bz-code-snippet .theme-twilight pre[class*="language-"]::selection,bz-code-snippet .theme-twilight pre[class*="language-"] ::selection,bz-code-snippet .theme-twilight code[class*="language-"]::selection,bz-code-snippet .theme-twilight code[class*="language-"] ::selection{text-shadow:none;background:rgba(237,237,237,0.15)}bz-code-snippet .theme-twilight :not(pre)>code[class*="language-"]{border-radius:.3em;border:0.13em solid #545454;box-shadow:1px 1px .3em -.1em black inset;padding:.15em .2em .05em;white-space:normal}bz-code-snippet .theme-twilight .token.comment,bz-code-snippet .theme-twilight .token.prolog,bz-code-snippet .theme-twilight .token.doctype,bz-code-snippet .theme-twilight .token.cdata{color:#787878}bz-code-snippet .theme-twilight .token.punctuation{opacity:.7}bz-code-snippet .theme-twilight .namespace{opacity:.7}bz-code-snippet .theme-twilight .token.tag,bz-code-snippet .theme-twilight .token.boolean,bz-code-snippet .theme-twilight .token.number,bz-code-snippet .theme-twilight .token.deleted{color:#cf694a}bz-code-snippet .theme-twilight .token.keyword,bz-code-snippet .theme-twilight .token.property,bz-code-snippet .theme-twilight .token.selector,bz-code-snippet .theme-twilight .token.constant,bz-code-snippet .theme-twilight .token.symbol,bz-code-snippet .theme-twilight .token.builtin{color:#f9ee9a}bz-code-snippet .theme-twilight .token.attr-name,bz-code-snippet .theme-twilight .token.attr-value,bz-code-snippet .theme-twilight .token.string,bz-code-snippet .theme-twilight .token.char,bz-code-snippet .theme-twilight .token.operator,bz-code-snippet .theme-twilight .token.entity,bz-code-snippet .theme-twilight .token.url,bz-code-snippet .theme-twilight .language-css .token.string,bz-code-snippet .theme-twilight .style .token.string,bz-code-snippet .theme-twilight .token.variable,bz-code-snippet .theme-twilight .token.inserted{color:#919e6b}bz-code-snippet .theme-twilight .token.atrule{color:#7386a5}bz-code-snippet .theme-twilight .token.regex,bz-code-snippet .theme-twilight .token.important{color:#e9c163}bz-code-snippet .theme-twilight .token.important,bz-code-snippet .theme-twilight .token.bold{font-weight:bold}bz-code-snippet .theme-twilight .token.italic{font-style:italic}bz-code-snippet .theme-twilight .token.entity{cursor:help}bz-code-snippet .theme-twilight pre[data-line]{padding:1em 0 1em 3em;position:relative}bz-code-snippet .theme-twilight .language-markup .token.tag,bz-code-snippet .theme-twilight .language-markup .token.attr-name,bz-code-snippet .theme-twilight .language-markup .token.punctuation{color:#ad895c}bz-code-snippet .theme-twilight .token{position:relative;z-index:1}bz-code-snippet .theme-twilight .line-highlight{background:rgba(84,84,84,0.25);background:linear-gradient(to right, rgba(84,84,84,0.1) 70%, rgba(84,84,84,0));border-bottom:1px dashed #545454;border-top:1px dashed #545454;left:0;line-height:inherit;margin-top:0.75em;padding:inherit 0;pointer-events:none;position:absolute;right:0;white-space:pre;z-index:0}bz-code-snippet .theme-twilight .line-highlight:before,bz-code-snippet .theme-twilight .line-highlight[data-end]:after{background-color:#8794a6;border-radius:999px;box-shadow:0 1px white;color:#f5f2f0;content:attr(data-start);font:bold 65%/1.5 sans-serif;left:.6em;min-width:1em;padding:0 .5em;position:absolute;text-align:center;text-shadow:none;top:.4em;vertical-align:.3em}bz-code-snippet .theme-twilight .line-highlight[data-end]:after{bottom:.4em;content:attr(data-end);top:auto}bz-code-snippet .theme-twilight .action{color:white}bz-code-snippet .theme-coy code[class*="language-"],bz-code-snippet .theme-coy pre[class*="language-"]{color:black;background:none;font-family:Consolas, Monaco, \'Andale Mono\', \'Ubuntu Mono\', monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}bz-code-snippet .theme-coy pre[class*="language-"]{position:relative;margin:.5em 0;box-shadow:-1px 0px 0px 0px #358ccb, 0px 0px 0px 1px #dfdfdf;border-left:10px solid #358ccb;background-color:#fdfdfd;background-image:linear-gradient(transparent 50%, rgba(69,142,209,0.04) 50%);background-size:3em 3em;background-origin:content-box;overflow:visible;padding:0}bz-code-snippet .theme-coy code[class*="language"]{max-height:inherit;height:100%;padding:0 1em;display:block;overflow:auto}bz-code-snippet .theme-coy :not(pre)>code[class*="language-"],bz-code-snippet .theme-coy pre[class*="language-"]{background-color:#fdfdfd;box-sizing:border-box;margin-bottom:1em}bz-code-snippet .theme-coy :not(pre)>code[class*="language-"]{position:relative;padding:.2em;border-radius:0.3em;color:#c92c2c;border:1px solid rgba(0,0,0,0.1);display:inline;white-space:normal}bz-code-snippet .theme-coy pre[class*="language-"]:before,bz-code-snippet .theme-coy pre[class*="language-"]:after{content:\'\';z-index:-2;display:block;position:absolute;bottom:0.75em;left:0.18em;width:40%;height:20%;max-height:13em;box-shadow:0px 13px 8px #979797;-webkit-transform:rotate(-2deg);transform:rotate(-2deg)}bz-code-snippet .theme-coy :not(pre)>code[class*="language-"]:after,bz-code-snippet .theme-coy pre[class*="language-"]:after{right:0.75em;left:auto;-webkit-transform:rotate(2deg);transform:rotate(2deg)}bz-code-snippet .theme-coy .token.comment,bz-code-snippet .theme-coy .token.block-comment,bz-code-snippet .theme-coy .token.prolog,bz-code-snippet .theme-coy .token.doctype,bz-code-snippet .theme-coy .token.cdata{color:#7D8B99}bz-code-snippet .theme-coy .token.punctuation{color:#5F6364}bz-code-snippet .theme-coy .token.property,bz-code-snippet .theme-coy .token.tag,bz-code-snippet .theme-coy .token.boolean,bz-code-snippet .theme-coy .token.number,bz-code-snippet .theme-coy .token.function-name,bz-code-snippet .theme-coy .token.constant,bz-code-snippet .theme-coy .token.symbol,bz-code-snippet .theme-coy .token.deleted{color:#c92c2c}bz-code-snippet .theme-coy .token.selector,bz-code-snippet .theme-coy .token.attr-name,bz-code-snippet .theme-coy .token.string,bz-code-snippet .theme-coy .token.char,bz-code-snippet .theme-coy .token.function,bz-code-snippet .theme-coy .token.builtin,bz-code-snippet .theme-coy .token.inserted{color:#2f9c0a}bz-code-snippet .theme-coy .token.operator,bz-code-snippet .theme-coy .token.entity,bz-code-snippet .theme-coy .token.url,bz-code-snippet .theme-coy .token.variable{color:#a67f59;background:rgba(255,255,255,0.5)}bz-code-snippet .theme-coy .token.atrule,bz-code-snippet .theme-coy .token.attr-value,bz-code-snippet .theme-coy .token.keyword,bz-code-snippet .theme-coy .token.class-name{color:#1990b8}bz-code-snippet .theme-coy .token.regex,bz-code-snippet .theme-coy .token.important{color:#e90}bz-code-snippet .theme-coy .language-css .token.string,bz-code-snippet .theme-coy .style .token.string{color:#a67f59;background:rgba(255,255,255,0.5)}bz-code-snippet .theme-coy .token.important{font-weight:normal}bz-code-snippet .theme-coy .token.bold{font-weight:bold}bz-code-snippet .theme-coy .token.italic{font-style:italic}bz-code-snippet .theme-coy .token.entity{cursor:help}bz-code-snippet .theme-coy .namespace{opacity:.7}@media screen and (max-width: 767px){bz-code-snippet .theme-coy pre[class*="language-"]:before,bz-code-snippet .theme-coy pre[class*="language-"]:after{bottom:14px;box-shadow:none}}bz-code-snippet .theme-coy .token.tab:not(:empty):before,bz-code-snippet .theme-coy .token.cr:before,bz-code-snippet .theme-coy .token.lf:before{color:#e0d7d1}bz-code-snippet .theme-coy pre[class*="language-"].line-numbers{padding-left:0}bz-code-snippet .theme-coy pre[class*="language-"].line-numbers code{padding-left:3.8em}bz-code-snippet .theme-coy pre[class*="language-"].line-numbers .line-numbers-rows{left:0}bz-code-snippet .theme-coy pre[class*="language-"][data-line]{padding-top:0;padding-bottom:0;padding-left:0}bz-code-snippet .theme-coy pre[data-line] code{position:relative;padding-left:4em}bz-code-snippet .theme-coy pre .line-highlight{margin-top:0}bz-code-snippet .theme-coy pre[class*="language-"]{border-radius:0}bz-code-snippet .theme-solarizedlight code[class*="language-"],bz-code-snippet .theme-solarizedlight pre[class*="language-"]{color:#657b83;font-family:Consolas, Monaco, \'Andale Mono\', \'Ubuntu Mono\', monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}bz-code-snippet .theme-solarizedlight pre[class*="language-"]::-moz-selection,bz-code-snippet .theme-solarizedlight pre[class*="language-"] ::-moz-selection,bz-code-snippet .theme-solarizedlight code[class*="language-"]::-moz-selection,bz-code-snippet .theme-solarizedlight code[class*="language-"] ::-moz-selection{background:#073642}bz-code-snippet .theme-solarizedlight pre[class*="language-"]::selection,bz-code-snippet .theme-solarizedlight pre[class*="language-"] ::selection,bz-code-snippet .theme-solarizedlight code[class*="language-"]::selection,bz-code-snippet .theme-solarizedlight code[class*="language-"] ::selection{background:#073642}bz-code-snippet .theme-solarizedlight pre[class*="language-"]{padding:1em;margin:.5em 0;overflow:auto;border-radius:0.3em}bz-code-snippet .theme-solarizedlight :not(pre)>code[class*="language-"],bz-code-snippet .theme-solarizedlight pre[class*="language-"]{background-color:#fdf6e3}bz-code-snippet .theme-solarizedlight :not(pre)>code[class*="language-"]{padding:.1em;border-radius:.3em}bz-code-snippet .theme-solarizedlight .token.comment,bz-code-snippet .theme-solarizedlight .token.prolog,bz-code-snippet .theme-solarizedlight .token.doctype,bz-code-snippet .theme-solarizedlight .token.cdata{color:#93a1a1}bz-code-snippet .theme-solarizedlight .token.punctuation{color:#586e75}bz-code-snippet .theme-solarizedlight .namespace{opacity:.7}bz-code-snippet .theme-solarizedlight .token.property,bz-code-snippet .theme-solarizedlight .token.tag,bz-code-snippet .theme-solarizedlight .token.boolean,bz-code-snippet .theme-solarizedlight .token.number,bz-code-snippet .theme-solarizedlight .token.constant,bz-code-snippet .theme-solarizedlight .token.symbol,bz-code-snippet .theme-solarizedlight .token.deleted{color:#268bd2}bz-code-snippet .theme-solarizedlight .token.selector,bz-code-snippet .theme-solarizedlight .token.attr-name,bz-code-snippet .theme-solarizedlight .token.string,bz-code-snippet .theme-solarizedlight .token.char,bz-code-snippet .theme-solarizedlight .token.builtin,bz-code-snippet .theme-solarizedlight .token.url,bz-code-snippet .theme-solarizedlight .token.inserted{color:#2aa198}bz-code-snippet .theme-solarizedlight .token.entity{color:#657b83;background:#eee8d5}bz-code-snippet .theme-solarizedlight .token.atrule,bz-code-snippet .theme-solarizedlight .token.attr-value,bz-code-snippet .theme-solarizedlight .token.keyword{color:#859900}bz-code-snippet .theme-solarizedlight .token.function{color:#b58900}bz-code-snippet .theme-solarizedlight .token.regex,bz-code-snippet .theme-solarizedlight .token.important,bz-code-snippet .theme-solarizedlight .token.variable{color:#cb4b16}bz-code-snippet .theme-solarizedlight .token.important,bz-code-snippet .theme-solarizedlight .token.bold{font-weight:bold}bz-code-snippet .theme-solarizedlight .token.italic{font-style:italic}bz-code-snippet .theme-solarizedlight .token.entity{cursor:help}bz-code-snippet [class*=\'theme-\'] pre.line-numbers{position:relative;padding-left:3.8em;counter-reset:linenumber}bz-code-snippet [class*=\'theme-\'] pre.line-numbers>code{position:relative}bz-code-snippet [class*=\'theme-\'] .line-numbers .line-numbers-rows{position:absolute;pointer-events:none;top:0;font-size:100%;left:-3.8em;width:3em;letter-spacing:-1px;border-right:1px solid #999;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}bz-code-snippet [class*=\'theme-\'] .line-numbers-rows>span{pointer-events:none;display:block;counter-increment:linenumber}bz-code-snippet [class*=\'theme-\'] .line-numbers-rows>span:before{content:counter(linenumber);color:#999;display:block;padding-right:0.8em;text-align:right}\n'},2465:function(e,n){e.exports='<div class="inner theme-{{ $ctrl.themeManager.current }}">\n<div class=actions>\n<i class="icon-clipboard-copy action clipboard" ng-click=$ctrl.copy($event)></i>\n<div db-popover class="popover with-menu" placement=bottom-right ng-show=$ctrl.themePickerOpen self-close on-close=onMenuOptionsClosed()>\n<div class="menu-list bz-menu-options-list">\n<div class="bz-text-label secondary padding-xsmall" dm-i18n=buzz/theme></div>\n<ul>\n<li ng-repeat="(key, themeName) in $ctrl.themeManager.themes" ng-click=$ctrl.themeManager.set(key)>\n{{ ::themeName }}\n<i ng-show="$ctrl.themeManager.current === key" class="icon-check float-right"></i>\n</li>\n</ul>\n</div>\n</div>\n</div>\n<pre class=line-numbers><code class=line-numbers></code></pre>\n</div>'},2466:function(e,n){angular.module("buzz").component("bzHotkeyListModal",{template:'\n    <div class="bz-modal-content margin-medium">\n      <db-modal-header>\n        <span class="bz-text-display-4" dm-i18n="buzz/hotkeys"></span>\n      </db-modal-header>\n      <db-modal-body>\n        <div>\n          <table>\n            <tr ng-repeat="hotkey in $ctrl.hotkeys track by hotkey.id">\n              <td>\n                <span db-tooltip="{{:: $ctrl.getReadableKeys(hotkey) }}">\n                  {{:: hotkey.formattedKeys }}\n                </span>\n              </td>\n              <td>\n                {{:: hotkey.description }}\n              </td>\n            </tr>\n          </table>\n        </div>\n      </db-modal-body>\n    </div>\n  ',controller:["bzHotkeyService","bzService","features",function(e,n,t){var a=this;a.hotkeys=e.getHotkeys().filter(function(e){return!e.hideFromHelpScreen&&(!t.isElectron()||!e.disableInElectron)}),a.getReadableKeys=function(e){return"mac"===n.getPlatform()?e.readableKeys:null}}]})},2467:function(e,n){angular.module("buzz").factory("bzNavigationService",["bzService","bzStore","bzStates","features","$q",function(e,n,t,a,i){function s(n,t,a){var s=n||["TOPIC","OBJECT_CHAT","HUDDLE","GROUP_CHAT","DIRECT_CHAT"],o=i.defer(),r=e.channelSearch("",50,s,{messageLimit:3,includeMessages:!0,sortMode:"MOST_RECENT_EXCLUDING_HUDDLES",showEmptyChannels:!1,huddleTypes:t,favorited:a||void 0},o.promise).finally(function(){r.abort=angular.noop,o=null,r=null}).catch(function(e){console.error(e)});return r.abort=function(){o.resolve()},r}function o(e,t){var a=_.toArray(n.channels).filter(function(n){var t=n.pin||n.pushNotify,a=void 0;return"data"===e&&(a=n.isFirstClassChannel&&"data"===n.filterType&&n.favoritePosition==-1),"people"===e&&(a=n.isFirstClassChannel&&"people"===n.filterType&&n.favoritePosition==-1),"favorites"===e&&(a=n.favoritePosition>=0),"all"===e&&(a=!0),a&&t});return t&&(a=a.filter(function(e){return e.importantCounts.messages>0||e.importantCounts.huddleMessages>0})),a.sort(c)}function r(e){var n=o(e,!1),t=n.reduce(function(e,n){return n.directImportantCounts.hasImportant()?e.directMentions.push(n):n.groupImportantCounts.hasImportant()?e.groupMentions.push(n):n.atAllImportantCounts.hasImportant()&&e.allMentions.push(n),e},{directMentions:[],groupMentions:[],allMentions:[]});return Object.keys(t).forEach(function(e){return t[e].sort(c);
}),t}function c(e,n){return e.favoritePosition>0&&n.favoritePosition<0?-1:e.favoritePosition<0&&n.favoritePosition>0?1:e.favoritePosition>0&&n.favoritePosition>0?e.favoritePosition-n.favoritePosition:e.lastUpdated<n.lastUpdated?1:e.lastUpdated>n.lastUpdated?-1:0}function l(){return _.toArray(n.channels).filter(function(e){return"OBJECT_CHAT"!==e.type}).sort(c)}function d(){"menu"!==t.current?t.menu():t.isZeroState?t.zeroState():t.messages()}function u(e){e.isFirstClassChannel?n.setCurrentChannel(e.id,void 0,!0,!0).then(function(){t.messages()}):n.setCurrentThread(e,null,!0,null,!0)}function p(n,t){var a,s,o={channelLimit:5,pinnedByCurrentUser:!1,channelTypes:["GROUP_CHAT","TOPIC","OBJECT_CHAT"]};return t&&(o=_.extend(o,t)),a=e.getOtherConversations(n,o).then(function(e){return g(e.channels,n)}),s=h(n).then(function(e){return g(e,n)}),i.all([s,a]).then(function(e){return _.flatten(e)})}function h(n){f&&f.resolve(),z&&z.resolve(),f=i.defer(),z=i.defer();var t=[],a=["userByName"],s={params:{filter:n,limit:5,type:a},timeout:f.promise};return e.typeaheadSearch(s).then(function(n){return _.forEach(n.data.users,function(n){t.push(e.getUserChannel(n.id,z.promise))}),i.all(t)})}function g(e,n,t){var a=n.toLowerCase(),i=e.filter(function(e){var i=e.displayTitle;return e.filterTermIndex=i.length?i.toLowerCase().indexOf(a):-1,e.huddleFilterTermIndex=-1,e.filteredHuddles=[],e.huddles&&e.huddles.length&&(e.filteredHuddles=_.filter(e.huddles,function(t){return t.filterTermIndex=t.displayTitle?t.displayTitle.toLowerCase().indexOf(a):-1,e.huddleFilterTermIndex=Math.max(e.huddleFilterTermIndex,t.filterTermIndex),t.filterTermIndex>=0&&m(t,n)}),e.filteredHuddles=_.sortBy(e.filteredHuddles,"filterTermIndex")),!(!(e.filterTermIndex>=0||e.filteredHuddles.length)||t&&!e.pin)&&m(e,n)});return _.sortBy(_.sortBy(i,"huddleFilterTermIndex"),"filterTermIndex").slice(0,9)}function m(e,n){if(e.filterTermIndex>=0){var t=e.displayTitle,a=t.substring(e.filterTermIndex,e.filterTermIndex+n.length);a&&a.length&&(e.highlightedTitle=[t.substring(0,e.filterTermIndex),t.substring(e.filterTermIndex,e.filterTermIndex+n.length),t.substring(e.filterTermIndex+n.length,t.length)])}else e.filterTermIndex=999,e.highlightedTitle=null;return e}function b(e){var n={};return _.isUndefined(e.totalCount)||(n.missedMessageCount=e.totalCount),_.isUndefined(e.dataCount)||(n.missedDataCount=e.dataCount),_.isUndefined(e.peopleCount)||(n.missedPeopleCount=e.peopleCount),_.isUndefined(e.favoritesCount)||(n.missedFavoritesCount=e.favoritesCount),n}function v(){return e.getAllowInviteSettingStatus()}var f,z;return{filterChannelsByTerm:g,getRecentActivity:s,getAllChannels:l,getConversationsByTerm:p,toggleMenu:d,setCurrentChannel:u,getChannels:o,getChannelsGroupedByImportance:r,syncMissedBuzzMessages:b,getAllowInviteSettingStatus:v}}])},2468:function(e,n,t){angular.module("buzz").component("bzNavigation",{template:t(2469),bindings:{},controller:["bzNavigationService","bzEvents","bzPreferences","dmUtils","bzStore","Analytics","buzzContainerService","$rootScope","features",function(e,n,t,a,i,s,o,r,c){function l(){w=r.$on("allow-invite-by-all",function(e,n){z.allowInviting=n&&f}),y.push(n.nowViewingUpdated.on(function(e){!t.disableAutoSwitching&&e.contextObject&&(h({viewMode:"FOLDER"}),g("data"))})),y.push(n.channelChange.on(function(){"FOLDER"===z.viewMode.view&&g(i.currentChannel.parentChannel.favoritePosition>=0?"favorites":i.currentChannel.filterType)})),y.push(o.registerToggleListener(function(e){z.buzzIsOpen=e}))}function d(){a.localStorageRead("buzz:lastChannelId")&&!a.localStorageRead("buzzNavigationViewMode")?(z.viewMode={view:a.localStorageRead("buzzNavigationViewMode")||"FOLDER"},a.localStorageWrite("buzzNavigationViewMode",z.viewMode.view)):(z.viewMode={view:a.localStorageRead("buzzNavigationViewMode")||"FEED"},a.localStorageWrite("buzzNavigationViewMode",z.viewMode.view))}function u(e){}function p(){_.each(y,function(e){e()}),w()}function h(e){"FEED"==e.viewMode?s.track("buzz_feed_view"):s.track("buzz_folder_view"),i.setImportantMesagesCount(),z.viewMode.view=e.viewMode,a.localStorageWrite("buzzNavigationViewMode",z.viewMode.view)}function g(e){"FEED"===z.viewMode.view?(z.currentFeedTab=e,a.localStorageWrite("buzzNavigationCurrentFeedTab",z.currentFeedTab)):"FOLDER"===z.viewMode.view&&(e!==z.currentTab&&z.importantFilter&&b(!1),e!==z.currentTab&&(z.reorderMode=!1),z.currentTab=e,a.localStorageWrite("buzzNavigationCurrentTab",z.currentTab))}function m(e){z.filtering=e.filtering}function b(e){if(e)switch(z.currentTab){case"data":s.track("buzz_at_mention_activity_view_data");break;case"people":s.track("buzz_at_mention_activity_view_people");break;case"favorites":s.track("buzz_at_mention_activity_view_favorites")}z.importantFilter=e}function v(){z.reorderMode=!z.reorderMode}var f=c.on("free-invite")&&c.on("free-role"),z=this,y=[],w=void 0;z.$onInit=l,z.$onChanges=u,z.$postLink=d,z.$onDestroy=p,z.updateViewMode=_.debounce(h,300,!0),z.setTab=g,z.toggleImportantFilter=b,z.toggleReorder=v,z.setFiltering=m,z.buzzIsOpen=o.buzzIsOpen,z.isFeedAndOpen=function(){return"FEED"===z.viewMode.view&&z.buzzIsOpen},z.currentFeedTab=a.localStorageRead("buzzNavigationCurrentFeedTab")||"all",z.currentTab=a.localStorageRead("buzzNavigationCurrentTab")||"people",z.filtering=!1,z.importantFilter=!1,z.reorderMode=!1,e.getAllowInviteSettingStatus().then(function(e){z.allowInviting=e.data.enabled&&f})}]})},2469:function(e,n){e.exports="<div class=bz-navigation>\n<div class=pane-header>\n<bz-navigation-header view-mode=$ctrl.viewMode.view update-view-mode=$ctrl.updateViewMode($event) current-tab=$ctrl.currentTab current-feed-tab=$ctrl.currentFeedTab set-tab=$ctrl.setTab(tab) is-filtering=$ctrl.filtering>\n</bz-navigation-header>\n</div>\n<div class=pane-body>\n<bz-folder-view ng-show=\"$ctrl.viewMode.view === 'FOLDER'\" important-filter=$ctrl.importantFilter toggle-important-filter=$ctrl.toggleImportantFilter current-tab=$ctrl.currentTab view-mode=$ctrl.viewMode.view update-view-mode=$ctrl.updateViewMode($event) reorder-mode=$ctrl.reorderMode is-filtering=$ctrl.filtering set-filtering=$ctrl.setFiltering($event) toggle-reorder=$ctrl.toggleReorder allow-inviting=$ctrl.allowInviting>\n</bz-folder-view>\n<bz-feed-view ng-if=\"$ctrl.viewMode.view === 'FEED'\" current-feed-tab=$ctrl.currentFeedTab view-mode=$ctrl.viewMode.view allow-inviting=$ctrl.allowInviting>\n</bz-feed-view>\n</div>\n<div class=pane-footer ng-if=$ctrl.isFeedAndOpen()>\n<bz-whos-online></bz-whos-online>\n</div>\n</div>\n"},2470:function(e,n,t){angular.module("buzz").component("bzNavigationHeader",{template:t(2471),bindings:{viewMode:"<",currentTab:"<",currentFeedTab:"<",isFiltering:"<",setTab:"&",updateViewMode:"&"},controller:["$location","bzService","bzStates","Analytics","dmI18n","bzDownloadBuzzService","bzEvents","bzPreferences","bzStore","bzUniversalComposeService","dmSocialUserService","$timeout","bzNavigationService","buzzContainerService","bzHotkeyService",function(e,n,t,a,i,s,o,r,c,l,d,u,p,h,g){function m(){"FOLDER"===H.viewMode?H.selectedTab=A(H.currentTab):"FEED"===H.viewMode&&(H.selectedTab=A(H.currentFeedTab)),T()}function b(e){e.viewMode&&("FEED"===e.viewMode.currentValue?H.selectedTab=A(H.currentFeedTab):"FOLDER"===e.viewMode.currentValue&&(H.selectedTab=A(H.currentTab)))}function v(){c.setImportantMesagesCount()}function f(){B.forEach(function(e){e()})}function z(e){y(e),H.setTab({tab:e}),"FEED"===H.viewMode&&(H.selectedTab=A(e),$())}function y(e){switch(e){case"people":"FOLDER"===H.viewMode?a.track("buzz_folder_people_view"):a.track("buzz_feedfilter_people_conversations");break;case"data":"FOLDER"===H.viewMode?a.track("buzz_folder_data_view"):a.track("buzz_feedfilter_data_conversations");break;case"favorites":"FOLDER"===H.viewMode?a.track("buzz_folder_favorites_view"):a.track("buzz_feedfilter_favorited_conversations");break;case"all":"FEED"===H.viewMode&&a.track("buzz_feedfilter_all_conversations")}}function w(e){H.missed=p.syncMissedBuzzMessages(e)}function k(){function e(){H.composeActive=!1,n&&n.close(),n=void 0}H.composeActive||a.track("buzz_universal_compose_button_click"),H.composeActive=!0,t.messages();var n=l.open({onCancel:e,onCreate:e})}function C(){H.vm.i18n={createNewMessage:i.get("buzz/create-new-message"),makeFullscreen:g.hotkeyWithI18n("buzz/make-fullscreen","toggleFullscreen"),exitFullscreen:g.hotkeyWithI18n("buzz/exit-full-screen","toggleFullscreen"),refresh:i.get("buzz/force-refresh"),settings:i.get("buzz/buzz-settings"),markAllAsReadTooltip:i.get("buzz/mark-all-as-read-tooltip"),takeBuzzTour:i.get("buzz/take-buzz-tour"),oneClickAway:i.get("social/one-click-away"),getBackToBuzz:i.get("social/get-back-to-buzz"),gotoManageSettings:i.get("buzz/goto-manage-settings"),enterFullScreen:i.get("buzz/enter-full-screen"),exitFullScreen:i.get("buzz/exit-full-screen"),allConversations:i.get("buzz/all-conversations"),allConversationsTooltip:i.get("buzz/all-conversations-tooltip"),peopleConversations:i.get("buzz/people-conversations"),peopleConversationsTooltip:i.get("buzz/people-conversations-tooltip"),dataConversations:i.get("buzz/data-conversations"),dataConversationsTooltip:i.get("buzz/data-conversations-tooltip"),favoritedConversations:i.get("buzz/favorited-conversations"),favoritedConversationsTooltip:i.get("buzz/favorited-conversations-tooltip"),data:i.get("buzz/data"),people:i.get("buzz/people"),favorites:i.get("buzz/favorites"),downloadCta:i.get("buzz/download-cta",{platform:""}),showListHotkey:g.getHotkeyFor("showHotkeys").formattedKeys,toggleFullScreenShortcut:g.getHotkeyFor("toggleFullscreen").formattedKeys,conversationsAroundData:i.get("buzz/conversations-around-data"),conversationsWithPeople:i.get("buzz/conversations-with-people"),yourFavoritedConversations:i.get("buzz/your-favorited-conversations")}}function x(){_.isUndefined(H.menuOptionsOpened)&&(a.track("buzz_logo_button"),H.menuOptionsOpened=!H.menuOptionsOpened)}function T(){if(d.isSocialUser()){var n=e.path();H.allowFullscreen="/buzz"!=n&&d.currentRouteIsAllowed()}}function M(){_.defer(function(){H.menuOptionsOpened=void 0,G&&(H.menuOptionsOpened=void 0,H.tourTooltip=H.vm.i18n.takeBuzzTour,angular.element('.tooltip[role="tooltip"]').remove())})}function I(){H.vm.feedTabPopoverOpened=!H.vm.feedTabPopoverOpened}function $(){H.vm.feedTabPopoverOpened=!1}function A(e){switch(e){case"data":return H.vm.i18n.conversationsAroundData;case"people":return H.vm.i18n.conversationsWithPeople;case"all":return H.vm.i18n.allConversations;case"favorites":return H.vm.i18n.yourFavoritedConversations}}function S(){n.markAllChannelsAsViewed().finally(function(){a.track("buzz_logo_mark_all_read"),H.menuOptionsOpened=!1}).catch(function(e){console.error(e)})}function P(){a.track("buzz_logo_settings"),e.path("/notificationcenter"),H.menuOptionsOpened=!1}function E(){a.track("buzz_logo_take_tour"),n.launchTour(),H.menuOptionsOpened=!1}function O(){s.displayDownloadModal(),H.menuOptionsOpened=!1}function U(){return h.isFullscreen}function D(n){h.toggleFullscreen(n),!n&&e.path().indexOf("buzz")>=0&&e.path("page/-100000")}function R(){u(function(){d.firstSocialTrialLogin().then(function(e){H.showSocialTrialPopover=e})},3e3)}function j(){H.showSocialTrialPopover=!1,r.firstLoginAfterTrialStarted=!1}function L(){window.removeEventListener("dm-pendo-ready",L),window.pendo&&window.pendo.events.guidesLoaded(function(){H.displayBuzzTour=!!n.tourAvailable()})}function N(){H.updateViewMode({$event:{viewMode:"FEED"===H.viewMode?"FOLDER":"FEED"}})}function F(){g.displayHotkeyListModal(),H.menuOptionsOpened=!1}var H=this,B=[],G=r.enableBuzzPendo,V=r.onUpdated(function(e,n){"DISABLE_BUZZ_PENDO"==e.constant&&1==r.enableBuzzPendo&&(G=!0,V(),V=null),"INACTIVE_CHANNEL_DAYS"!=e.constant||n||c.refreshChannelsAndFeed()});B.push(V),H.$onInit=m,H.$onChanges=b,H.$postLink=v,H.$onDestroy=f,H.vm={},H.menuOptionsOpened=void 0,H.vm.feedTabPopoverOpened=!1,H.displayBuzzTour=!1,H.showDownloadCTA=s.shouldShowMenuOption(),H.platform=n.getPlatform(),H.showSocialTrialPopover=!1,H.defaultSettingsTooltip=!0,H.missedMessageCount=0,H.composeActive=!1,H.tab={all:"all",people:"people",data:"data"},H.allowFullscreen=!0,H.showHotkeyListModal=F,C(),H.openMenuOptions=x,H.onMenuOptionsClosed=M,H.markAllAsViewed=S,H.gotoManageSettings=P,H.startTour=E,H.displayDownloadModal=O,H.isFullscreen=U,H.toggleFullscreen=D,H.onSocialTrialPopoverClosed=j,H.updateMyViewMode=N,H.universalCompose=k,H.changeTab=z,H.displaySelectedTab=A,H.openFeedTabPopover=I,H.onFeedTabPopoverClosed=$,B.push(o.missedImportant.on(w)),B.push(o.buzzLoaded.on(R)),B.push(h.registerFullscreenListener(T)),window.addEventListener("dm-pendo-ready",L),B.push(function(){window.removeEventListener("dm-pendo-ready",L)})}]})},2471:function(e,n){e.exports="<div class=bz-navigation-header-wrapper>\n<bz-main-header hide-menu=true>\n<div class=bz-navigation-header>\n<div class=bz-toggle-feed-wrapper>\n<div class=bz-toggle-feed ng-class=\"{'bz-folder': ($ctrl.viewMode === 'FOLDER'), 'bz-feed': ($ctrl.viewMode === 'FEED')}\" ng-click=$ctrl.updateMyViewMode()>\n<i class=\"icon-globe _24\" dm-tooltip-i18n=buzz/go-to-discovery-feed db-tooltip-placement=right db-tooltip-close-on-click=true></i>\n<i class=\"icon-inbox-empty-outline _24\" dm-tooltip-i18n=buzz/go-to-inbox db-tooltip-placement=right db-tooltip-close-on-click=true></i>\n</div>\n<span class=\"missedMessageBadge buzzImportantBadge\" ng-if=\"$ctrl.missed.missedMessageCount > 0 && $ctrl.viewMode === 'FEED'\">{{$ctrl.missed.missedMessageCount}}</span>\n</div>\n<div class=logo ng-click=$ctrl.openMenuOptions() ng-class=\"{'fullscreen-toggle-on':$ctrl.allowFullscreen}\">\n<div class=bz-menu-options>\n<img src=/public/javascripts/buzz/buzz-logo-white-small.png />\n<i class=\"icon-chevron-down xs bz-navigation-chevron\"></i>\n<div class=navigation-options-anchor ng-click=\"$ctrl.openPopover('settings')\">\n<div db-popover class=\"popover with-menu\" placement=bottom-center ng-show=$ctrl.menuOptionsOpened self-close on-close=$ctrl.onMenuOptionsClosed()>\n<div class=\"menu-list bz-navigation-options-list\" ng-class=\"{'pc-setting': $ctrl.platform === 'pc', 'mac-setting': $ctrl.platform == 'mac'}\">\n<ul class=menu-list>\n<li db-tooltip={{::$ctrl.vm.i18n.markAllAsReadTooltip}} db-tooltip-placement=right ng-click=$ctrl.markAllAsViewed()>\n<span class=bz-settings-name dm-i18n=buzz/mark-all-as-read></span>\n</li>\n<li class=separator></li>\n<li db-tooltip={{::$ctrl.vm.i18n.gotoManageSettings}} db-tooltip-placement=right ng-click=$ctrl.gotoManageSettings()>\n<span class=bz-settings-name dm-i18n=buzz/manage-settings></span>\n</li>\n<li db-tooltip={{::$ctrl.vm.i18n.takeBuzzTour}} db-tooltip-placement=right ng-if=$ctrl.displayBuzzTour ng-click=$ctrl.startTour()>\n<span class=bz-settings-name dm-i18n=buzz/take-tour></span>\n</li>\n<li ng-click=$ctrl.showHotkeyListModal()>\n<span class=bz-settings-name dm-i18n=buzz/show-hotkey-list></span>\n<span class=\"bz-shortcut bz-text-caption secondary\">{{::$ctrl.vm.i18n.showListHotkey}}</span>\n</li>\n<li ng-if=$ctrl.showDownloadCTA ng-click=$ctrl.displayDownloadModal()>\n<span class=bz-setting-name>{{::$ctrl.vm.i18n.downloadCta}}</span>\n</li>\n</ul>\n</div>\n</div>\n</div>\n</div>\n</div>\n<div class=bz-navigation-header-icons>\n<div class=bz-compose ng-class=\"{'compose-active': $ctrl.composeActive}\" ng-click=$ctrl.universalCompose()><i class=icon-pencil-box db-tooltip={{::$ctrl.vm.i18n.createNewMessage}} db-tooltip-placement=left db-tooltip-close-on-click=true></i></div>\n<div class=\"bz-compose hide-when-electron\" ng-show=\"!$ctrl.isFullscreen() && $ctrl.allowFullscreen\" ng-click=$ctrl.toggleFullscreen(true)><i class=icon-expand db-tooltip={{::$ctrl.vm.i18n.makeFullscreen}} db-tooltip-placement=left db-tooltip-close-on-click=true></i></div>\n<div class=\"bz-compose hide-when-electron\" ng-show=\"$ctrl.isFullscreen() && $ctrl.allowFullscreen\" ng-click=$ctrl.toggleFullscreen(false)><i class=icon-contract db-tooltip={{::$ctrl.vm.i18n.exitFullscreen}} db-tooltip-placement=left db-tooltip-close-on-click=true></i></div>\n<div class=bz-fullscreen-popover-anchor ng-click=\"$ctrl.openPopover('socialTrial')\">\n<div db-popover ng-show=$ctrl.showSocialTrialPopover placement=right-center on-close=$ctrl.onSocialTrialPopoverClosed() self-close=false class=bz-fullscreen-popover>\n<div>\n<div class=popover-header>{{::$ctrl.vm.i18n.oneClickAway}}</div>\n<i class=\"icon-x float-right color-gray-9 cursor-pointer\" ng-click=$ctrl.onSocialTrialPopoverClosed()></i>\n</div>\n<div class=popover-body>{{::$ctrl.vm.i18n.getBackToBuzz}}</div>\n<img class=popover-image src=/public/javascripts/buzz/sample-overview.png>\n<div class=settings-caret>\n</div>\n</div>\n</div>\n</div>\n</div>\n<div class=bz-navigation-subheader ng-class=\"{'feed': $ctrl.viewMode === 'FEED', 'folder': $ctrl.viewMode === 'FOLDER', 'hide':$ctrl.isFiltering}\">\n<div class=subheader-tabs ng-if=\"$ctrl.viewMode === 'FOLDER'\">\n<div class=view-tab ng-class=\"{'active': $ctrl.currentTab === 'favorites'}\" ng-click=\"$ctrl.changeTab('favorites')\">\n<span class=tab-title>\n<span>\n<span class=tab-title-text>{{::$ctrl.vm.i18n.favorites}}</span>\n<span class=\"dm-animate favorites\" ng-class=\"{'missedMessageBadge': $ctrl.missed.missedFavoritesCount > 0}\">{{$ctrl.missed.missedFavoritesCount | bzNumberTruncate}}</span>\n</span>\n</span>\n</div>\n<div class=view-tab ng-class=\"{'active': $ctrl.currentTab === 'data'}\" ng-click=\"$ctrl.changeTab('data')\">\n<span class=tab-title>\n<span>\n<span class=tab-title-text>{{::$ctrl.vm.i18n.data}}</span>\n<span class=\"dm-animate data\" ng-class=\"{'missedMessageBadge': $ctrl.missed.missedDataCount > 0}\">{{$ctrl.missed.missedDataCount | bzNumberTruncate}}</span>\n</span>\n</span>\n</div>\n<div class=view-tab ng-class=\"{'active': $ctrl.currentTab === 'people'}\" ng-click=\"$ctrl.changeTab('people')\">\n<span class=tab-title>\n<span>\n<span class=tab-title-text>{{::$ctrl.vm.i18n.people}}</span>\n<span class=\"dm-animate people\" ng-class=\"{'missedMessageBadge': $ctrl.missed.missedPeopleCount > 0}\">{{$ctrl.missed.missedPeopleCount | bzNumberTruncate}}</span>\n</span>\n</span>\n</div>\n</div>\n<div class=tab-highlight ng-if=\"$ctrl.viewMode === 'FOLDER'\" ng-class=\"{'left': $ctrl.currentTab === 'favorites', 'middle': $ctrl.currentTab === 'data', 'right': $ctrl.currentTab === 'people'}\"></div>\n<div class=subheader-tabs-dropdown ng-if=\"$ctrl.viewMode === 'FEED'\">\n<div class=selected-tab ng-click=$ctrl.openFeedTabPopover()>{{$ctrl.selectedTab}}<i class=\"icon-chevron-down xs\"></i>\n<div class=feed-tab-popover-anchor>\n<div db-popover class=\"popover with-menu\" placement=bottom-left ng-show=$ctrl.vm.feedTabPopoverOpened self-close self-close-ignore-selector=.subheader-tabs-dropdown>\n<div class=\"menu-list bz-navigation-feed-tabs\">\n<ul class=menu-list>\n<li db-tooltip={{::$ctrl.vm.i18n.allConversationsTooltip}} db-tooltip-placement=right ng-click=\"$ctrl.changeTab('all')\">\n<span class=bz-settings-name dm-i18n=buzz/all-conversations></span>\n</li>\n<li db-tooltip={{::$ctrl.vm.i18n.favoritedConversationsTooltip}} db-tooltip-placement=right ng-click=\"$ctrl.changeTab('favorites')\">\n<span class=bz-settings-name dm-i18n=buzz/your-favorited-conversations></span>\n</li>\n<li db-tooltip={{::$ctrl.vm.i18n.dataConversationsTooltip}} db-tooltip-placement=right ng-click=\"$ctrl.changeTab('data')\">\n<span class=bz-settings-name dm-i18n=buzz/conversations-around-data></span>\n</li>\n<li db-tooltip={{::$ctrl.vm.i18n.peopleConversationsTooltip}} db-tooltip-placement=right ng-click=\"$ctrl.changeTab('people')\">\n<span class=bz-settings-name dm-i18n=buzz/conversations-with-people></span>\n</li>\n</ul>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</bz-main-header>\n</div>\n"},2472:function(e,n,t){angular.module("buzz").component("bzNavigationFilter",{template:t(2473),bindings:{importantFilter:"<",currentTab:"<",toggleFilter:"&",toggleReorder:"&",reorderMode:"<",isFiltering:"<"},controller:["bzService","dmI18n","bzModals","bzEvents","bzNavigationService","bzStore","Analytics",function(e,n,t,a,i,s,o){function r(){p(),s.setImportantMesagesCount()}function c(t){t.currentTab&&("data"==b.currentTab?b.i18n.newConversation=n.get("buzz/find-card-page-conversation"):"people"==b.currentTab&&(b.i18n.newConversation="pc"==e.getPlatform()?n.get("buzz/add-conversation-pc"):n.get("buzz/add-conversation-mac")))}function l(){_.each(v,function(e){return e()})}function d(e){b.missed=i.syncMissedBuzzMessages(e)}function u(){if(b.lastMentioned){var e=(new Date).getTime(),t=(e-b.lastMentioned)/1e3;return t<60?n.get("buzz/just-now"):t<3600?n.get("buzz/abbr-min",{count:Math.floor(t/60)}):t<86400?n.get("buzz/abbr-hour",{count:Math.floor(t/3600)}):n.get("buzz/abbr-day",{count:Math.floor(t/86400)})}}function p(){b.i18n.toggleImportant=n.get("buzz/toggle-important-activity"),b.i18n.reorder=n.get("buzz/reorder"),b.i18n.reorderTooltip=n.get("buzz/reorder-tooltip"),b.i18n.doneReordering=n.get("buzz/reorder-done"),b.i18n.markAllRead=n.get("buzz/mark-all-as-read")}function h(){var e=!b.importantFilter;b.toggleFilter&&b.toggleFilter({filter:e})}function g(){"data"===b.currentTab?(o.track("buzz_data_add_chat_button_click"),t.open("newChannel")):(o.track("buzz_people_add_chat_button_click"),t.open("createChat"))}function m(){var n,t,a=!1;o.track("buzz_mark_conversation_read"),"people"===b.currentTab?(n=["GROUP_CHAT","DIRECT_CHAT","TOPIC","HUDDLE"],t=["GROUP_CHAT","DIRECT_CHAT","TOPIC"]):"data"===b.currentTab?(n=["OBJECT_CHAT","HUDDLE"],t=["OBJECT_CHAT"]):"favorites"===b.currentTab&&(n=[],t=[],a=!0),b.showClearAllSpinner=!0,e.markMatchingChannelsAsViewed(n,t,!0,a).finally(function(){b.showClearAllSpinner=!1,b.showMarkAllPopover=!1,h()}).catch(function(e){console.error(e)})}var b=this,v=[];this.$onInit=r,this.$onChanges=c,this.$onDestroy=l,this.newConversation=g,this.toggleImportantFilter=h,this.markAllImportantRead=m,this.timeAgo=_.debounce(u,1e3),b.i18n={},v.push(a.missedImportant.on(function(){b.lastMentioned=(new Date).getTime()})),v.push(a.missedImportant.on(d))}]})},2473:function(e,n){e.exports='<div class="left-section bz-text-body inverse cursor-pointer" ng-hide="$ctrl.isFiltering || $ctrl.reorderMode" ng-click=$ctrl.toggleImportantFilter()>\n<span class=mention-filter ng-class="{active: $ctrl.importantFilter}" db-tooltip={{::$ctrl.i18n.toggleImportant}}>@</span>\n<span class=important-mention-badge ng-show="($ctrl.currentTab === \'people\' && $ctrl.missed.missedPeopleCount) || ($ctrl.currentTab === \'data\' && $ctrl.missed.missedDataCount) || ($ctrl.currentTab === \'favorites\' && $ctrl.missed.missedFavoritesCount)"></span>\n<span dm-i18n=buzz/mention></span>\n</div>\n<div class="left-section bz-text-body inverse" ng-show="$ctrl.importantFilter || $ctrl.reorderMode"></div>\n<div class="right-section bz-text-body inverse" ng-hide=$ctrl.isFiltering>\n<span ng-show=$ctrl.importantFilter ng-click="$ctrl.showMarkAllPopover = true" class=filter-clear-all db-tooltip={{::$ctrl.i18n.markAllRead}}>\n<i class="icon-checked-list _24"></i>\n</span>\n<db-popover class="popover mark-all-popover" ng-show=$ctrl.showMarkAllPopover placement=right-center self-close>\n<div class=popover-arrow></div>\n<div class=mark-all-confirm-message>\n<span class="bz-text-display-6 bold" dm-i18n=buzz/mark-all-confirm></span>\n</div>\n<div class=bz-leave-conversation-actions>\n<db-button theme=alt ng-click="$ctrl.showMarkAllPopover = false"><span dm-i18n=cancel></span></db-button>\n<db-button theme=primary ng-click=$ctrl.markAllImportantRead()><span dm-i18n=ok></span></db-button>\n</div>\n</db-popover>\n<i ng-hide="$ctrl.importantFilter || $ctrl.currentTab === \'favorites\'" class="icon-plus-circle cursor-pointer margin-left-xxsmall _24" ng-click=$ctrl.newConversation() db-tooltip={{$ctrl.i18n.newConversation}} db-tooltip-close-on-click=true></i>\n<span ng-hide="$ctrl.importantFilter || $ctrl.currentTab !== \'favorites\'" class=reorder-link ng-click=$ctrl.toggleReorder() db-tooltip={{$ctrl.i18n.reorderTooltip}}>{{$ctrl.reorderMode ? $ctrl.i18n.doneReordering : $ctrl.i18n.reorder}}</span>\n</div>\n'},2474:function(e,n,t){angular.module("buzz").directive("bzNavZeroState",["bzRootPath","dmI18n","bzModals",function(e,n,a){var i=e+"/navigation/zero-state/";return{template:t(2475),scope:{viewMode:"=",currentTab:"=",updateViewMode:"&"},link:function(e,t,s){function o(){r()}function r(){switch(e.currentTab){case"all":e.heading=u.noFOMO,e.subtext=u.neverMissAThing,e.image=p.all,e.buttonText=u.getStarted;break;case"people":e.heading=u.chatPrivatelyWith,e.subtext="",e.image=p.people,e.buttonText=u.startAChat;break;case"data":e.heading=u.haveConversationsWith,e.subtext=u.youCanStartNewConversations,e.image=p.data,e.buttonText=u.browseExistingConversations;break;case"favorites":e.heading=u.addAFavorite,e.subtext=u.addAFavoriteText,e.image=p.favorites,e.buttonText=void 0}}function c(){"FOLDER"===e.viewMode&&"people"===e.currentTab?d():"FOLDER"===e.viewMode&&"data"===e.currentTab&&l()}function l(){e.updateViewMode({$event:{viewMode:"FEED"===e.viewMode?"FOLDER":"FEED"}})}function d(){a.open("createChat")}var u=u={chatPrivatelyWith:n.get("buzz/chat-privately-with"),haveConversationsWith:n.get("buzz/have-conversations-with"),noFOMO:n.get("buzz/no-fomo"),youCanStartNewConversations:n.get("buzz/you-can-start-new-conversations"),neverMissAThing:n.get("buzz/never-miss-a-thing"),startAChat:n.get("buzz/start-a-chat"),browseExistingConversations:n.get("buzz/browser-existing-conversations"),getStarted:n.get("buzz/get-started"),addAFavorite:n.get("buzz/add-a-favorite"),addAFavoriteText:n.get("buzz/add-favorite-zero-state")},p={all:i+"all.png",people:i+"people.png",data:i+"data.png",favorites:i+"favorites.png"};e.onZeroActionclick=c,e.$watchGroup(["viewMode","currentTab"],r),o()}}}])},2475:function(e,n){e.exports="\n<div class=bz-nav-zero-state ng-class=\"{'keep-text': currentTab == 'data'}\">\n<div class=heading>{{heading}}</div>\n<div class=subtext>{{subtext}}</div>\n<img class=image ng-src={{image}} alt={{alt}}>\n<db-button ng-if=buttonText class=button theme=inverse ng-click=onZeroActionclick()>{{buttonText}}</db-button>\n</div>"},2476:function(e,n,t){var a=t(81);angular.module("buzz").component("bzFolderView",{template:t(2477),bindings:{viewMode:"<",currentTab:"<",importantFilter:"<",reorderMode:"<",isFiltering:"<",allowInviting:"<",updateViewMode:"&",setFiltering:"&",toggleReorder:"=",toggleImportantFilter:"="},controller:["bzNavigationService","bzEvents","bzPreferences","bzStore","bzService","dmI18n","$element","$window","$scope","bzRouteTracking","bzHelpers","dmUserInviteModalService","features","bzDebugService","Analytics","dmBootstrap","buzzContainerService",function(e,n,t,i,s,o,r,c,l,d,u,p,h,g,m,b,v){function f(){ae.showMenuHuddles=Y(ae.currentTab),ae.currentChannel=i.currentChannel,ae.filterChannels=N,ae.clearFilter=V,ae.i18n.filterPlaceholder=o.get("buzz/search-title"),ae.i18n.footerText=o.get("buzz/invite-users-to"),ae.i18n.invite=o.get("buzz/invite"),$()}function z(){a.delay(function(){se=r.find(".bz-folder-lists"),oe=se[0],oe.onscroll=R,c.addEventListener("resize",re)},300)}function y(e){e.currentTab&&(e.currentTab.currentValue!==e.currentTab.previousValue&&j(),a.delay(function(){V(),ae.showMenuHuddles=Y(e.currentTab.currentValue),l.$digest()},300)),e.importantFilter&&!e.currentTab&&V(),e.viewMode&&(V(),ae.loadingChannels=!1,e.viewMode.currentValue!==e.viewMode.previousValue&&"FOLDER"===e.viewMode.currentValue&&(ae.channels=C())),e.reorderMode&&(ce.removeClass("show"),le.removeClass("show"),de.topFlag=!1,de.bottomFlag=!1,D()),e.allowInviting&&(ae.freeInvite=ne&&e.allowInviting.currentValue||te),K()?he.register():he.unregister()}function w(){i.isLoaded?M():ae.cancellers.push(n.buzzLoaded.on(M)),ae.cancellers.push(n.navItemUpdated.on(I)),ae.cancellers.push(t.onUpdated(_)),ae.cancellers.push(n.channelChange.on(T)),ae.cancellers.push(n.missedMessage.on(re)),ae.cancellers.push(v.registerFullscreenListener(re)),ae.cancellers.push(n.menuSorted.on(re)),ae.cancellers.push(n.menuHeightChanged.on(re)),ae.cancellers.push(n.nowViewingUpdated.on($)),ae.cancellers.push(n.nextChannel.on(S)),ae.cancellers.push(n.systemResumeFromSleep.on(function(){return k("systemResumeFromSleep")})),ae.cancellers.push(n.connectivityChanged.on(function(){return k("connectivityChanged")})),ae.cancellers.push(n.buzzConnectivityChanged.on(function(){return k("buzzConnectivityChanged")})),ae.cancellers.push(n.visibilityChanged.on(function(){return k("visibilityChanged")})),pe.focusin(P)}function k(e){var n="setChannelsDelayed called by "+e;g.println(n),a.delay(function(){ae.isFiltering||(ae.channels=C())},300)}function C(){var n=ae.importantFilter,t=ae.currentTab;return{data:e.getChannels("data"),people:e.getChannels("people"),all:e.getChannels("all"),favorites:e.getChannels("favorites"),filtered:n?e.getChannels(t,!0):[],importantGroups:n?e.getChannelsGroupedByImportance(t):{}}}function x(e){return"people"===ae.currentTab?"people"===e.filterType:"data"===ae.currentTab?"data"===e.filterType:"all"===ae.currentTab||void 0}function _(e){switch(e.constant){case"ENABLE_MENU_THREADS":ae.showMenuHuddles=Y(ae.currentTab)}}function T(){i.currentChannel.id&&(ae.currentChannel=i.currentChannel,re())}function M(){ae.channels=C(),ae.initialLoad=!1}function I(){ae.isFiltering?N():(ae.channels=C(),re())}function $(e){ae.contextObject=a.isUndefined(e)?d.currentObject:e.contextObject,a.isEmpty(e)&&!a.isEmpty(ae.contextObject)?s.createObjectChannel(ae.contextObject).then(function(e){ae.nowViewing=e}):ae.nowViewing=a.isUndefined(e)||a.isUndefined(e.channel)?null:e.channel,n.menuHeightChanged.trigger()}function A(){a.each(ae.cancellers,function(e){return e()}),c.removeEventListener("resize",re),pe.off("focusin",P),he.unregister()}function S(e){var n=u.nextChannel(ie,i.currentChannel.parentChannel,e);n&&n!==i.currentChannel.channelId&&i.setCurrentChannel(n)}function P(){m.track("buzz_title_filter")}function E(){var e=".bz-folder-list.show-me bz-folder-item";ie=document.querySelectorAll(e),O(),angular.forEach(ie,function(e,n){var t=angular.element(e),a=t.scope().channel;a&&(!t.hasClass("nav-item-selector")||t.offsetHeight<=0||(U(a,e),a.$domo_displayIndex=n))}),D()}function O(){de.top=Number.MAX_SAFE_INTEGER,de.bottom=Number.MIN_SAFE_INTEGER}function U(e,n){(e.unreadCounts.messages&&e.importantCounts.messages||e.unreadCounts.huddleMessages&&e.importantCounts.huddleMessages)&&(de.top=Math.min(de.top,n.offsetTop+20),de.bottom=Math.max(de.bottom,n.offsetTop+n.offsetHeight-oe.offsetHeight+ee))}function D(){if(oe){var e=oe.scrollTop;ae.isFiltering||ae.reorderMode||(!de.topFlag&&e>de.top?(ce.addClass("show"),de.topFlag=!0):de.topFlag&&e<de.top&&(ce.removeClass("show"),de.topFlag=!1),!de.bottomFlag&&e<de.bottom?(le.addClass("show"),de.bottomFlag=!0):de.bottomFlag&&e>de.bottom&&(le.removeClass("show"),de.bottomFlag=!1))}}function R(){ue()}function j(){se&&se.animate({scrollTop:0},150)}function L(e,n){se.animate({scrollTop:de[e]+n},300)}function N(n,t){return n&&q(),ae.channels=C(),ae.i18n.filteredLabel=o.get("buzz/filtered-label",{filterTerm:ae.filterTerm}),!ae.filterTerm||ae.filterTerm.length<=0?(H(),n&&j()):(ce.removeClass("show"),le.removeClass("show"),de.topFlag=!1,de.bottomFlag=!1,ae.channels.filtered=B(),void(n?(ae.otherConversations=[],ae.fetchingOtherConversations=!0,e.getConversationsByTerm(ae.filterTerm,{includeMessages:!0,messageLimit:1,includeHuddles:!0,huddleLimit:10}).then(function(n){return ae.fetchingOtherConversations=!1,!ae.filterTerm||ae.filterTerm.length<=0?H():(ae.otherConversations=e.filterChannelsByTerm(n,ae.filterTerm),void(ae.otherConversations=F(ae.otherConversations,ae.channels.filtered)))})):ae.otherConversations=F(ae.otherConversations,ae.channels.filtered)))}function F(e,n){for(var t=e.length-1;t>=0;t--)for(var a=0;a<n.length;a++)n[a].id==e[t].id&&e.splice(t,1);return e}function H(){ae.otherConversations=[],a.delay(re,400,!0),a.chain(ae.channels).values().flatten().each(function(e){e.highlightedTitle=null,
a.each(e.filteredHuddles,function(e){return e.highlightedTitle=null}),e.huddleFilterTermIndex=-1,e.filteredHuddles=[]})}function B(){return e.filterChannelsByTerm(ae.channels.all,ae.filterTerm,!0)}function G(e){return ae.showZero=!(ae.channels[e].length||ae.filterTerm.length||ae.importantFilter||ae.initialLoad)}function V(e){ae.filterTerm="",q(),ae.channels.filtered=[],N(void 0,e)}function q(){ae.setFiltering({$event:{filtering:!!(ae.filterTerm&&ae.filterTerm.length>0)}})}function W(e){ae.updateViewMode({$event:e})}function Y(e){return!!e&&t.enableMenuThreads}function J(){p.open({element:r,analyticsEvent:"buzz_navigation_menu",message:o.get("invite-prompt")})}function K(){return ae.importantFilter&&0===ae.filterTerm.length}function Z(){ae.channels.importantGroups=e.getChannelsGroupedByImportance(ae.currentTab)}function Q(){var e=[];return{register:function(){0===e.length&&e.push(n.channelMetaUpdated.on(Z))},unregister:function(){e.length>0&&(e.forEach(function(e){return e()}),e=[])}}}function X(e){V()}var ee=0,ne=h.on("free-invite")&&h.on("free-role"),te="free"==b.data.customerTier||"trial"==b.data.customerTier,ae=this,ie=[],se=void 0,oe=void 0,re=a.debounce(E,400),ce=r.find(".top-indicator"),le=r.find(".bottom-indicator"),de={top:Number.MAX_SAFE_INTEGER,bottom:Number.MIN_SAFE_INTEGER,topFlag:!1,bottomFlag:!1},ue=a.throttle(D,100),pe=r.find(".quick-search"),he=Q();ae.$onInit=f,ae.$postLink=z,ae.$onChanges=y,ae.$onDestroy=A,ae.matchTab=x,ae.updateMyViewMode=W,ae.isFilterOn=q,ae.isZeroState=G,ae.inviteUser=J,ae.onReorderClose=X,ae.channels={data:[],people:[],favorites:[],filtered:[],importantGroups:{}},ae.otherConversations=[],ae.cancellers=[],ae.showMenuHuddles=null,ae.currentChannel=null,ae.contextObject=null,ae.nowViewing=null,ae.filterTerm="",ae.i18n={},ae.loadingChannels=!0,ae.showZero=null,ae.initialLoad=!0,ae.freeInvite=ne&&ae.allowInviting||te,ae.fetchingOtherConversations=!1,ae.isOnMentionFiltering=K,ae.scrollToOffscreenActivity=L,w()}]})},2477:function(e,n){e.exports='<div class=bz-folder-body-top>\n<div class=quick-search ng-hide=$ctrl.reorderMode>\n<span class=search-input>\n<i class="icon-search sm"></i>\n<input type=text class=input placeholder={{::$ctrl.i18n.filterPlaceholder}} ng-model=$ctrl.filterTerm ng-model-options="{debounce: 300}" ng-change=$ctrl.filterChannels(true) />\n<i class="icon-x sm" ng-show="$ctrl.filterTerm.length > 0" ng-click=$ctrl.clearFilter()></i>\n</span>\n</div>\n<bz-navigation-filter ng-if=!$ctrl.isFiltering important-filter=$ctrl.importantFilter toggle-filter=$ctrl.toggleImportantFilter(filter) toggle-reorder=$ctrl.toggleReorder() reorder-mode=$ctrl.reorderMode current-tab=$ctrl.currentTab is-filtering=$ctrl.filtering>\n</bz-navigation-filter>\n<div class="activity-indicator top-indicator dm-animate" ng-click="$ctrl.scrollToOffscreenActivity(\'top\',-22)">\n<span></span>\n<i class=icon-chevron-up></i>\n</div>\n<div class=bz-folder-top-shadow></div>\n</div>\n<div class="bz-folder-view dm-animate" ng-class="{\'hide-huddles\':!$ctrl.showMenuHuddles, \'filtered-list\': $ctrl.isFiltering}" ng-show="$ctrl.channels !== null">\n<div ng-show="$ctrl.importantFilter && $ctrl.channels.length === 0 && !$ctrl.filterTerm" class="bz-folder-mention-zero bz-text-italics bz-text-body inverse" dm-i18n=buzz/no-unread-mentions>\n</div>\n<div ng-show=$ctrl.filterTerm.length>\n<div class=bz-folder-filter-header>\n<span class=bz-text-label>{{$ctrl.i18n.filteredLabel}}</span>\n</div>\n</div>\n<div class=bz-folder-lists ng-hide=$ctrl.reorderMode>\n<div class="bz-folder-list people-list" ng-class="{\'show-me\': $ctrl.currentTab === \'people\'}" ng-hide="$ctrl.isFiltering || $ctrl.importantFilter || ($ctrl.channels.filtered && $ctrl.channels.filtered.length)">\n<bz-folder-item ng-repeat="channel in $ctrl.channels[\'people\'] track by channel.id" class="nav-item-selector dm-animate" bz-channel=channel channel-last-updated=channel.lastUpdated current-channel=$ctrl.currentChannel current-tab=$ctrl.currentTab>\n</bz-folder-item>\n<bz-nav-zero-state ng-if="$ctrl.isZeroState(\'people\')" view-mode=$ctrl.viewMode current-tab=$ctrl.currentTab update-view-mode=$ctrl.updateMyViewMode($event)></bz-nav-zero-state>\n<div ng-hide="$ctrl.freeInvite || $ctrl.initialLoad" class=bz-footer-logo>\n<img class=buzz-logo-normal src=/public/javascripts/buzz/buzz-logo-white-small.png />\n</div>\n<div ng-show="$ctrl.freeInvite && !$ctrl.initialLoad" class=bz-footer-logo>\n<div class=bz-footer-image>\n<span class=bz-navigation-footer-text>\n{{$ctrl.i18n.footerText}}\n</span>\n<img class=buzz-logo-small src=/public/javascripts/buzz/buzz-logo-white-small.png />\n</div>\n<div class=bz-footer-button>\n<db-button theme=inverse ng-click=$ctrl.inviteUser()><i class=icon-person-plus></i> {{$ctrl.i18n.invite}}</db-button>\n</div>\n</div>\n</div>\n<div class="bz-folder-list favorites-list" ng-class="{\'show-me\': $ctrl.currentTab === \'favorites\'}" ng-hide="$ctrl.isFiltering || $ctrl.importantFilter || ($ctrl.channels.filtered && $ctrl.channels.filtered.length)">\n<bz-folder-item ng-repeat="channel in $ctrl.channels[\'favorites\'] track by channel.id" class="nav-item-selector dm-animate" ng-class="{\'favorited-channel\': (channel.favoritePosition >= 0 && !$ctrl.filterTerm.length), \'current-channel\': $ctrl.currentChannel.id == channel.id}" bz-channel=channel channel-last-updated=channel.lastUpdated current-channel=$ctrl.currentChannel current-tab=$ctrl.currentTab>\n</bz-folder-item>\n<bz-nav-zero-state ng-if="$ctrl.isZeroState(\'favorites\')" view-mode=$ctrl.viewMode current-tab=$ctrl.currentTab update-view-mode=$ctrl.updateMyViewMode($event)></bz-nav-zero-state>\n<div ng-hide="$ctrl.freeInvite || $ctrl.initialLoad" class=bz-footer-logo>\n<img class=buzz-logo-normal src=/public/javascripts/buzz/buzz-logo-white-small.png />\n</div>\n<div ng-show="$ctrl.freeInvite && !$ctrl.initialLoad" class=bz-footer-logo>\n<div class=bz-footer-image>\n<span class=bz-navigation-footer-text>\n{{$ctrl.i18n.footerText}}\n</span>\n<img class=buzz-logo-small src=/public/javascripts/buzz/buzz-logo-white-small.png />\n</div>\n<div class=bz-footer-button>\n<db-button theme=inverse ng-click=$ctrl.inviteUser()><i class=icon-person-plus></i> {{$ctrl.i18n.invite}}</db-button>\n</div>\n</div>\n</div>\n<div class="bz-folder-list data-list" ng-class="{\'show-me\': $ctrl.currentTab === \'data\'}" ng-hide="$ctrl.isFiltering || $ctrl.importantFilter || ($ctrl.channels.filtered && $ctrl.channels.filtered.length)">\n<div class=now-viewing ng-if="$ctrl.nowViewing !== null && $ctrl.currentTab === \'data\' && !$ctrl.importantFilter">\n<span></span>\n<bz-folder-item bz-channel=$ctrl.nowViewing channel-last-updated=$ctrl.nowViewing.lastUpdated show-huddle-count>\n</bz-folder-item>\n</div>\n<div>\n<bz-folder-item ng-repeat="channel in $ctrl.channels[\'data\'] track by channel.id" class="nav-item-selector dm-animate" bz-channel=channel channel-last-updated=channel.lastUpdated current-channel=$ctrl.currentChannel current-tab=$ctrl.currentTab>\n</bz-folder-item>\n</div>\n<bz-nav-zero-state ng-if="$ctrl.isZeroState(\'data\')" view-mode=$ctrl.viewMode current-tab=$ctrl.currentTab update-view-mode=$ctrl.updateMyViewMode($event)></bz-nav-zero-state>\n<div ng-hide="$ctrl.freeInvite || $ctrl.initialLoad" class=bz-footer-logo>\n<img class=buzz-logo-normal src=/public/javascripts/buzz/buzz-logo-white-small.png />\n</div>\n<div ng-show="$ctrl.freeInvite && !$ctrl.initialLoad" class=bz-footer-logo>\n<div class=bz-footer-image>\n<span class=bz-navigation-footer-text>\n{{$ctrl.i18n.footerText}}\n</span>\n<img class=buzz-logo-small src=/public/javascripts/buzz/buzz-logo-white-small.png />\n</div>\n<div class=bz-footer-button>\n<db-button theme=inverse ng-click=$ctrl.inviteUser()><i class=icon-person-plus></i> {{$ctrl.i18n.invite}}</db-button>\n</div>\n</div>\n</div>\n<div class=bz-folder-list ng-show="$ctrl.isFiltering || $ctrl.importantFilter">\n<div class=other-conversations-filter ng-show=$ctrl.isFiltering>\n<div class="folder-section my-conversations" dm-i18n=buzz/your-conversations></div>\n<div class="bz-folder-filter-zero bz-text-italics bz-text-body inverse ng-scope" ng-hide=$ctrl.channels.filtered.length dm-i18n=buzz/no-filter-matches></div>\n<bz-folder-item ng-repeat="channel in $ctrl.channels.filtered track by channel.id" bz-channel=channel channel-last-updated=channel.lastUpdated class="nav-item-selector dm-animate" current-tab=$ctrl.currentTab current-channel=$ctrl.currentChannel filtered=::$ctrl.isFiltering>\n</bz-folder-item>\n</div>\n<div class=other-conversations-filter ng-show=$ctrl.isFiltering>\n<div class="folder-section other-conversations" dm-i18n=buzz/other-conversations></div>\n<div class="bz-folder-filter-zero bz-text-italics bz-text-body inverse ng-scope" ng-hide="$ctrl.fetchingOtherConversations || $ctrl.otherConversations.length" dm-i18n=buzz/no-filter-matches></div>\n<div class=spinner-wrapper ng-show=$ctrl.fetchingOtherConversations>\n<div class="spinner medium"></div>\n</div>\n<bz-folder-item ng-repeat="channel in $ctrl.otherConversations track by channel.id" bz-channel=channel channel-last-updated=channel.lastUpdated class="nav-item-selector dm-animate" current-tab=$ctrl.currentTab current-channel=$ctrl.currentChannel filtered=::$ctrl.isFiltering>\n</bz-folder-item>\n</div>\n<div class=other-conversations-filter ng-show=$ctrl.isOnMentionFiltering()>\n<div ng-if="$ctrl.channels.importantGroups.directMentions.length > 0">\n<div class="folder-section my-conversations" dm-i18n=buzz/directly-mentioned></div>\n<bz-folder-item ng-repeat="channel in $ctrl.channels.importantGroups.directMentions track by channel.id" bz-channel=channel channel-last-updated=channel.lastUpdated class="nav-item-selector dm-animate" current-tab=$ctrl.currentTab current-channel=$ctrl.currentChannel filtered=false>\n</bz-folder-item>\n</div>\n<div ng-if="$ctrl.channels.importantGroups.groupMentions.length > 0">\n<div class="folder-section my-conversations" dm-i18n=buzz/group-mentioned></div>\n<bz-folder-item ng-repeat="channel in $ctrl.channels.importantGroups.groupMentions track by channel.id" bz-channel=channel channel-last-updated=channel.lastUpdated class="nav-item-selector dm-animate" current-tab=$ctrl.currentTab current-channel=$ctrl.currentChannel filtered=false>\n</bz-folder-item>\n</div>\n<div ng-if="$ctrl.channels.importantGroups.allMentions.length > 0">\n<div class="folder-section my-conversations" dm-i18n=buzz/all-mentioned></div>\n<bz-folder-item ng-repeat="channel in $ctrl.channels.importantGroups.allMentions track by channel.id" bz-channel=channel channel-last-updated=channel.lastUpdated class="nav-item-selector dm-animate" current-tab=$ctrl.currentTab current-channel=$ctrl.currentChannel filtered=false>\n</bz-folder-item>\n</div>\n</div>\n<div ng-show="$ctrl.freeInvite && !$ctrl.initialLoad" class=bz-footer-logo>\n<div class=bz-footer-image>\n<span class=bz-navigation-footer-text>\n{{$ctrl.i18n.footerText}}\n</span>\n<img class=buzz-logo-small src=/public/javascripts/buzz/buzz-logo-white-small.png />\n</div>\n<div class=bz-footer-button>\n<db-button theme=inverse ng-click=$ctrl.inviteUser()><i class=icon-person-plus></i> {{$ctrl.i18n.invite}}</db-button>\n</div>\n</div>\n</div>\n</div>\n<div class=folder-reorder-view ng-if=$ctrl.reorderMode>\n<bz-reorder-view channels="$ctrl.channels[\'favorites\']" current-tab=$ctrl.currentTab on-close=$ctrl.onReorderClose(list)></bz-reorder-view>\n</div>\n</div>\n<div class=bz-folder-body-bottom ng-hide=$ctrl.reorderMode>\n<div class="activity-indicator bottom-indicator dm-animate" ng-click="$ctrl.scrollToOffscreenActivity(\'bottom\',10)">\n<span></span>\n<i class=icon-chevron-down></i>\n</div>\n<div class=bz-folder-bottom-shadow></div>\n</div>\n<div class="bz-folder-body-bottom reorder-mode" ng-if=$ctrl.reorderMode ng-click=$ctrl.toggleReorder()>\n<span dm-i18n=buzz/reorder-done></span>\n</div>\n'},2478:function(e,n,t){var a=t(81);t(8);angular.module("buzz").component("bzReorderView",{template:t(2479),bindings:{channels:"<",currentTab:"<",onClose:"&?"},controller:["bzNavigationService","bzEvents","bzStore","bzService","$element",function(e,n,t,i,s){function o(){p.sortableChannels=angular.copy(p.channels)}function r(){a.delay(d,500)}function c(e){e.channels&&p.sortableChannels&&e.channels.currentValue.length!==p.sortableChannels.length&&(p.sortableChannels=angular.copy(p.channels))}function l(){g.forEach(function(e){e()}),a.each(m,function(e,n){t.channels[e].favoritePosition=n+1}),p.onClose&&p.onClose({list:m})}function d(){h=s.find(".reorder-list"),h.sortable({axis:"y",helper:"clone",handle:".drag-handle",opacity:.9,containment:"parent",cursor:"move",cursorAt:{top:25,left:25},revert:!0,update:u})}function u(e,n){m=[],a.each(s.find("bz-folder-item"),function(e){m.push(angular.element(e).scope().channel.id)}),m.length&&i.updateFavorites(m).then(function(){})}var p=this,h=null,g=[],m=[];p.$onInit=o,p.$postLink=r,p.$onChanges=c,p.$onDestroy=l}]})},2479:function(e,n){e.exports='<div class=bz-reorder-view>\n<div class="bz-folder-list reorder-list">\n<div class=sort-padding></div>\n<bz-folder-item ng-repeat="channel in $ctrl.sortableChannels track by channel.id" class=nav-item-selector bz-channel=channel current-tab=$ctrl.currentTab reorder-mode=true>\n</bz-folder-item>\n</div>\n</div>'},2480:function(e,n,t){var a=t(47);angular.module("buzz").component("bzFolderItem",{template:t(2481),bindings:{bzChannel:"<",channelLastUpdated:"<",currentChannel:"<",currentTab:"<",filtered:"<",reorderMode:"<"},controller:["bzNavigationService","bzPreferences","bzStore","Analytics","bzFolderItemActions","bzEvents","$attrs","bzService","dmI18n","jstz",function(e,n,t,i,s,o,r,c,l,d){function u(){w.i18n={leaveConversation:l.get("buzz/unfollow"),favoritedConversations:l.get("buzz/favorited-conversations"),recentConversations:l.get("buzz/recent-conversations",{type:m(w.bzChannel.filterType)})},w.explicitDate=a(w.bzChannel.lastUpdated).tz(k).format(l.get("date-formats/month-day-time")),y.push(n.onUpdated(b))}function p(){y.forEach(function(e){e()})}function h(e){e.channelLastUpdated&&(w.explicitDate=a(w.channelLastUpdated).tz(k).format("LLL z"))}function g(){w.showHuddleCount=_.has(r,"showHuddleCount")&&"false"!==r.showHuddleCount}function m(e){switch(e){case"data":return l.get("buzz/data");case"people":return l.get("buzz/people")}}function b(e){"ENABLE_MENU_THREADS"===e.constant&&(w.showMenuHuddles=n.enableMenuThreads)}function v(){t.channels[w.bzChannel.id]||(t.channels[w.bzChannel.id]=w.bzChannel),e.setCurrentChannel(w.bzChannel)}function f(e){i.track("buzz_twist_down"),o.menuHeightChanged.trigger(),w.bzChannel.expandHuddles=!w.bzChannel.expandHuddles,e.stopPropagation()}function z(e,n,a){function r(e){switch(e.type){case"DirectChat":i.track("buzz_unpin_direct_chat");break;case"GroupChat":i.track("buzz_unpin_group_chat");break;case"Topic":e.isPublicChannel()?i.track("buzz_unpin_public_channel"):i.track("buzz_unpin_private_channel");break;case"ObjectChat":i.track("buzz_unpin_object_channel")}}if(o.menuHeightChanged.trigger(),n.stopPropagation&&n.stopPropagation(),"DirectChat"===e.type||a){r(e);var c=e.parentChannel.id===w.bzChannel.parentChannel.id&&!e.isDirectChat();t.unpinChannel(e,c).then(function(){angular.element('.tooltip[role="tooltip"]').remove()})}else var l=s.open({channel:w.bzChannel,anchor:"."+w.bzChannel.id+"-actions",unpinChannel:function(e,n,t){l.close(),z(e,n,t)}})}var y=[],w=this,k=d.determine().name();w.$onInit=u,w.$postLink=g,w.$onChanges=h,w.$onDestroy=p,w.text={},w.showHuddleCount=!1,w.showMenuHuddles=n.enableMenuThreads,w.dateFormat=l.get("date-formats/month-day"),w.setCurrentChannel=v,w.toggleHuddleDrawer=f,w.unpinChannel=z}]})},2481:function(e,n){e.exports='<div class=bz-folder-item ng-click=::$ctrl.setCurrentChannel() ng-class="{\'active\': $ctrl.currentChannel.id == $ctrl.bzChannel.id}">\n<div class=item-wrapper>\n<div class=folder-item-content>\n<span class=huddle-drawer-expand ng-class="{\'empty-filtered-list\':!$ctrl.bzChannel.filteredHuddles || !$ctrl.bzChannel.filteredHuddles.length}" ng-click=::$ctrl.toggleHuddleDrawer($event)>\n<i class=icon-chevron-right ng-show=$ctrl.bzChannel.huddles.length ng-class="{\'huddle-drawer-open\': $ctrl.bzChannel.expandHuddles || $ctrl.filtered, \'missed-message\': $ctrl.bzChannel.unreadCounts.huddleMessages}">\n</i>\n</span>\n<bz-conversation-icon bz-channel=::$ctrl.bzChannel></bz-conversation-icon>\n<span class=folder-item-text-content ng-switch=::$ctrl.bzChannel.type>\n<span class="bz-text-body bold bz-text-overflow inverse" ng-class="{\'missed-message\': $ctrl.bzChannel.unreadCounts.messages || $ctrl.bzChannel.unreadCounts.huddleMessages }">\n<span ng-hide="$ctrl.bzChannel.highlightedTitle && $ctrl.filtered" ng-bind=$ctrl.bzChannel.displayTitle></span>\n<span ng-if="$ctrl.bzChannel.highlightedTitle && $ctrl.filtered">\n<span>{{$ctrl.bzChannel.highlightedTitle[0]}}</span><em>{{$ctrl.bzChannel.highlightedTitle[1]}}</em><span>{{$ctrl.bzChannel.highlightedTitle[2]}}</span>\n</span>\n<span class=time-date db-tooltip={{$ctrl.explicitDate}}>\n<span ng-if=$ctrl.bzChannel.showRelativeTime>{{$ctrl.bzChannel.timeAgoWithHuddles}}</span>\n<span ng-if=!$ctrl.bzChannel.showRelativeTime dm-moment={{::$ctrl.bzChannel.lastUpdated}} format={{::$ctrl.dateFormat}}></span>\n</span>\n</span>\n<span ng-switch-when=ObjectChat>\n<span ng-show="$ctrl.bzChannel.unreadCounts.has(\'huddleMessages\')" class="unread-conversation-count bz-text-caption" dm-i18n=buzz/updated-conversations></span>\n<span ng-show="!$ctrl.bzChannel.unreadCounts.has(\'huddleMessages\')" class="unread-conversation-count bz-text-caption" dm-i18n=buzz/no-unread-activity></span>\n</span>\n<bz-nav-last-message ng-switch-default channel=$ctrl.bzChannel show-huddle-count="{{ :: $ctrl.showHuddleCount }}"></bz-nav-last-message>\n</span>\n<div class="folder-item-actions {{::$ctrl.bzChannel.id + \'-actions\'}}" ng-hide=$ctrl.reorderMode>\n<span class=bz-folder-important-indicator ng-if="($ctrl.bzChannel.importantCounts.messages || $ctrl.bzChannel.importantCounts.huddleMessages) && !$ctrl.showHuddleCount">{{($ctrl.bzChannel.importantCounts.messages + $ctrl.bzChannel.importantCounts.huddleMessages) | number}}</span>\n<i class="bz-navigation-icon unpin icon-x" ng-if="!($ctrl.bzChannel.importantCounts.messages || $ctrl.bzChannel.importantCounts.huddleMessages) && !$ctrl.showHuddleCount" db-tooltip={{::$ctrl.i18n.leaveConversation}} ng-click="::$ctrl.unpinChannel($ctrl.bzChannel, $event)"> </i>\n<i class="menu-icon viewing icon-chevron-right"></i>\n</div>\n<div class="folder-item-actions {{::$ctrl.bzChannel.id + \'-actions\'}}" ng-show=$ctrl.reorderMode>\n<div class=drag-handle><i class="icon-lines-horizontal _24"></i></div>\n</div>\n</div>\n</div>\n<bz-huddle-drawer ng-if="$ctrl.bzChannel.expandHuddles && $ctrl.showMenuHuddles && !$ctrl.filtered" bz-channel=$ctrl.bzChannel huddles=$ctrl.bzChannel.huddles current-channel=$ctrl.currentChannel important-huddle-messages-count=$ctrl.bzChannel.importantCounts.huddleMessages show-filtered-huddles=false>\n</bz-huddle-drawer>\n<bz-huddle-drawer ng-if="$ctrl.showMenuHuddles && $ctrl.filtered && $ctrl.bzChannel.filteredHuddles && $ctrl.bzChannel.filteredHuddles.length" bz-channel=$ctrl.bzChannel huddles=$ctrl.bzChannel.filteredHuddles current-channel=$ctrl.currentChannel important-huddle-messages-count=$ctrl.bzChannel.importantCounts.huddleMessages show-filtered-huddles=true>\n</bz-huddle-drawer>\n</div>\n'},2482:function(e,n,t){angular.module("buzz").component("bzHuddleDrawer",{template:t(2483),bindings:{bzChannel:"<",huddles:"<",importantHuddleMessagesCount:"<",showFilteredHuddles:"<",currentChannel:"<"},controller:["bzService","bzNavigationService","bzStore","bzEvents","CurrentUser",function(e,n,t,a,i){function s(){p.huddleLimit=d,l()}function o(e){e.importantHuddleMessagesCount&&l()}function r(n){var t;n.stopPropagation(),p.loadingMoreHuddles||p.huddles&&p.huddles.length&&(p.huddleLimit+u<p.huddles.length?(p.huddleLimit+=u,l()):(t=_.reduce(p.huddles,function(e,n){return _.isUndefined(e)?n:e.lastUpdated<n.lastUpdated?e:n},{}),p.loadingMoreHuddles=!0,e.getHuddlesForChannel(p.bzChannel.id,{pagingId:t.id,pagingMode:"MOST_RECENT",pagingLimit:u,includeMessages:!0}).then(function(e){e&&_.each(e.reverse(),function(e){return p.huddles.push(e)}),p.huddleLimit+=u,p.loadingMoreHuddles=!1,a.menuHeightChanged.trigger()}).catch(function(e){p.loadingMoreHuddles=!1}).finally(l).catch(function(e){console.error(e)})))}function c(e,a){a.stopPropagation(),t.channels[p.bzChannel.id]||(t.channels[p.bzChannel.id]=p.bzChannel),n.setCurrentChannel(e)}function l(){var e=p.huddles.sort(function(e,n){return n.lastUpdated-e.lastUpdated}).slice(0,p.huddleLimit).reduce(function(e,n){return e+(n.importantCounts?n.importantCounts.messages:0)},0);p.showMoreIndicator=e<p.importantHuddleMessagesCount}var d=5,u=5,p=this;this.huddleLimit=0,this.loadingMoreHuddles=!1,this.currentChannelId=null,this.showMoreIndicator=!1,this.currentUserId=i.domoUserId,this.$onInit=s,this.$onChanges=o,this.addMoreHuddles=r,this.setCurrentChannel=c}]})},2483:function(e,n){e.exports='<div class=bz-huddle-drawer>\n<div class=bz-folder-huddle ng-repeat="huddle in $ctrl.huddles | orderBy: [\'sortValue\', \'-lastUpdated\'] | limitTo: $ctrl.huddleLimit track by huddle.id" ng-class="{\'active\': huddle.id === $ctrl.currentChannel.id}" ng-click="$ctrl.setCurrentChannel(huddle, $event)">\n<span class=branch-top>\n<i class="icon-lock-closed private-huddle" ng-show="huddle.inheritPermissions === false">\n</i>\n</span>\n<span class=branch-bottom ng-class="{\'last\':$last}">\n</span>\n<span class=avatar dm-avatar-widget="{{ :: huddle.createdById }}" size=large noclick=true>\n</span>\n<span class=title-message>\n<span class="bz-text-caption inverse menu-huddle-title-text" db-tooltip={{huddle.tooltip}} db-tooltip-placement=right ng-class="{\'missed-message\':huddle.unreadCounts.messages}">\n<span ng-hide="huddle.highlightedTitle && $ctrl.showFilteredHuddles" ng-bind=huddle.displayTitle></span>\n<span ng-if="huddle.highlightedTitle && $ctrl.showFilteredHuddles">{{huddle.highlightedTitle[0]}}<em>{{huddle.highlightedTitle[1]}}</em>{{huddle.highlightedTitle[2]}}</span>\n</span>\n</span>\n<div class=folder-item-actions>\n<span class=bz-folder-important-indicator ng-show=huddle.importantCounts.messages>{{huddle.importantCounts.messages | number}}</span>\n</div>\n</div>\n<div class=show-view-more ng-if="$ctrl.bzChannel.huddles.length > $ctrl.huddleLimit && !$ctrl.showFilteredHuddles">\n<span class="bz-text-caption inverse show-more-text" dm-i18n=buzz/show-more-huddles data="{unread:\'\'}" ng-click=$ctrl.addMoreHuddles($event)>\n</span>\n<span class="spinner small" ng-show=$ctrl.loadingMoreHuddles>\n</span>\n<span class=hidden-important-messages ng-show="$ctrl.showMoreIndicator && !$ctrl.loadingMoreHuddles">\n</span>\n</div>\n</div>\n'},2484:function(e,n,t){var a=t(8);angular.module("buzz").service("bzFolderItemActions",["$rootScope","$compile","$q","$timeout",function(e,n,t,i){function s(s){function l(){p.resolve(),u()}function d(){r&&(r.data.open=!1),i(function(){p.reject("CLOSED BY CALLER"),u()})}function u(){i(function(){r&&!r.$$destroyed&&r.$destroy()})}s=s||{},_.isUndefined(r)||r.$destroy();var p=t.defer(),h=a(c);return a("body").append(h),r=e.$new(),r.show=!0,r.data={},r.data.anchor=s.anchor,r.data.channel=s.channel,r.unpinChannel=s.unpinChannel,r.onDropdownClosed=l,o=n(h)(r),i(function(){r.data.open=!0}),r.$on("$destroy",function(){o.remove(),o=void 0,r=void 0}),{close:d,result:p.promise}}var o,r,c=['<db-popover class="popover" anchor="{{data.anchor}}" ng-show="show" placement="right-center" self-close>','<div class="popover-arrow"></div>',"<div>",'<span class="bz-text-display-6 bold" dm-i18n="buzz/unfollow-conversation"></span>',"</div>",'<div class="bz-leave-conversation-body">','<span dm-i18n="buzz/leave-conversation-body"></span>',"</div>",'<div class="bz-leave-conversation-actions">','<db-button theme="alt" ng-click="onDropdownClosed()"><span dm-i18n="cancel"></span></db-button>','<db-button theme="danger" ng-click="unpinChannel(data.channel, $event, true)"><span dm-i18n="buzz/unfollow"></span></db-button>',"</div>","</db-popover>"].join("");this.open=s}])},2485:function(e,n,t){angular.module("buzz").component("bzFeedView",{template:t(2486),bindings:{viewMode:"<",currentFeedTab:"<",allowInviting:"<"},controller:["bzNavigationService","bzService","dmUtils","dmI18n","dmUserInviteModalService","features","$element","buzzContainerService","dmBootstrap",function(e,n,t,a,i,s,o,r,c){function l(){w.getRecentActivity=p,w.i18n.footerText=a.get("buzz/invite-users-to"),w.i18n.inviteUser=a.get("buzz/invite-user"),M.push(r.registerToggleListener(function(e){w.buzzIsOpen=e,m()})),m()}function d(e){if(e.currentFeedTab){var n=v(e.currentFeedTab.currentValue);t.localStorageWrite("buzzNavigationCurrentFeedTab",e.currentFeedTab.currentValue),w.recentActivity=[],w.loadingRecentActivity=!0,p(n)}e.allowInviting&&(w.freeInvite=z&&e.allowInviting.currentValue||y),m()}function u(){g(),C=null,M.forEach(function(e){return e()})}function p(n){w.showZeroState=!1,x&&x.abort&&x.abort(),w.loadingRecentActivity=!0,n||(n=v(w.currentFeedTab)),x=e.getRecentActivity(n.channelTypes,n.huddleTypes,n.favorited),x.then(function(e){w.recentActivity=e,w.latestActivityCount=0,b(),0===w.recentActivity.length&&(w.showZeroState=!0),w.loadingRecentActivity=!1})}function h(){k||(k=setInterval(function(){if(C){var e={timestamp:C};_.extend(e,v(w.currentFeedTab)),n.getLatestActivityCount(e).then(function(e){w.latestActivityCount=e})}},T))}function g(){null!=k&&(clearInterval(k),k=null)}function m(){w.isFeedAndOpen()?h():g()}function b(){C=(new Date).getTime()}function v(e){var n=[],t=void 0;switch(e){case"people":n=["GROUP_CHAT","DIRECT_CHAT","TOPIC","HUDDLE"],t=["GROUP_CHAT","DIRECT_CHAT","TOPIC"];break;case"data":n=["HUDDLE"],t=["OBJECT_CHAT"];break;default:n=["TOPIC","HUDDLE","GROUP_CHAT","DIRECT_CHAT"]}return{channelTypes:n,huddleTypes:t,favorited:"favorites"===e}}function f(){w.freeInvite&&i.open({element:o,analyticsEvent:"buzz_navigation_menu",message:a.get("invite-prompt")})}var z=s.on("free-invite")&&s.on("free-role"),y="free"==c.data.customerTier||"trial"==c.data.customerTier,w=this,k=void 0,C=void 0,x=void 0,T=3e4,M=[];w.$onInit=l,w.$onChanges=d,w.$onDestroy=u,w.inviteUser=f,w.latestActivityCount=0,w.loadingRecentActivity=!1,w.showZeroState=!1,w.recentActivity=[],w.freeInvite=z&&w.allowInviting||y,w.i18n={},w.buzzIsOpen=r.buzzIsOpen,w.isFeedAndOpen=function(){return"FEED"===w.viewMode&&w.buzzIsOpen}}]})},2486:function(e,n){e.exports='<bz-nav-zero-state ng-if=$ctrl.showZeroState current-tab=$ctrl.currentFeedTab view-mode=$ctrl.viewMode></bz-nav-zero-state>\n<div class=bz-feed-view>\n<div class=bz-feed-pulldown ng-class="{\'show\': $ctrl.latestActivityCount || $ctrl.loadingRecentActivity}" ng-click=$ctrl.getRecentActivity()>\n<div ng-if="$ctrl.latestActivityCount && !$ctrl.loadingRecentActivity">\n<span dm-i18n=buzz/activity-count data="{count: $ctrl.latestActivityCount}"></span>\n<i class=icon-arrow-up></i>\n</div>\n<div class=channel-spinner ng-show=$ctrl.loadingRecentActivity>\n<div class="spinner medium"></div>\n</div>\n</div>\n<div class="bz-navigation-scroll-container bz-feed-scroll">\n<ul class=bz-feed-list>\n<li ng-repeat="item in $ctrl.recentActivity">\n<bz-feed-item item=item></bz-feed-item>\n</li>\n</ul>\n<div ng-hide="$ctrl.loadingRecentActivity || $ctrl.freeInvite" class=bz-footer-logo>\n<img class=buzz-logo-normal src=/public/javascripts/buzz/buzz-logo-white-small.png />\n</div>\n<div ng-show="$ctrl.freeInvite && !$ctrl.loadingRecentActivity" class=bz-footer-logo>\n<div class=bz-footer-image>\n<span class=bz-navigation-footer-text>\n{{$ctrl.i18n.footerText}}\n</span>\n<img class=buzz-logo-small src=/public/javascripts/buzz/buzz-logo-white-small.png />\n</div>\n<div class=bz-footer-button>\n<db-button theme=inverse ng-click=$ctrl.inviteUser()><i class=icon-person-plus></i> {{$ctrl.i18n.inviteUser}}</db-button>\n</div>\n</div>\n</div>\n</div>\n'},2487:function(e,n,t){angular.module("buzz").component("bzFeedItem",{template:t(2488),bindings:{item:"<"},controller:["bzNavigationService","Analytics",function(e,n){function t(){}function a(e){}function i(){s.item&&(n.track("buzz_feed_conversation_view"),e.setCurrentChannel(s.item))}var s=this;this.$onInit=t,this.$onChanges=a,this.previewChannel=i}]})},2488:function(e,n){e.exports="<div class=bz-feed-item ng-click=$ctrl.previewChannel()>\n<bz-feed-channel item=$ctrl.item></bz-feed-channel>\n</div>"},2489:function(e,n,t){var a=t(47);angular.module("buzz").component("bzFeedChannel",{template:t(2490),bindings:{item:"<"},controller:["bzService","jstz","dmI18n",function(e,n,t){function i(){"CARD"===r.item.objectType&&e.getCardDetails(r.item.objectId,{width:30,height:30}).then(function(e){r.cardPreview="data:image/png;base64,"+e.image.data})}function s(e){}function o(e){return a(e).tz(c).format(t.get("date-formats/month-day-time"))}var r=this,c=n.determine().name(),l=new Date;r.$onInit=i,r.$onChanges=s,r.explicitDate=a(r.item.lastUpdated).tz(c).format(t.get("date-formats/month-day-time")),r.beginOfDay=new Date(l.getFullYear(),l.getMonth(),l.getDate(),0,0,0),r.getExplicitTimestamp=o,r.relativeMessageFormat=t.get("date-formats/month-day-hour-min"),this.avatarGroupOptions={user:{noclick:!0,noTooltip:!0},group:{noclick:!0,noTooltip:!0}}}]})},2490:function(e,n){e.exports='<div class=bz-feed-channel>\n<div class=bz-feed-channel-item ng-switch=$ctrl.item.type>\n<div class=bz-feed-item-image ng-switch=$ctrl.item.parentChannelType ng-switch-when=Huddle>\n<span ng-switch-when=OBJECT_CHAT ng-switch=$ctrl.item.parentObjectType>\n<i ng-switch-when=PAGE class="icon-pages-bars _24"></i>\n<i ng-switch-when=PROJECT class="icon-project _24"></i>\n<i ng-switch-when=CARD ng-if=!$ctrl.cardPreview class="icon-chart-bar-vertical _24"></i>\n<img ng-switch-when=CARD ng-if=$ctrl.cardPreview src={{$ctrl.cardPreview}} />\n</span>\n<span class=avatar ng-switch-when=DIRECT_CHAT dm-avatar-widget={{$ctrl.item.themId}} size=micro></span>\n<dynamic-avatar-group ng-switch-when=GROUP_CHAT accesses=$ctrl.item.accesses options=$ctrl.avatarGroupOptions></dynamic-avatar-group>\n<i ng-switch-default class="icon-chat-bubbles _24"></i>\n</div>\n<div class=bz-feed-item-image ng-switch=$ctrl.item.type ng-switch-default>\n<span ng-switch-when=ObjectChat ng-switch=$ctrl.item.objectType>\n<i ng-switch-when=PAGE class="icon-pages-bars _24"></i>\n<i ng-switch-when=PROJECT class="icon-project _24"></i>\n<i ng-switch-when=CARD ng-if=!$ctrl.cardPreview class="icon-chart-bar-vertical _24"></i>\n<img ng-switch-when=CARD ng-if=$ctrl.cardPreview src={{$ctrl.cardPreview}} />\n</span>\n<span class=avatar ng-switch-when=DirectChat dm-avatar-widget={{$ctrl.item.themId}} size=micro></span>\n<dynamic-avatar-group ng-switch-when=GroupChat accesses=$ctrl.item.accesses options=$ctrl.avatarGroupOptions></dynamic-avatar-group>\n<i ng-switch-default class="icon-chat-bubbles _24"></i>\n</div>\n<div class=bz-feed-item-header>\n<span class=bz-feed-item-content ng-class="{\'huddle-item\': $ctrl.item.type === \'Huddle\'}">\n<span class=bz-feed-huddle-item-content ng-if="$ctrl.item.type === \'Huddle\'">\n<i class=icon-chat-bubble-lines></i>\n<span dm-i18n=buzz/thread-in data="{title: $ctrl.item.parentChannelTitle}" safe-data="{startNotBold: \'<em>\', endNotBold: \'</em>\'}"></span>\n</span>\n<span>\n<span>{{$ctrl.item.displayTitle || $ctrl.item.displayName}}</span>\n</span>\n</span>\n</div>\n</div>\n<div ng-if=$ctrl.item.messages.length class=bz-feed-messages>\n<div ng-repeat="msg in $ctrl.item.messages.slice() track by msg.id" class=bz-feed-message>\n<span class=avatar ng-if=!msg.createdBy.iconUrl dm-avatar-widget={{msg.createdById}} size=micro></span>\n<span class=tp-avatar ng-if=msg.createdBy.iconUrl><img ng-src={{::msg.createdBy.iconUrl}}></span>\n<div class=message-content>\n<div class=message-header>\n<span class=message-title>{{msg.createdBy.displayName}}</span>\n<span class=message-created ng-show="$ctrl.beginOfDay >= msg.created"><span db-tooltip={{$ctrl.getExplicitTimestamp(msg.created)}} dm-moment={{msg.created}} format={{::$ctrl.relativeMessageFormat}}></span></span>\n<span class=message-created ng-show="$ctrl.beginOfDay < msg.created"><span db-tooltip={{$ctrl.getExplicitTimestamp(msg.created)}}>{{msg.timeSinceUpdate}}</span></span>\n</div>\n<span ng-if="!msg.content.text.length && msg.attachments.length" class=bz-text-italics dm-i18n=buzz/attachment-posted></span>\n<bz-markup-renderer content=msg.content></bz-markup-renderer>\n</div>\n</div>\n</div>\n</div>';
},2491:function(e,n,t){angular.module("buzz").component("bzFeedHuddle",{template:t(2492),bindings:{item:"<"},controller:["bzService",function(e){function n(){"CARD"===a.item.parentObjectType&&e.getCardDetails(a.item.parentObjectId,{width:30,height:30}).then(function(e){a.cardPreview="data:image/png;base64,"+e.image.data}),a.firstMessage=a.item.originalMessage||a.item.messages[a.item.messages.length-1],a.lastMessage=a.item.messages.length>1?a.item.messages[0]:null}function t(e){}var a=this;this.$onInit=n,this.$onChanges=t,this.avatarGroupOptions={user:{noclick:!0,noTooltip:!0},group:{noclick:!0,noTooltip:!0}}}]})},2492:function(e,n){e.exports='<div class=bz-feed-huddle>\n<div class=bz-feed-huddle-item>\n<div class=bz-feed-item-image ng-switch=$ctrl.item.parentChannelType>\n<span ng-switch-when=OBJECT_CHAT ng-switch=$ctrl.item.parentObjectType>\n<i ng-switch-when=PAGE class="icon-pages-bars _24"></i>\n<i ng-switch-when=PROJECT class="icon-project _24"></i>\n<i ng-switch-when=CARD ng-if=!$ctrl.cardPreview class="icon-chart-bar-vertical _24"></i>\n<img ng-switch-when=CARD ng-if=$ctrl.cardPreview src={{$ctrl.cardPreview}} />\n</span>\n<span class=avatar ng-switch-when=DIRECT_CHAT dm-avatar-widget={{$ctrl.item.themId}} size=micro></span>\n<dynamic-avatar-group ng-switch-when=GROUP_CHAT accesses=$ctrl.item.accesses options=$ctrl.avatarGroupOptions></dynamic-avatar-group>\n<i ng-switch-default class="icon-chat-bubbles _24"></i>\n</div>\n<div class=bz-feed-item-header>\n<span class=bz-feed-item-content>\n<span>{{$ctrl.item.displayTitle}}</span>\n</span>\n</div>\n<span class=bz-feed-time-ago>{{$ctrl.item.timeAgo}}</span>\n</div>\n<div ng-if=$ctrl.item.messages.length class=bz-feed-messages>\n<div class=bz-feed-message ng-if=$ctrl.lastMessage>\n<span class=avatar ng-if=!$ctrl.lastMessage.createdBy.iconUrl dm-avatar-widget={{$ctrl.lastMessage.createdById}} size=micro></span>\n<span class=tp-avatar ng-if=$ctrl.lastMessage.createdBy.iconUrl><img ng-src={{::$ctrl.lastMessage.createdBy.iconUrl}}></span>\n<div class=message-content>\n<div class=message-header>\n<span class=message-title>{{$ctrl.lastMessage.createdBy.displayName}}</span>\n<span class=message-created dm-moment={{$ctrl.lastMessage.created}} format="{{beginOfDay > $ctrl.lastMessage.created ? \'lll\':\'LT\'}}"></span>\n</div>\n<span ng-if="!$ctrl.lastMessage.content.text.length && $ctrl.lastMessage.attachments.length" class=bz-text-italics dm-i18n=buzz/attachment-posted></span>\n<bz-markup-renderer content=$ctrl.lastMessage.content></bz-markup-renderer>\n</div>\n</div>\n<div>\n<span ng-if="$ctrl.item.replyCount && $ctrl.item.replyCount > 2" class=bz-feed-huddle-replies dm-i18n=buzz/reply-count data="{count: $ctrl.item.replyCount - 2}"></span>\n</div>\n<div class=bz-feed-message ng-if=$ctrl.firstMessage>\n<span class=avatar ng-if=!$ctrl.firstMessage.createdBy.iconUrl dm-avatar-widget={{$ctrl.firstMessage.createdById}} size=micro></span>\n<span class=tp-avatar ng-if=$ctrl.firstMessage.createdBy.iconUrl><img ng-src={{::$ctrl.firstMessage.createdBy.iconUrl}}></span>\n<div class=message-content>\n<div class=message-header>\n<span class=message-title>{{$ctrl.firstMessage.createdBy.displayName}}</span>\n<span class=message-created dm-moment={{$ctrl.firstMessage.created}} format="{{beginOfDay > $ctrl.firstMessage.created ? \'lll\':\'LT\'}}"></span>\n</div>\n<span ng-if="!$ctrl.firstMessage.content.text.length && $ctrl.firstMessage.attachments.length" class=bz-text-italics dm-i18n=buzz/attachment-posted></span>\n<bz-markup-renderer content=$ctrl.firstMessage.content></bz-markup-renderer>\n</div>\n</div>\n</div>\n</div>'},2493:function(e,n,t){t(2494),angular.module("buzz").component("bzNavLastMessage",{template:t(2496),bindings:{channel:"<"},controller:["bzService","dmI18n","bzEvents","$attrs","bzTagParser","CurrentUserId",function(e,n,t,a,i,s){function o(){c.showHuddleCount=_.has(a,"showHuddleCount")&&"false"!==a.showHuddleCount}function r(e){var n={text:e.text,tags:e.tags};if(n.text!==l&&n.tags){n.tags=[],i.addEmojis(n);for(var t=i.getMarkedUp(n.tags),a=0;a<n.tags.length;a++){var s=n.tags[a];n.text=n.text.replace(s.text,t[a])}}return l=n.text}var c=this,l=void 0;c.$postLink=o,c.getEmojiText=r,c.currentUserId=s}]})},2494:function(e,n,t){var a=t(2495);"string"==typeof a&&(a=[[e.id,a,""]]);var i,s={};s.transform=i;t(3)(a,s);a.locals&&(e.exports=a.locals)},2495:function(e,n){e.exports=".bz-nav-last-message bz-markup-renderer span{margin-right:5px}.bz-nav-last-message bz-markup-renderer span:last-child{margin:0}.bz-nav-last-message bz-markup-renderer .pill{background-color:transparent;border:none;padding:0}\n"},2496:function(e,n){e.exports='<div class="bz-text-caption secondary bz-text-overflow inverse bz-nav-last-message">\n<span ng-if="$ctrl.channel.messages[0].content.text.length || $ctrl.showHuddleCount" ng-switch=$ctrl.showHuddleCount class=last-message-content>\n<span ng-switch-when=true dm-i18n=buzz/unread-activity></span>\n<span ng-switch-when=false>\n<span ng-show="$ctrl.currentUserId == $ctrl.channel.messages[0].createdById" dm-i18n=buzz/you></span>\n{{$ctrl.channel.messages[0].content.text}}\n</span>\n</span>\n<span class="bz-text-italics system-message-content" ng-if="!$ctrl.channel.messages[0].content.text.length && $ctrl.channel.messages[0].type === \'Huddle\'" dm-i18n=buzz/user-created-huddle data="{user: $ctrl.channel.messages[0].createdBy.displayName}">\n</span>\n<span ng-if="!$ctrl.channel.messages[0] && !$ctrl.showHuddleCount" class="bz-text-italics system-message-content" dm-i18n=buzz/new-conversation>\n</span>\n<span ng-if="!$ctrl.channel.messages[0].content.text.length && $ctrl.channel.messages[0].attachments.length && $ctrl.channel.messages[0].modifiedById !== \'Domo Alert\'" class=system-message-content>\n<span ng-show=$ctrl.lastMessageByCurrentUser dm-i18n=buzz/you></span>\n<span class=bz-text-italics dm-i18n=buzz/attachment-posted></span>\n</span>\n<span ng-if="!$ctrl.channel.messages[0].content.text.length && $ctrl.channel.messages[0].attachments.length && $ctrl.channel.messages[0].modifiedById === \'Domo Alert\'" class="bz-text-italics system-message-content" dm-i18n=buzz/alert-posted data="{alert: $ctrl.channel.messages[0].attachments[0].title.text}">\n</span>\n<div class="last-message-signature last-message-content" ng-if=":: $ctrl.channel.filterType === \'data\' && $ctrl.channel.type !== \'Huddle\'">\n<div class=display-name>\n{{ $ctrl.channel.messages[0].createdBy.displayName }}\n</div>\n<div class=dot-separator ng-show=$ctrl.channel.messages[0].createdBy.displayName> • </div>\n<div class=sent-timestamp>\n{{ $ctrl.channel.timeAgo }}\n</div>\n</div>\n</div>'},2497:function(e,n){angular.module("buzz").component("bzWhosOnline",{replace:!0,template:'\n    <div class="bz-whos-online bz-folder-body-bottom" ng-show="$ctrl.isLoaded">\n      <div class="bz-online-count">\n        <span dm-i18n="buzz/people-online" data="{count: ($ctrl.onlineCount | number)}"></span>\n      </div>\n      <div class="bz-whos-online-main">\n        <div class="bz-user-list-container">\n          <div ng-repeat="user in $ctrl.displayUsers track by user.id" class="bz-online-user" dm-avatar-widget="{{user.id}}" size="micro" tooltip-options="$ctrl.tooltipOptions"></div>\n        </div>\n        <div class="bz-view-more" ng-click="$ctrl.viewMore()" dm-i18n="buzz/see-all"></div>\n      </div>\n    </div>\n  ',controller:["bzService","bzModals",function(e,n){function t(){a()}function a(){s(),c&&clearInterval(c),c=setInterval(s,l)}function i(){c&&clearInterval(c)}function s(){e.getOnlineUsers(d).then(function(e){var n=e.online,t=e.properties,a=e.total;u.isLoaded=!0,u.displayUsers=o(n,t),u.onlineCount=a})}function o(e,n){return e.map(function(e){var t=n[e],a=parseInt(e.replace("USER:",""));return Object.assign({},t,{id:a})})}function r(){a(),e.getOnlineUsers(1e4,"ALPHABETIC").then(function(e){var t=e.online,a=e.properties;return n.open("viewOnlineUsers",{users:o(t,a)})}).catch(console.error)}var c=null,l=3e4,d=14,u=this;u.$onInit=t,u.$onDestroy=i,u.viewMore=r,u.tooltipOptions={placement:"top"},u.remainingCount=0,u.displayUsers=[],u.onlineCount=0,u.isLoaded=!1}]})},2498:function(e,n){angular.module("buzz").component("bzOnlineUsersModal",{bindings:{users:"<"},template:'\n    <div class="bz-modal-content margin-medium">\n      <db-modal-header>\n        <div>\n            <span class="bz-text-display-4 margin-right-xxsmall" dm-i18n="people"></span>\n            <span class="accordion-meta bz-text-caption secondary" ng-show="$ctrl.users.length > 0">\n              {{ $ctrl.users.length | number }}\n            </span>\n          <div class="margin-top-small search-box bz-online-search">\n            <input class="input" type="text" placeholder="{{::$ctrl.searchPlaceholder}}" ng-model="$ctrl.peopleFilterTerm.DISPLAY" ng-change="$ctrl.filterPeople(peopleFilterTerm)" />\n            <i class="icon-search"></i>\n          </div>\n        </div>\n      </db-modal-header>\n      <db-modal-body>\n        <div>\n          <ul class="people-list" vs-repeat vs-excess="10" vs-scroll-parent=".modal-body">\n            <li ng-repeat="user in $ctrl.filteredUsers = ($ctrl.users | filter:$ctrl.peopleFilterTerm) track by user.id" class="user-list-item">\n              <bz-user-list-item id="{{user.id}}" name="{{user.DISPLAY}}"></bz-user-list-item>\n            </li>\n          </ul>\n          <div ng-hide="$ctrl.users.length" class="people-list-zero-state bz-text-italics" dm-i18n="buzz/people-list-zero-state"></div>\n        </div>\n        <div ng-if="$ctrl.filteredUsers.length === 0">\n          <span dm-i18n="common/no-results"></span>\n        </div>\n      </db-modal-body>\n    </div>\n  ',controller:["dmI18n","$element",function(e,n){function t(e){i&&i.scrollTop(0)}var a=this,i=n.find(".modal-body");a.searchPlaceholder=e.get("common/search"),a.filterPeople=t}]})},2499:function(e,n){angular.module("buzz").filter("bzNumberTruncate",function(){return function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:99,t=e;return"number"!=typeof e&&(t=parseInt(e)),isNaN(t)?"":t>n?n+"+":""+t}})},2500:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var a=t(75),i=function(){function e(e,n,t,a,i,s,o){this.Analytics=e,this.bzModals=n,this.features=t,this.dmUtils=a,this.$window=i,this.bzEvents=s,this.bzService=o,this.HAS_DOWNLOADED_KEY="buzz:downloaded-desktop",this.TIME_KEY="buzz:downloaded-desktop-time",this.DOWNLOAD_URL=this.getDownloadUrl(),this.MODAL_REF="downloadApps",this.modalIsOpen=!1,this.desktopApps=[{label:"Windows",platform:"pc",img:this.imgPath("windows"),downloadUrl:this.getDownloadURL("pc")},{label:"Mac",platform:"mac",img:this.imgPath("os-x"),downloadUrl:this.getDownloadURL("mac")}]}return e.$inject=["Analytics","bzModals","features","dmUtils","$window","bzEvents","bzService"],e.prototype.isDemo=function(){return location.hostname.indexOf("domo.demo.domo")>-1},e.prototype.isDev=function(){return location.hostname.indexOf("dev.dev.domo")>-1||location.hostname.indexOf("localhost")>-1},e.prototype.getDownloadUrl=function(){var e="https://app.domo.com/DomoBuzz";return this.isDemo()?e+="/demo":this.isDev()&&(e+="/dev"),e+="/latest/"},e.prototype.imgPath=function(e){return"/public/images/platforms/"+e+"-logo.png"},e.prototype.getDownloadURL=function(e){return this.DOWNLOAD_URL+"BuzzSetup"+("pc"===e?".exe":".dmg")},e.prototype.getDesktopApps=function(){return this.desktopApps},e.prototype.getAppForPlatform=function(){var e=this.bzService.getPlatform();return this.desktopApps.filter(function(n){return n.platform===e}).pop()},e.prototype.shouldShowMenuOption=function(){return this.features.on("download-buzz")&&!this.features.isElectron()},e.prototype.shouldShowBanner=function(){return this.canDownload()&&null==this.dmUtils.localStorageRead(this.HAS_DOWNLOADED_KEY)},e.prototype.canDownload=function(){return this.features.on("buzz-download-banner")&&!this.features.isElectron()},e.prototype.writeAction=function(e){this.dmUtils.localStorageWrite(this.HAS_DOWNLOADED_KEY,e),this.dmUtils.localStorageWrite(this.TIME_KEY,Date.now())},e.prototype.displayDownloadModal=function(){this.Analytics.track("buzz_download_open"),this.bzModals.open(this.MODAL_REF),this.modalIsOpen=!0},e.prototype.download=function(e){this.Analytics.track("buzz_download_"+e.platform),this.writeAction(!0),this.modalIsOpen&&(this.bzModals.close(this.MODAL_REF),this.modalIsOpen=!1),this.$window.open(e.downloadUrl)},e.prototype.dismissPrompt=function(){this.writeAction(!1)},e}();n.bzDownloadBuzzService=i,a.module("buzz").service("bzDownloadBuzzService",i)},2501:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var a=t(75);a.module("buzz").component("bzDownloadBuzzHeader",{template:'\n\t\t<div class="bz-dl-buzz" ng-if="$ctrl.show">\n\t\t\t<div class="bz-dl-buzz-inner">\n\n\t\t\t\t<div style="display:flex; align-content:center; width:calc(100% - 30px);">\n\t\t\t\t\t<i class="icon-download"></i>\n\t\t\t\t\t<span style="line-height:2; display:inline-block; width:calc(100% - 36px);">\n\t\t\t\t\t\t<a class="bz-dl-buzz-header" ng-href="{{::$ctrl.downloadLink}}" ng-click="::$ctrl.download($event)">{{::$ctrl.downloadCta}}</a>\n\t\t\t\t\t\t<span dm-i18n="buzz/download-header-body"></span>\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t\t\n\t\t\t\t<div>\n\t\t\t\t\t<i class="icon-x" ng-click="::$ctrl.dismiss()"></i>\n\t\t\t\t</div>\n\t\t\t\t\n\t\t\t</div>\n\t\t</div>\n\t',controller:["bzDownloadBuzzService","dmI18n","bzService",function(e,n,t){var a=this,i=(t.getPlatform(),e.getAppForPlatform());a.show=e.shouldShowBanner(),a.downloadCta=n.get("buzz/download-cta",{platform:i.label}),a.downloadLink=i.downloadUrl,a.download=function(n){n.preventDefault(),e.download(i),a.show=!1},a.dismiss=function(){e.dismissPrompt(),a.show=!1}}]})},2502:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var a=t(75);a.module("buzz").component("bzDownloadApps",{template:t(2503),controller:function(){function e(e){this.bzDownloadBuzzService=e,this.desktopApps=[],this.desktopApps=e.getDesktopApps()}return e.$inject=["bzDownloadBuzzService"],e.prototype.goToDownload=function(e){this.bzDownloadBuzzService.download(e)},e}()})},2503:function(e,n){e.exports='<db-modal-header>\n<div class=bz-text-display-4 dm-i18n=buzz/download-modal-header></div>\n</db-modal-header>\n<db-modal-body>\n<p class=bz-text-body dm-i18n=buzz/download-modal-body></p>\n<div class="bz-app-tile inline-block text-align-center" ng-repeat="app in $ctrl.desktopApps" ng-click=$ctrl.goToDownload(app)>\n<img class=bz-platform-img src="{{ app.img }}" width=60 style=margin-top:5px />\n<div class="bz-text-label secondary bz-download-label">{{ app.label }}</div>\n</div>\n</db-modal-body>\n'},2504:function(e,n,t){var a=t(47);angular.module("buzz").directive("bzMarkupRenderer",["$compile","bzTagParser","CurrentUserId","dmI18n",function(e,n,t,i){return{restrict:"E",scope:{markupArray:"=",tagClickHandler:"=",content:"=",modified:"=?"},link:function(s,o,r){function c(){return s.clickHandler=u,r.markupArray?void s.$watchCollection("markupArray",function(e){e&&e.length&&d(e)}):void(_.has(r,"content")&&s.$watch("content",function(e){e&&l()}))}function l(){if(s.content){var e=s.content,a=e.tags?e.tags.slice():[];a=a.map(function(e){return"USER"===e.type&&e.id==t&&(e.type="CURRENT_USER"),e});var i=_.has(r,"maxLength")?parseInt(r.maxLength,10):void 0,o=[];e.text&&(o=n.getTagsArray({text:e.text,tags:a},i));var c=[];o.length&&(c=n.getMarkedUp(o)),d(e,c)}}function d(n,t){var r=t.join("");"<"!==r.charAt(0)&&(r="<span>"+r+"</span>"),n.image&&n.image.url&&(r='<img src="'+_.escape(n.image.url).replace(/{|}/g,"")+'"/>'+r),s.modified&&(r+='<span class="message-edited bz-text-caption secondary" db-tooltip="'+i.get("buzz/message-edited-timestamp",{timestamp:a(s.modified).format("lll")})+'">'+i.get("buzz/message-edited")+"</span>"),e(r)(s,function(e,n){o.html(e)})}function u(e){e=JSON.parse(decodeURIComponent(e)),s.tagClickHandler&&s.tagClickHandler(e)}c()}}}])}});